"use strict";
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.SlideOver = exports.useStyles = exports.SlideOverStylesKey = void 0;
var styles_1 = require("../../styles");
var react_remove_scroll_1 = require("react-remove-scroll");
var React = __importStar(require("react"));
var clsx_1 = __importDefault(require("clsx"));
exports.SlideOverStylesKey = 'ChromaSlideOver';
exports.useStyles = (0, styles_1.makeStyles)(function (theme) { return ({
    '@keyframes fade-in': {
        '0%': {
            opacity: 0,
        },
        '100%': {
            opacity: 1,
        },
    },
    '@keyframes fade-out': {
        '0%': {
            opacity: 1,
        },
        '100%': {
            opacity: 0,
        },
    },
    '@keyframes slide-in': {
        '0%': {
            width: 0,
            maxWidth: 0,
        },
        '100%': {
            maxWidth: '100%',
            width: 'var(--slideover-width)',
        },
    },
    '@keyframes slide-out': {
        '0%': {
            maxWidth: '100%',
            width: 'var(--slideover-width)',
        },
        '100%': {
            width: 0,
            maxWidth: 0,
        },
    },
    root: {
        '--slideover-width': '28rem',
        backgroundColor: theme.palette.common.white,
        bottom: 0,
        display: 'flex',
        position: 'absolute',
        right: 0,
        top: 0,
        zIndex: 100,
        boxShadow: theme.boxShadows.elevatedContent,
        animation: '$slide-in 0.25s ease-in-out',
        transform: 'translate3d(0, 0, 0)',
        '@media (prefers-reduced-motion)': {
            animation: '$slide-in 0.1s ease-in-out',
        },
    },
    transitionClose: {
        animation: '$slide-out 0.2s ease-in-out',
        '@media (prefers-reduced-motion)': {
            animation: '$slide-out 0.1s ease-in-out',
        },
    },
    fadeInAnimation: {
        animation: '$fade-in 1s',
    },
    fadeOutAnimation: {
        animation: '$fade-out 0.15s',
    },
    inner: {
        maxWidth: 'var(--slideover-width)',
        position: 'relative',
        width: '100vw',
    },
    content: {
        backgroundColor: 'white',
        display: 'flex',
        flexDirection: 'column',
        height: '100%',
        overflowY: 'auto',
    },
}); }, { name: exports.SlideOverStylesKey });
var SlideOver = function (_a) {
    var additionalClasses = _a.classes, className = _a.className, children = _a.children, _b = _a.isOpen, isOpen = _b === void 0 ? false : _b, rootProps = __rest(_a, ["classes", "className", "children", "isOpen"]);
    var classes = (0, exports.useStyles)({});
    // If the two below states get more complicated, may want to move to a
    // useReducer.
    // We use a local state open variable so we can ensure
    // that the keyframe animations finish before we remove the element
    // from the DOM
    var _c = React.useState(isOpen), localIsOpen = _c[0], setLocalIsOpen = _c[1];
    // This is another state variable we use to apply the "slide-out" keyframes
    // and then we leverage the `onAnimationEnd` to know when it's safe to
    // remove this element from the DOM
    var _d = React.useState(false), isTransitioningClosed = _d[0], setIsTransitioningClosed = _d[1];
    React.useEffect(function () {
        if (localIsOpen === false && isOpen === true) {
            setLocalIsOpen(true);
            setIsTransitioningClosed(false);
            return;
        }
        if (localIsOpen === true && isOpen == false) {
            setIsTransitioningClosed(true);
        }
    }, [isOpen, localIsOpen]);
    if (localIsOpen === false) {
        return null;
    }
    return (React.createElement(react_remove_scroll_1.RemoveScroll, { forwardProps: true },
        React.createElement("section", __assign({ className: (0, clsx_1.default)(classes.root, additionalClasses === null || additionalClasses === void 0 ? void 0 : additionalClasses.root, isTransitioningClosed && classes.transitionClose, className), onAnimationEnd: function () {
                if (localIsOpen && isTransitioningClosed) {
                    setLocalIsOpen(false);
                }
            } }, rootProps),
            React.createElement("div", { className: (0, clsx_1.default)(classes.inner, additionalClasses === null || additionalClasses === void 0 ? void 0 : additionalClasses.inner) },
                React.createElement("div", { className: (0, clsx_1.default)(classes.content, classes.fadeInAnimation, isTransitioningClosed && classes.fadeOutAnimation, additionalClasses === null || additionalClasses === void 0 ? void 0 : additionalClasses.content) }, children)))));
};
exports.SlideOver = SlideOver;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU2xpZGVPdmVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvU2xpZGVPdmVyL1NsaWRlT3Zlci50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ0EsdUNBQTBDO0FBQzFDLDJEQUFtRDtBQUNuRCwyQ0FBK0I7QUFDL0IsOENBQXdCO0FBRVgsUUFBQSxrQkFBa0IsR0FBRyxpQkFBaUIsQ0FBQztBQUV2QyxRQUFBLFNBQVMsR0FBRyxJQUFBLG1CQUFVLEVBQ2pDLFVBQUMsS0FBSyxJQUFLLE9BQUEsQ0FBQztJQUNWLG9CQUFvQixFQUFFO1FBQ3BCLElBQUksRUFBRTtZQUNKLE9BQU8sRUFBRSxDQUFDO1NBQ1g7UUFDRCxNQUFNLEVBQUU7WUFDTixPQUFPLEVBQUUsQ0FBQztTQUNYO0tBQ0Y7SUFDRCxxQkFBcUIsRUFBRTtRQUNyQixJQUFJLEVBQUU7WUFDSixPQUFPLEVBQUUsQ0FBQztTQUNYO1FBQ0QsTUFBTSxFQUFFO1lBQ04sT0FBTyxFQUFFLENBQUM7U0FDWDtLQUNGO0lBQ0QscUJBQXFCLEVBQUU7UUFDckIsSUFBSSxFQUFFO1lBQ0osS0FBSyxFQUFFLENBQUM7WUFDUixRQUFRLEVBQUUsQ0FBQztTQUNaO1FBQ0QsTUFBTSxFQUFFO1lBQ04sUUFBUSxFQUFFLE1BQU07WUFDaEIsS0FBSyxFQUFFLHdCQUF3QjtTQUNoQztLQUNGO0lBQ0Qsc0JBQXNCLEVBQUU7UUFDdEIsSUFBSSxFQUFFO1lBQ0osUUFBUSxFQUFFLE1BQU07WUFDaEIsS0FBSyxFQUFFLHdCQUF3QjtTQUNoQztRQUNELE1BQU0sRUFBRTtZQUNOLEtBQUssRUFBRSxDQUFDO1lBQ1IsUUFBUSxFQUFFLENBQUM7U0FDWjtLQUNGO0lBQ0QsSUFBSSxFQUFFO1FBQ0osbUJBQW1CLEVBQUUsT0FBTztRQUM1QixlQUFlLEVBQUUsS0FBSyxDQUFDLE9B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QUFDLEtBQUssQ0FBQyxDQUFDO2lCQUN2QjtZQUNILENBQUMsSUFDRyxTQUFTO1lBRWIsNkJBQUssU0FBUyxFQUFFLElBQUEsY0FBSSxFQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsaUJBQWlCLGFBQWpCLGlCQUFpQix1QkFBakIsaUJBQWlCLENBQUUsS0FBSyxDQUFDO2dCQUMzRCw2QkFDRSxTQUFTLEVBQUUsSUFBQSxjQUFJLEVBQ2IsT0FBTyxDQUFDLE9BQU8sRUFDZixPQUFPLENBQUMsZUFBZSxFQUN2QixxQkFBcUIsSUFBSSxPQUFPLENBQUMsZ0JBQWdCLEVBQ2pELGlCQUFpQixhQUFqQixpQkFBaUIsdUJBQWpCLGlCQUFpQixDQUFFLE9BQU8sQ0FDM0IsSUFFQSxRQUFRLENBQ0wsQ0FDRixDQUNFLENBQ0csQ0FDaEIsQ0FBQztBQUNKLENBQUMsQ0FBQztBQXZFVyxRQUFBLFNBQVMsYUF1RXBCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgR2V0Q2xhc3NlcyB9IGZyb20gJy4uLy4uL3R5cGVVdGlscyc7XG5pbXBvcnQgeyBtYWtlU3R5bGVzIH0gZnJvbSAnLi4vLi4vc3R5bGVzJztcbmltcG9ydCB7IFJlbW92ZVNjcm9sbCB9IGZyb20gJ3JlYWN0LXJlbW92ZS1zY3JvbGwnO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IGNsc3ggZnJvbSAnY2xzeCc7XG5cbmV4cG9ydCBjb25zdCBTbGlkZU92ZXJTdHlsZXNLZXkgPSAnQ2hyb21hU2xpZGVPdmVyJztcblxuZXhwb3J0IGNvbnN0IHVzZVN0eWxlcyA9IG1ha2VTdHlsZXMoXG4gICh0aGVtZSkgPT4gKHtcbiAgICAnQGtleWZyYW1lcyBmYWRlLWluJzoge1xuICAgICAgJzAlJzoge1xuICAgICAgICBvcGFjaXR5OiAwLFxuICAgICAgfSxcbiAgICAgICcxMDAlJzoge1xuICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgfSxcbiAgICB9LFxuICAgICdAa2V5ZnJhbWVzIGZhZGUtb3V0Jzoge1xuICAgICAgJzAlJzoge1xuICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgfSxcbiAgICAgICcxMDAlJzoge1xuICAgICAgICBvcGFjaXR5OiAwLFxuICAgICAgfSxcbiAgICB9LFxuICAgICdAa2V5ZnJhbWVzIHNsaWRlLWluJzoge1xuICAgICAgJzAlJzoge1xuICAgICAgICB3aWR0aDogMCxcbiAgICAgICAgbWF4V2lkdGg6IDAsXG4gICAgICB9LFxuICAgICAgJzEwMCUnOiB7XG4gICAgICAgIG1heFdpZHRoOiAnMTAwJScsXG4gICAgICAgIHdpZHRoOiAndmFyKC0tc2xpZGVvdmVyLXdpZHRoKScsXG4gICAgICB9LFxuICAgIH0sXG4gICAgJ0BrZXlmcmFtZXMgc2xpZGUtb3V0Jzoge1xuICAgICAgJzAlJzoge1xuICAgICAgICBtYXhXaWR0aDogJzEwMCUnLFxuICAgICAgICB3aWR0aDogJ3ZhcigtLXNsaWRlb3Zlci13aWR0aCknLFxuICAgICAgfSxcbiAgICAgICcxMDAlJzoge1xuICAgICAgICB3aWR0aDogMCxcbiAgICAgICAgbWF4V2lkdGg6IDAsXG4gICAgICB9LFxuICAgIH0sXG4gICAgcm9vdDoge1xuICAgICAgJy0tc2xpZGVvdmVyLXdpZHRoJzogJzI4cmVtJyxcbiAgICAgIGJhY2tncm91bmRDb2xvcjogdGhlbWUucGFsZXR0ZS5jb21tb24ud2hpdGUsXG4gICAgICBib3R0b206IDAsXG4gICAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICAgIHJpZ2h0OiAwLFxuICAgICAgdG9wOiAwLFxuICAgICAgekluZGV4OiAxMDAsXG4gICAgICBib3hTaGFkb3c6IHRoZW1lLmJveFNoYWRvd3MuZWxldmF0ZWRDb250ZW50LFxuICAgICAgYW5pbWF0aW9uOiAnJHNsaWRlLWluIDAuMjVzIGVhc2UtaW4tb3V0JyxcbiAgICAgIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZTNkKDAsIDAsIDApJyxcbiAgICAgICdAbWVkaWEgKHByZWZlcnMtcmVkdWNlZC1tb3Rpb24pJzoge1xuICAgICAgICBhbmltYXRpb246ICckc2xpZGUtaW4gMC4xcyBlYXNlLWluLW91dCcsXG4gICAgICB9LFxuICAgIH0sXG4gICAgdHJhbnNpdGlvbkNsb3NlOiB7XG4gICAgICBhbmltYXRpb246ICckc2xpZGUtb3V0IDAuMnMgZWFzZS1pbi1vdXQnLFxuICAgICAgJ0BtZWRpYSAocHJlZmVycy1yZWR1Y2VkLW1vdGlvbiknOiB7XG4gICAgICAgIGFuaW1hdGlvbjogJyRzbGlkZS1vdXQgMC4xcyBlYXNlLWluLW91dCcsXG4gICAgICB9LFxuICAgIH0sXG4gICAgZmFkZUluQW5pbWF0aW9uOiB7XG4gICAgICBhbmltYXRpb246ICckZmFkZS1pbiAxcycsXG4gICAgfSxcbiAgICBmYWRlT3V0QW5pbWF0aW9uOiB7XG4gICAgICBhbmltYXRpb246ICckZmFkZS1vdXQgMC4xNXMnLFxuICAgIH0sXG4gICAgaW5uZXI6IHtcbiAgICAgIG1heFdpZHRoOiAndmFyKC0tc2xpZGVvdmVyLXdpZHRoKScsXG4gICAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJyxcbiAgICAgIHdpZHRoOiAnMTAwdncnLFxuICAgIH0sXG4gICAgY29udGVudDoge1xuICAgICAgYmFja2dyb3VuZENvbG9yOiAnd2hpdGUnLFxuICAgICAgZGlzcGxheTogJ2ZsZXgnLFxuICAgICAgZmxleERpcmVjdGlvbjogJ2NvbHVtbicsXG4gICAgICBoZWlnaHQ6ICcxMDAlJyxcbiAgICAgIG92ZXJmbG93WTogJ2F1dG8nLFxuICAgIH0sXG4gIH0pLFxuICB7IG5hbWU6IFNsaWRlT3ZlclN0eWxlc0tleSB9XG4pO1xuXG5leHBvcnQgdHlwZSBTbGlkZU92ZXJDbGFzc2VzID0gR2V0Q2xhc3Nlczx0eXBlb2YgdXNlU3R5bGVzPjtcblxuZXhwb3J0IGludGVyZmFjZSBTbGlkZU92ZXJQcm9wcyB7XG4gIGNsYXNzTmFtZT86IHN0cmluZztcbiAgY2xhc3Nlcz86IHtcbiAgICByb290Pzogc3RyaW5nO1xuICAgIGlubmVyPzogc3RyaW5nO1xuICAgIGNvbnRlbnQ/OiBzdHJpbmc7XG4gIH07XG4gIGNoaWxkcmVuPzogUmVhY3QuUmVhY3ROb2RlO1xuICBpc09wZW4/OiBib29sZWFuO1xufVxuXG5leHBvcnQgY29uc3QgU2xpZGVPdmVyOiBSZWFjdC5GQzxTbGlkZU92ZXJQcm9wcz4gPSAoe1xuICBjbGFzc2VzOiBhZGRpdGlvbmFsQ2xhc3NlcyxcbiAgY2xhc3NOYW1lLFxuICBjaGlsZHJlbixcbiAgaXNPcGVuID0gZmFsc2UsXG4gIC4uLnJvb3RQcm9wc1xufSkgPT4ge1xuICBjb25zdCBjbGFzc2VzID0gdXNlU3R5bGVzKHt9KTtcblxuICAvLyBJZiB0aGUgdHdvIGJlbG93IHN0YXRlcyBnZXQgbW9yZSBjb21wbGljYXRlZCwgbWF5IHdhbnQgdG8gbW92ZSB0byBhXG4gIC8vIHVzZVJlZHVjZXIuXG5cbiAgLy8gV2UgdXNlIGEgbG9jYWwgc3RhdGUgb3BlbiB2YXJpYWJsZSBzbyB3ZSBjYW4gZW5zdXJlXG4gIC8vIHRoYXQgdGhlIGtleWZyYW1lIGFuaW1hdGlvbnMgZmluaXNoIGJlZm9yZSB3ZSByZW1vdmUgdGhlIGVsZW1lbnRcbiAgLy8gZnJvbSB0aGUgRE9NXG4gIGNvbnN0IFtsb2NhbElzT3Blbiwgc2V0TG9jYWxJc09wZW5dID0gUmVhY3QudXNlU3RhdGU8Ym9vbGVhbj4oaXNPcGVuKTtcblxuICAvLyBUaGlzIGlzIGFub3RoZXIgc3RhdGUgdmFyaWFibGUgd2UgdXNlIHRvIGFwcGx5IHRoZSBcInNsaWRlLW91dFwiIGtleWZyYW1lc1xuICAvLyBhbmQgdGhlbiB3ZSBsZXZlcmFnZSB0aGUgYG9uQW5pbWF0aW9uRW5kYCB0byBrbm93IHdoZW4gaXQncyBzYWZlIHRvXG4gIC8vIHJlbW92ZSB0aGlzIGVsZW1lbnQgZnJvbSB0aGUgRE9NXG4gIGNvbnN0IFtpc1RyYW5zaXRpb25pbmdDbG9zZWQsIHNldElzVHJhbnNpdGlvbmluZ0Nsb3NlZF0gPSBSZWFjdC51c2VTdGF0ZTxcbiAgICBib29sZWFuXG4gID4oZmFsc2UpO1xuXG4gIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKGxvY2FsSXNPcGVuID09PSBmYWxzZSAmJiBpc09wZW4gPT09IHRydWUpIHtcbiAgICAgIHNldExvY2FsSXNPcGVuKHRydWUpO1xuICAgICAgc2V0SXNUcmFuc2l0aW9uaW5nQ2xvc2VkKGZhbHNlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAobG9jYWxJc09wZW4gPT09IHRydWUgJiYgaXNPcGVuID09IGZhbHNlKSB7XG4gICAgICBzZXRJc1RyYW5zaXRpb25pbmdDbG9zZWQodHJ1ZSk7XG4gICAgfVxuICB9LCBbaXNPcGVuLCBsb2NhbElzT3Blbl0pO1xuXG4gIGlmIChsb2NhbElzT3BlbiA9PT0gZmFsc2UpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgPFJlbW92ZVNjcm9sbCBmb3J3YXJkUHJvcHM+XG4gICAgICA8c2VjdGlvblxuICAgICAgICBjbGFzc05hbWU9e2Nsc3goXG4gICAgICAgICAgY2xhc3Nlcy5yb290LFxuICAgICAgICAgIGFkZGl0aW9uYWxDbGFzc2VzPy5yb290LFxuICAgICAgICAgIGlzVHJhbnNpdGlvbmluZ0Nsb3NlZCAmJiBjbGFzc2VzLnRyYW5zaXRpb25DbG9zZSxcbiAgICAgICAgICBjbGFzc05hbWVcbiAgICAgICAgKX1cbiAgICAgICAgb25BbmltYXRpb25FbmQ9eygpID0+IHtcbiAgICAgICAgICBpZiAobG9jYWxJc09wZW4gJiYgaXNUcmFuc2l0aW9uaW5nQ2xvc2VkKSB7XG4gICAgICAgICAgICBzZXRMb2NhbElzT3BlbihmYWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9fVxuICAgICAgICB7Li4ucm9vdFByb3BzfVxuICAgICAgPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT17Y2xzeChjbGFzc2VzLmlubmVyLCBhZGRpdGlvbmFsQ2xhc3Nlcz8uaW5uZXIpfT5cbiAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICBjbGFzc05hbWU9e2Nsc3goXG4gICAgICAgICAgICAgIGNsYXNzZXMuY29udGVudCxcbiAgICAgICAgICAgICAgY2xhc3Nlcy5mYWRlSW5BbmltYXRpb24sXG4gICAgICAgICAgICAgIGlzVHJhbnNpdGlvbmluZ0Nsb3NlZCAmJiBjbGFzc2VzLmZhZGVPdXRBbmltYXRpb24sXG4gICAgICAgICAgICAgIGFkZGl0aW9uYWxDbGFzc2VzPy5jb250ZW50XG4gICAgICAgICAgICApfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIHtjaGlsZHJlbn1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L3NlY3Rpb24+XG4gICAgPC9SZW1vdmVTY3JvbGw+XG4gICk7XG59O1xuIl19