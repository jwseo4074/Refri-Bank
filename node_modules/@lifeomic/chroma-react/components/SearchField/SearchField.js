"use strict";
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result["default"] = mod;
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
var clsx_1 = __importDefault(require("clsx"));
var React = __importStar(require("react"));
var styles_1 = require("../../styles");
var forms_1 = require("../_private/forms");
var UniqueId_1 = require("../_private/UniqueId");
var clipPaths_1 = require("./clipPaths");
exports.SearchFieldStylesKey = 'ChromaSearchField';
exports.useStyles = styles_1.makeStyles(function (theme) { return ({
    root: {
        position: 'relative',
    },
    input: {
        backgroundColor: 'rgba(132, 137, 166, 0.15)',
        border: "1px solid transparent",
        borderRadius: theme.pxToRem(4),
        color: theme.palette.text.primary,
        fontFamily: theme.typography.fontFamily,
        fontSize: theme.pxToRem(14),
        lineHeight: 1.25,
        paddingLeft: theme.spacing(1.25),
        // Requires more paddingRight so we give the search icon enough
        // room when the text inside the search field is long.
        paddingRight: theme.spacing(3.75),
        transition: 'border 0.25s ease',
        maxWidth: theme.pxToRem(173),
        '&:focus': {
            outline: 'none',
            backgroundColor: 'rgba(255, 255, 255, 0.5)',
            border: "1px solid rgba(132, 137, 166, 0.45)",
        },
        '&:disabled': {
            cursor: 'not-allowed',
            opacity: 0.625,
            '& + $button': {
                cursor: 'not-allowed',
                opacity: 0.625,
            },
        },
        '&::-webkit-input-placeholder': {
            color: theme.palette.black[400],
        },
        '&::-moz-placeholder': {
            color: theme.palette.black[400],
        },
        '&:-ms-input-placeholder': {
            color: theme.palette.black[400],
        },
        '&:-moz-placeholder': {
            color: theme.palette.black[400],
        },
        // Hide the webkit clear (x) button
        '&::-webkit-search-decoration,&::-webkit-search-cancel-button,&::-webkit-search-results-button,&::-webkit-search-results-decoration': {
            display: 'none',
        },
    },
    inputInverse: {
        backgroundColor: 'rgba(230, 231, 237, 0.1)',
        color: theme.palette.common.white,
        '&:focus': {
            backgroundColor: 'rgba(230, 231, 237, 0.1)',
            border: "1px solid rgba(230, 231, 237, 0.55)",
        },
        '&::-webkit-input-placeholder': {
            color: 'rgba(255, 255, 255, 0.8)',
        },
        '&::-moz-placeholder': {
            color: 'rgba(255, 255, 255, 0.8)',
        },
        '&:-ms-input-placeholder': {
            color: 'rgba(255, 255, 255, 0.8)',
        },
        '&:-moz-placeholder': {
            color: 'rgba(255, 255, 255, 0.8)',
        },
    },
    inputHeight0: {
        paddingBottom: theme.spacing(0.5),
        paddingTop: theme.spacing(0.5),
    },
    inputHeight1: {
        paddingBottom: theme.spacing(1),
        paddingTop: theme.spacing(1),
    },
    fullWidth: {
        '& $input': {
            maxWidth: 'none',
            width: '100%',
        },
        '& $button': {
            left: 'auto',
            right: theme.pxToRem(5),
        },
    },
    button: {
        position: 'absolute',
        left: theme.pxToRem(144),
        alignItems: 'center',
        backgroundColor: 'transparent',
        border: 0,
        color: theme.palette.black[500],
        cursor: 'pointer',
        display: 'inline-flex',
        flex: '0 0 auto',
        justifyContent: 'center',
        margin: 0,
        outline: 'none',
        padding: 0,
        transition: 'color 0.25s ease, opacity 0.25s ease',
        userSelect: 'none',
    },
    buttonHeight0: {
        top: theme.pxToRem(0.25),
    },
    buttonHeight1: {
        top: theme.pxToRem(4),
    },
    buttonSvg: {
        width: theme.pxToRem(24),
        height: theme.pxToRem(24),
        // Glass
        '& > circle': {
            fill: 'transparent',
            stroke: theme.palette.black[500],
            strokeWidth: 6,
            strokeLinecap: 'round',
        },
        // Magnifying glass pole part
        '& > path': {
            fill: 'none',
            stroke: theme.palette.black[500],
            strokeDasharray: '10 50',
            strokeDashoffset: 20,
            strokeLinecap: 'round',
            strokeWidth: 7,
            transition: 'stroke-dasharray 200ms, stroke-dashoffset 200ms, stroke 200ms',
            '@media (prefers-reduced-motion: reduce)': {
                transition: 'none',
            },
        },
        // Background circle for glass and X clear
        '& > rect': {
            clipPath: clipPaths_1.defaultClipPath,
            WebkitClipPath: clipPaths_1.defaultClipPath,
            fill: 'transparent',
            transition: 'clip-path 100ms 100ms',
            '@media (prefers-reduced-motion: reduce)': {
                transition: 'none',
            },
        },
    },
    buttonSvgInverse: {
        '& > circle': {
            stroke: theme.palette.common.white,
        },
        '& > path': {
            stroke: theme.palette.common.white,
        },
    },
    buttonSvgClear: {
        marginTop: theme.spacing(0.125),
        '& > circle': {
            fill: theme.palette.black[500],
        },
        '& > path': {
            strokeDasharray: '24 50',
            strokeDashoffset: 74,
            stroke: theme.palette.common.white,
        },
        '& > rect': {
            clipPath: clipPaths_1.clearClipPath,
            WebkitClipPath: clipPaths_1.clearClipPath,
            fill: theme.palette.common.white,
            transition: 'clip-path 100ms',
            '@media (prefers-reduced-motion: reduce)': {
                transition: 'none',
            },
        },
    },
    buttonSvgClearInverse: {
        '& > circle': {
            fill: theme.palette.common.white,
            stroke: theme.palette.common.white,
        },
        '& > path': {
            stroke: theme.palette.blue[700],
        },
        '& > rect': {
            fill: theme.palette.blue[700],
        },
    },
    helpMessage: {
        marginTop: theme.spacing(1),
        marginLeft: 0,
    },
}); }, { name: exports.SearchFieldStylesKey });
exports.SearchField = React.forwardRef(function (_a, ref) {
    var _b, _c, _d;
    var className = _a.className, _e = _a.color, color = _e === void 0 ? 'default' : _e, _f = _a.disableClearOnSearch, disableClearOnSearch = _f === void 0 ? false : _f, fullWidth = _a.fullWidth, _g = _a.height, height = _g === void 0 ? 1 : _g, id = _a.id, name = _a.name, helpMessage = _a.helpMessage, onChange = _a.onChange, onSearch = _a.onSearch, onClear = _a.onClear, value = _a.value, rootProps = __rest(_a, ["className", "color", "disableClearOnSearch", "fullWidth", "height", "id", "name", "helpMessage", "onChange", "onSearch", "onClear", "value"]);
    var classes = exports.useStyles({});
    var uniqueId = React.useState(function () { return id || name || UniqueId_1.generateUniqueId('searchField-'); })[0];
    var _h = React.useState(false), showClear = _h[0], setShowClear = _h[1];
    var _j = React.useState(''), searchText = _j[0], setSearchText = _j[1];
    var handleFocus = function (e) {
        if (e.target.value.length > 0) {
            setShowClear(true);
        }
    };
    var handleBlur = function () {
        if (searchText.length === 0) {
            setShowClear(false);
        }
    };
    var handleChange = function (e) {
        setSearchText(e.target.value);
        if (showClear && e.target.value.length === 0) {
            setShowClear(false);
        }
        if (!showClear && e.target.value.length > 0) {
            setShowClear(true);
        }
        onChange === null || onChange === void 0 ? void 0 : onChange(e);
    };
    var handleKeyPress = function (e) {
        if (e.key === 'Enter' && !disableClearOnSearch) {
            setShowClear(false);
            onSearch && onSearch(searchText);
            setSearchText('');
        }
        if (e.key === 'Enter' && disableClearOnSearch) {
            onSearch && onSearch(searchText);
        }
    };
    var handleClearButtonClick = function () {
        setSearchText('');
        setShowClear(false);
        onClear === null || onClear === void 0 ? void 0 : onClear();
        var input = document.getElementById(uniqueId);
        var event = new Event('change');
        input.value = '';
        input.dispatchEvent(event);
        onChange === null || onChange === void 0 ? void 0 : onChange(event);
    };
    return (React.createElement("div", { className: clsx_1.default(classes.root, fullWidth && classes.fullWidth, className) },
        React.createElement("input", __assign({ "aria-describedby": forms_1.buildDescribedBy({
                hasHelpMessage: !!helpMessage,
                uniqueId: uniqueId,
            }), className: clsx_1.default(classes.input, (_b = {},
                _b[classes.inputInverse] = color === 'inverse',
                _b), (_c = {},
                _c[classes.inputHeight0] = height === 0,
                _c[classes.inputHeight1] = height === 1,
                _c)), id: uniqueId, name: name, ref: ref, type: "search", onChange: handleChange, onKeyPress: handleKeyPress, onFocus: handleFocus, onBlur: handleBlur, value: searchText }, rootProps)),
        React.createElement("button", { "aria-label": showClear ? 'Clear input' : 'Search', className: clsx_1.default(classes.button, (_d = {},
                _d[classes.buttonHeight0] = height === 0,
                _d[classes.buttonHeight1] = height === 1,
                _d)), tabIndex: -1, onClick: handleClearButtonClick },
            React.createElement("svg", { className: clsx_1.default(classes.buttonSvg, color === 'inverse' && classes.buttonSvgInverse, showClear && classes.buttonSvgClear, color === 'inverse' && showClear && classes.buttonSvgClearInverse), viewBox: "0 0 100 100", role: "img", "aria-hidden": true },
                React.createElement("circle", { r: "24.5", cy: "54.200001", cx: "45.700001" }),
                React.createElement("path", { d: "M 37.240349,46.733243 72.551185,82.414382" }),
                React.createElement("rect", { x: "0", y: "0", width: "100", height: "100" }))),
        helpMessage && (React.createElement(forms_1.FormHelpMessage, { className: classes.helpMessage, color: color, rootElementId: uniqueId, describedById: forms_1.helpFor(uniqueId) }, helpMessage))));
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU2VhcmNoRmllbGQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29tcG9uZW50cy9TZWFyY2hGaWVsZC9TZWFyY2hGaWVsZC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDhDQUF3QjtBQUN4QiwyQ0FBK0I7QUFDL0IsdUNBQTBDO0FBRTFDLDJDQUsyQjtBQUMzQixpREFBd0Q7QUFDeEQseUNBQTZEO0FBRWhELFFBQUEsb0JBQW9CLEdBQUcsbUJBQW1CLENBQUM7QUFFM0MsUUFBQSxTQUFTLEdBQUcsbUJBQVUsQ0FDakMsVUFBQyxLQUFLLElBQUssT0FBQSxDQUFDO0lBQ1YsSUFBSSxFQUFFO1FBQ0osUUFBUSxFQUFFLFVBQVU7S0FDckI7SUFDRCxLQUFLLEVBQUU7UUFDTCxlQUFlLEVBQUUsMkJBQTJCO1FBQzVDLE1BQU0sRUFBRSx1QkFBdUI7UUFDL0IsWUFBWSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1FBQzlCLEtBQUssRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxPQUFPO1FBQ2pDLFVBQVUsRUFBRSxLQUFLLENBQUMsVUFBVSxDQUFDLFVBQVU7UUFDdkMsUUFBUSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDO1FBQzNCLFVBQVUsRUFBRSxJQUFJO1FBQ2hCLFdBQVcsRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQztRQUNoQywrREFBK0Q7UUFDL0Qsc0RBQXNEO1FBQ3RELFlBQVksRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQztRQUNqQyxVQUFVLEVBQUUsbUJBQW1CO1FBQy9CLFFBQVEsRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQztRQUM1QixTQUFTLEVBQUU7WUFDVCxPQUFPLEVBQUUsTUFBTTtZQUNmLGVBQWUsRUFBRSwwQkFBMEI7WUFD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LE1BQU0sRUFBQyxFQUFFLEVBQUMsV0FBVyxFQUFDLEVBQUUsRUFBQyxXQUFXLEdBQUc7Z0JBQ2pELDhCQUFNLENBQUMsRUFBQywyQ0FBMkMsR0FBRztnQkFFdEQsOEJBQU0sQ0FBQyxFQUFDLEdBQUcsRUFBQyxDQUFDLEVBQUMsR0FBRyxFQUFDLEtBQUssRUFBQyxLQUFLLEVBQUMsTUFBTSxFQUFDLEtBQUssR0FBRyxDQUN6QyxDQUNDO1FBQ1IsV0FBVyxJQUFJLENBQ2Qsb0JBQUMsdUJBQWUsSUFDZCxTQUFTLEVBQUUsT0FBTyxDQUFDLFdBQVcsRUFDOUIsS0FBSyxFQUFFLEtBQUssRUFDWixhQUFhLEVBQUUsUUFBUSxFQUN2QixhQUFhLEVBQUUsZUFBTyxDQUFDLFFBQVEsQ0FBQyxJQUUvQixXQUFXLENBQ0ksQ0FDbkIsQ0FDRyxDQUNQLENBQUM7QUFDSixDQUFDLENBQ0YsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjbHN4IGZyb20gJ2Nsc3gnO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgbWFrZVN0eWxlcyB9IGZyb20gJy4uLy4uL3N0eWxlcyc7XG5pbXBvcnQgeyBHZXRDbGFzc2VzIH0gZnJvbSAnLi4vLi4vdHlwZVV0aWxzJztcbmltcG9ydCB7XG4gIEJhc2VGb3JtRWxlbWVudCxcbiAgYnVpbGREZXNjcmliZWRCeSxcbiAgRm9ybUhlbHBNZXNzYWdlLFxuICBoZWxwRm9yLFxufSBmcm9tICcuLi9fcHJpdmF0ZS9mb3Jtcyc7XG5pbXBvcnQgeyBnZW5lcmF0ZVVuaXF1ZUlkIH0gZnJvbSAnLi4vX3ByaXZhdGUvVW5pcXVlSWQnO1xuaW1wb3J0IHsgY2xlYXJDbGlwUGF0aCwgZGVmYXVsdENsaXBQYXRoIH0gZnJvbSAnLi9jbGlwUGF0aHMnO1xuXG5leHBvcnQgY29uc3QgU2VhcmNoRmllbGRTdHlsZXNLZXkgPSAnQ2hyb21hU2VhcmNoRmllbGQnO1xuXG5leHBvcnQgY29uc3QgdXNlU3R5bGVzID0gbWFrZVN0eWxlcyhcbiAgKHRoZW1lKSA9PiAoe1xuICAgIHJvb3Q6IHtcbiAgICAgIHBvc2l0aW9uOiAncmVsYXRpdmUnLFxuICAgIH0sXG4gICAgaW5wdXQ6IHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogJ3JnYmEoMTMyLCAxMzcsIDE2NiwgMC4xNSknLFxuICAgICAgYm9yZGVyOiBgMXB4IHNvbGlkIHRyYW5zcGFyZW50YCxcbiAgICAgIGJvcmRlclJhZGl1czogdGhlbWUucHhUb1JlbSg0KSxcbiAgICAgIGNvbG9yOiB0aGVtZS5wYWxldHRlLnRleHQucHJpbWFyeSxcbiAgICAgIGZvbnRGYW1pbHk6IHRoZW1lLnR5cG9ncmFwaHkuZm9udEZhbWlseSxcbiAgICAgIGZvbnRTaXplOiB0aGVtZS5weFRvUmVtKDE0KSxcbiAgICAgIGxpbmVIZWlnaHQ6IDEuMjUsXG4gICAgICBwYWRkaW5nTGVmdDogdGhlbWUuc3BhY2luZygxLjI1KSxcbiAgICAgIC8vIFJlcXVpcmVzIG1vcmUgcGFkZGluZ1JpZ2h0IHNvIHdlIGdpdmUgdGhlIHNlYXJjaCBpY29uIGVub3VnaFxuICAgICAgLy8gcm9vbSB3aGVuIHRoZSB0ZXh0IGluc2lkZSB0aGUgc2VhcmNoIGZpZWxkIGlzIGxvbmcuXG4gICAgICBwYWRkaW5nUmlnaHQ6IHRoZW1lLnNwYWNpbmcoMy43NSksXG4gICAgICB0cmFuc2l0aW9uOiAnYm9yZGVyIDAuMjVzIGVhc2UnLFxuICAgICAgbWF4V2lkdGg6IHRoZW1lLnB4VG9SZW0oMTczKSxcbiAgICAgICcmOmZvY3VzJzoge1xuICAgICAgICBvdXRsaW5lOiAnbm9uZScsXG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC41KScsXG4gICAgICAgIGJvcmRlcjogYDFweCBzb2xpZCByZ2JhKDEzMiwgMTM3LCAxNjYsIDAuNDUpYCxcbiAgICAgIH0sXG4gICAgICAnJjpkaXNhYmxlZCc6IHtcbiAgICAgICAgY3Vyc29yOiAnbm90LWFsbG93ZWQnLFxuICAgICAgICBvcGFjaXR5OiAwLjYyNSxcbiAgICAgICAgJyYgKyAkYnV0dG9uJzoge1xuICAgICAgICAgIGN1cnNvcjogJ25vdC1hbGxvd2VkJyxcbiAgICAgICAgICBvcGFjaXR5OiAwLjYyNSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICAnJjo6LXdlYmtpdC1pbnB1dC1wbGFjZWhvbGRlcic6IHtcbiAgICAgICAgY29sb3I6IHRoZW1lLnBhbGV0dGUuYmxhY2tbNDAwXSxcbiAgICAgIH0sXG4gICAgICAnJjo6LW1vei1wbGFjZWhvbGRlcic6IHtcbiAgICAgICAgY29sb3I6IHRoZW1lLnBhbGV0dGUuYmxhY2tbNDAwXSxcbiAgICAgIH0sXG4gICAgICAnJjotbXMtaW5wdXQtcGxhY2Vob2xkZXInOiB7XG4gICAgICAgIGNvbG9yOiB0aGVtZS5wYWxldHRlLmJsYWNrWzQwMF0sXG4gICAgICB9LFxuICAgICAgJyY6LW1vei1wbGFjZWhvbGRlcic6IHtcbiAgICAgICAgY29sb3I6IHRoZW1lLnBhbGV0dGUuYmxhY2tbNDAwXSxcbiAgICAgIH0sXG4gICAgICAvLyBIaWRlIHRoZSB3ZWJraXQgY2xlYXIgKHgpIGJ1dHRvblxuICAgICAgJyY6Oi13ZWJraXQtc2VhcmNoLWRlY29yYXRpb24sJjo6LXdlYmtpdC1zZWFyY2gtY2FuY2VsLWJ1dHRvbiwmOjotd2Via2l0LXNlYXJjaC1yZXN1bHRzLWJ1dHRvbiwmOjotd2Via2l0LXNlYXJjaC1yZXN1bHRzLWRlY29yYXRpb24nOiB7XG4gICAgICAgIGRpc3BsYXk6ICdub25lJyxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBpbnB1dEludmVyc2U6IHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogJ3JnYmEoMjMwLCAyMzEsIDIzNywgMC4xKScsXG4gICAgICBjb2xvcjogdGhlbWUucGFsZXR0ZS5jb21tb24ud2hpdGUsXG4gICAgICAnJjpmb2N1cyc6IHtcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiAncmdiYSgyMzAsIDIzMSwgMjM3LCAwLjEpJyxcbiAgICAgICAgYm9yZGVyOiBgMXB4IHNvbGlkIHJnYmEoMjMwLCAyMzEsIDIzNywgMC41NSlgLFxuICAgICAgfSxcbiAgICAgICcmOjotd2Via2l0LWlucHV0LXBsYWNlaG9sZGVyJzoge1xuICAgICAgICBjb2xvcjogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC44KScsXG4gICAgICB9LFxuICAgICAgJyY6Oi1tb3otcGxhY2Vob2xkZXInOiB7XG4gICAgICAgIGNvbG9yOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjgpJyxcbiAgICAgIH0sXG4gICAgICAnJjotbXMtaW5wdXQtcGxhY2Vob2xkZXInOiB7XG4gICAgICAgIGNvbG9yOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjgpJyxcbiAgICAgIH0sXG4gICAgICAnJjotbW96LXBsYWNlaG9sZGVyJzoge1xuICAgICAgICBjb2xvcjogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC44KScsXG4gICAgICB9LFxuICAgIH0sXG4gICAgaW5wdXRIZWlnaHQwOiB7XG4gICAgICBwYWRkaW5nQm90dG9tOiB0aGVtZS5zcGFjaW5nKDAuNSksXG4gICAgICBwYWRkaW5nVG9wOiB0aGVtZS5zcGFjaW5nKDAuNSksXG4gICAgfSxcbiAgICBpbnB1dEhlaWdodDE6IHtcbiAgICAgIHBhZGRpbmdCb3R0b206IHRoZW1lLnNwYWNpbmcoMSksXG4gICAgICBwYWRkaW5nVG9wOiB0aGVtZS5zcGFjaW5nKDEpLFxuICAgIH0sXG4gICAgZnVsbFdpZHRoOiB7XG4gICAgICAnJiAkaW5wdXQnOiB7XG4gICAgICAgIG1heFdpZHRoOiAnbm9uZScsXG4gICAgICAgIHdpZHRoOiAnMTAwJScsXG4gICAgICB9LFxuICAgICAgJyYgJGJ1dHRvbic6IHtcbiAgICAgICAgbGVmdDogJ2F1dG8nLFxuICAgICAgICByaWdodDogdGhlbWUucHhUb1JlbSg1KSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBidXR0b246IHtcbiAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgbGVmdDogdGhlbWUucHhUb1JlbSgxNDQpLFxuICAgICAgYWxpZ25JdGVtczogJ2NlbnRlcicsXG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6ICd0cmFuc3BhcmVudCcsXG4gICAgICBib3JkZXI6IDAsXG4gICAgICBjb2xvcjogdGhlbWUucGFsZXR0ZS5ibGFja1s1MDBdLFxuICAgICAgY3Vyc29yOiAncG9pbnRlcicsXG4gICAgICBkaXNwbGF5OiAnaW5saW5lLWZsZXgnLFxuICAgICAgZmxleDogJzAgMCBhdXRvJyxcbiAgICAgIGp1c3RpZnlDb250ZW50OiAnY2VudGVyJyxcbiAgICAgIG1hcmdpbjogMCxcbiAgICAgIG91dGxpbmU6ICdub25lJyxcbiAgICAgIHBhZGRpbmc6IDAsXG4gICAgICB0cmFuc2l0aW9uOiAnY29sb3IgMC4yNXMgZWFzZSwgb3BhY2l0eSAwLjI1cyBlYXNlJyxcbiAgICAgIHVzZXJTZWxlY3Q6ICdub25lJyxcbiAgICB9LFxuICAgIGJ1dHRvbkhlaWdodDA6IHtcbiAgICAgIHRvcDogdGhlbWUucHhUb1JlbSgwLjI1KSxcbiAgICB9LFxuICAgIGJ1dHRvbkhlaWdodDE6IHtcbiAgICAgIHRvcDogdGhlbWUucHhUb1JlbSg0KSxcbiAgICB9LFxuICAgIGJ1dHRvblN2Zzoge1xuICAgICAgd2lkdGg6IHRoZW1lLnB4VG9SZW0oMjQpLFxuICAgICAgaGVpZ2h0OiB0aGVtZS5weFRvUmVtKDI0KSxcbiAgICAgIC8vIEdsYXNzXG4gICAgICAnJiA+IGNpcmNsZSc6IHtcbiAgICAgICAgZmlsbDogJ3RyYW5zcGFyZW50JyxcbiAgICAgICAgc3Ryb2tlOiB0aGVtZS5wYWxldHRlLmJsYWNrWzUwMF0sXG4gICAgICAgIHN0cm9rZVdpZHRoOiA2LFxuICAgICAgICBzdHJva2VMaW5lY2FwOiAncm91bmQnLFxuICAgICAgfSxcbiAgICAgIC8vIE1hZ25pZnlpbmcgZ2xhc3MgcG9sZSBwYXJ0XG4gICAgICAnJiA+IHBhdGgnOiB7XG4gICAgICAgIGZpbGw6ICdub25lJyxcbiAgICAgICAgc3Ryb2tlOiB0aGVtZS5wYWxldHRlLmJsYWNrWzUwMF0sXG4gICAgICAgIHN0cm9rZURhc2hhcnJheTogJzEwIDUwJyxcbiAgICAgICAgc3Ryb2tlRGFzaG9mZnNldDogMjAsXG4gICAgICAgIHN0cm9rZUxpbmVjYXA6ICdyb3VuZCcsXG4gICAgICAgIHN0cm9rZVdpZHRoOiA3LFxuICAgICAgICB0cmFuc2l0aW9uOlxuICAgICAgICAgICdzdHJva2UtZGFzaGFycmF5IDIwMG1zLCBzdHJva2UtZGFzaG9mZnNldCAyMDBtcywgc3Ryb2tlIDIwMG1zJyxcbiAgICAgICAgJ0BtZWRpYSAocHJlZmVycy1yZWR1Y2VkLW1vdGlvbjogcmVkdWNlKSc6IHtcbiAgICAgICAgICB0cmFuc2l0aW9uOiAnbm9uZScsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgLy8gQmFja2dyb3VuZCBjaXJjbGUgZm9yIGdsYXNzIGFuZCBYIGNsZWFyXG4gICAgICAnJiA+IHJlY3QnOiB7XG4gICAgICAgIGNsaXBQYXRoOiBkZWZhdWx0Q2xpcFBhdGgsXG4gICAgICAgIFdlYmtpdENsaXBQYXRoOiBkZWZhdWx0Q2xpcFBhdGgsXG4gICAgICAgIGZpbGw6ICd0cmFuc3BhcmVudCcsXG4gICAgICAgIHRyYW5zaXRpb246ICdjbGlwLXBhdGggMTAwbXMgMTAwbXMnLFxuICAgICAgICAnQG1lZGlhIChwcmVmZXJzLXJlZHVjZWQtbW90aW9uOiByZWR1Y2UpJzoge1xuICAgICAgICAgIHRyYW5zaXRpb246ICdub25lJyxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBidXR0b25TdmdJbnZlcnNlOiB7XG4gICAgICAnJiA+IGNpcmNsZSc6IHtcbiAgICAgICAgc3Ryb2tlOiB0aGVtZS5wYWxldHRlLmNvbW1vbi53aGl0ZSxcbiAgICAgIH0sXG4gICAgICAnJiA+IHBhdGgnOiB7XG4gICAgICAgIHN0cm9rZTogdGhlbWUucGFsZXR0ZS5jb21tb24ud2hpdGUsXG4gICAgICB9LFxuICAgIH0sXG4gICAgYnV0dG9uU3ZnQ2xlYXI6IHtcbiAgICAgIG1hcmdpblRvcDogdGhlbWUuc3BhY2luZygwLjEyNSksXG4gICAgICAnJiA+IGNpcmNsZSc6IHtcbiAgICAgICAgZmlsbDogdGhlbWUucGFsZXR0ZS5ibGFja1s1MDBdLFxuICAgICAgfSxcbiAgICAgICcmID4gcGF0aCc6IHtcbiAgICAgICAgc3Ryb2tlRGFzaGFycmF5OiAnMjQgNTAnLFxuICAgICAgICBzdHJva2VEYXNob2Zmc2V0OiA3NCxcbiAgICAgICAgc3Ryb2tlOiB0aGVtZS5wYWxldHRlLmNvbW1vbi53aGl0ZSxcbiAgICAgIH0sXG4gICAgICAnJiA+IHJlY3QnOiB7XG4gICAgICAgIGNsaXBQYXRoOiBjbGVhckNsaXBQYXRoLFxuICAgICAgICBXZWJraXRDbGlwUGF0aDogY2xlYXJDbGlwUGF0aCxcbiAgICAgICAgZmlsbDogdGhlbWUucGFsZXR0ZS5jb21tb24ud2hpdGUsXG4gICAgICAgIHRyYW5zaXRpb246ICdjbGlwLXBhdGggMTAwbXMnLFxuICAgICAgICAnQG1lZGlhIChwcmVmZXJzLXJlZHVjZWQtbW90aW9uOiByZWR1Y2UpJzoge1xuICAgICAgICAgIHRyYW5zaXRpb246ICdub25lJyxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBidXR0b25TdmdDbGVhckludmVyc2U6IHtcbiAgICAgICcmID4gY2lyY2xlJzoge1xuICAgICAgICBmaWxsOiB0aGVtZS5wYWxldHRlLmNvbW1vbi53aGl0ZSxcbiAgICAgICAgc3Ryb2tlOiB0aGVtZS5wYWxldHRlLmNvbW1vbi53aGl0ZSxcbiAgICAgIH0sXG4gICAgICAnJiA+IHBhdGgnOiB7XG4gICAgICAgIHN0cm9rZTogdGhlbWUucGFsZXR0ZS5ibHVlWzcwMF0sXG4gICAgICB9LFxuICAgICAgJyYgPiByZWN0Jzoge1xuICAgICAgICBmaWxsOiB0aGVtZS5wYWxldHRlLmJsdWVbNzAwXSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBoZWxwTWVzc2FnZToge1xuICAgICAgbWFyZ2luVG9wOiB0aGVtZS5zcGFjaW5nKDEpLFxuICAgICAgbWFyZ2luTGVmdDogMCxcbiAgICB9LFxuICB9KSxcbiAgeyBuYW1lOiBTZWFyY2hGaWVsZFN0eWxlc0tleSB9XG4pO1xuXG5leHBvcnQgdHlwZSBTZWFyY2hGaWVsZENsYXNzZXMgPSBHZXRDbGFzc2VzPHR5cGVvZiB1c2VTdHlsZXM+O1xuXG5leHBvcnQgaW50ZXJmYWNlIFNlYXJjaEZpZWxkUHJvcHNcbiAgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnRQcm9wc1dpdGhSZWY8J2lucHV0Jz4sXG4gICAgUGljazxCYXNlRm9ybUVsZW1lbnQsICdoZWxwTWVzc2FnZSc+IHtcbiAgYnV0dG9uVHlwZT86IHN0cmluZztcbiAgY29sb3I/OiAnZGVmYXVsdCcgfCAnaW52ZXJzZSc7XG4gIGRpc2FibGVDbGVhck9uU2VhcmNoPzogYm9vbGVhbjtcbiAgZnVsbFdpZHRoPzogYm9vbGVhbjtcbiAgb25DbGVhcj86ICgpID0+IGFueTtcbiAgb25TZWFyY2g/KHRleHRWYWx1ZTogc3RyaW5nIHwgbnVtYmVyIHwgc3RyaW5nW10gfCB1bmRlZmluZWQpOiBhbnk7XG4gIGhlaWdodD86IDAgfCAxO1xufVxuXG5leHBvcnQgY29uc3QgU2VhcmNoRmllbGQgPSBSZWFjdC5mb3J3YXJkUmVmPEhUTUxJbnB1dEVsZW1lbnQsIFNlYXJjaEZpZWxkUHJvcHM+KFxuICAoXG4gICAge1xuICAgICAgY2xhc3NOYW1lLFxuICAgICAgY29sb3IgPSAnZGVmYXVsdCcsXG4gICAgICBkaXNhYmxlQ2xlYXJPblNlYXJjaCA9IGZhbHNlLFxuICAgICAgZnVsbFdpZHRoLFxuICAgICAgaGVpZ2h0ID0gMSxcbiAgICAgIGlkLFxuICAgICAgbmFtZSxcbiAgICAgIGhlbHBNZXNzYWdlLFxuICAgICAgb25DaGFuZ2UsXG4gICAgICBvblNlYXJjaCxcbiAgICAgIG9uQ2xlYXIsXG4gICAgICB2YWx1ZSxcbiAgICAgIC4uLnJvb3RQcm9wc1xuICAgIH0sXG4gICAgcmVmXG4gICkgPT4ge1xuICAgIGNvbnN0IGNsYXNzZXMgPSB1c2VTdHlsZXMoe30pO1xuXG4gICAgY29uc3QgW3VuaXF1ZUlkXSA9IFJlYWN0LnVzZVN0YXRlPHN0cmluZz4oXG4gICAgICAoKSA9PiBpZCB8fCBuYW1lIHx8IGdlbmVyYXRlVW5pcXVlSWQoJ3NlYXJjaEZpZWxkLScpXG4gICAgKTtcblxuICAgIGNvbnN0IFtzaG93Q2xlYXIsIHNldFNob3dDbGVhcl0gPSBSZWFjdC51c2VTdGF0ZTxib29sZWFuPihmYWxzZSk7XG4gICAgY29uc3QgW3NlYXJjaFRleHQsIHNldFNlYXJjaFRleHRdID0gUmVhY3QudXNlU3RhdGU8c3RyaW5nPignJyk7XG5cbiAgICBjb25zdCBoYW5kbGVGb2N1cyA9IChlOiBSZWFjdC5Gb2N1c0V2ZW50PEhUTUxJbnB1dEVsZW1lbnQ+KSA9PiB7XG4gICAgICBpZiAoZS50YXJnZXQudmFsdWUubGVuZ3RoID4gMCkge1xuICAgICAgICBzZXRTaG93Q2xlYXIodHJ1ZSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGNvbnN0IGhhbmRsZUJsdXIgPSAoKSA9PiB7XG4gICAgICBpZiAoc2VhcmNoVGV4dC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgc2V0U2hvd0NsZWFyKGZhbHNlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uc3QgaGFuZGxlQ2hhbmdlID0gKGU6IFJlYWN0LkNoYW5nZUV2ZW50PEhUTUxJbnB1dEVsZW1lbnQ+KSA9PiB7XG4gICAgICBzZXRTZWFyY2hUZXh0KGUudGFyZ2V0LnZhbHVlKTtcblxuICAgICAgaWYgKHNob3dDbGVhciAmJiBlLnRhcmdldC52YWx1ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgc2V0U2hvd0NsZWFyKGZhbHNlKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFzaG93Q2xlYXIgJiYgZS50YXJnZXQudmFsdWUubGVuZ3RoID4gMCkge1xuICAgICAgICBzZXRTaG93Q2xlYXIodHJ1ZSk7XG4gICAgICB9XG5cbiAgICAgIG9uQ2hhbmdlPy4oZSk7XG4gICAgfTtcblxuICAgIGNvbnN0IGhhbmRsZUtleVByZXNzID0gKGU6IFJlYWN0LktleWJvYXJkRXZlbnQ8SFRNTElucHV0RWxlbWVudD4pID0+IHtcbiAgICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJyAmJiAhZGlzYWJsZUNsZWFyT25TZWFyY2gpIHtcbiAgICAgICAgc2V0U2hvd0NsZWFyKGZhbHNlKTtcbiAgICAgICAgb25TZWFyY2ggJiYgb25TZWFyY2goc2VhcmNoVGV4dCk7XG4gICAgICAgIHNldFNlYXJjaFRleHQoJycpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicgJiYgZGlzYWJsZUNsZWFyT25TZWFyY2gpIHtcbiAgICAgICAgb25TZWFyY2ggJiYgb25TZWFyY2goc2VhcmNoVGV4dCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGNvbnN0IGhhbmRsZUNsZWFyQnV0dG9uQ2xpY2sgPSAoKSA9PiB7XG4gICAgICBzZXRTZWFyY2hUZXh0KCcnKTtcbiAgICAgIHNldFNob3dDbGVhcihmYWxzZSk7XG4gICAgICBvbkNsZWFyPy4oKTtcbiAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodW5pcXVlSWQpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICBjb25zdCBldmVudCA9IG5ldyBFdmVudCgnY2hhbmdlJyk7XG4gICAgICBpbnB1dC52YWx1ZSA9ICcnO1xuICAgICAgaW5wdXQuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgICBvbkNoYW5nZT8uKChldmVudCBhcyB1bmtub3duKSBhcyBSZWFjdC5DaGFuZ2VFdmVudDxIVE1MSW5wdXRFbGVtZW50Pik7XG4gICAgfTtcblxuICAgIHJldHVybiAoXG4gICAgICA8ZGl2XG4gICAgICAgIGNsYXNzTmFtZT17Y2xzeChcbiAgICAgICAgICBjbGFzc2VzLnJvb3QsXG4gICAgICAgICAgZnVsbFdpZHRoICYmIGNsYXNzZXMuZnVsbFdpZHRoLFxuICAgICAgICAgIGNsYXNzTmFtZVxuICAgICAgICApfVxuICAgICAgPlxuICAgICAgICA8aW5wdXRcbiAgICAgICAgICBhcmlhLWRlc2NyaWJlZGJ5PXtidWlsZERlc2NyaWJlZEJ5KHtcbiAgICAgICAgICAgIGhhc0hlbHBNZXNzYWdlOiAhIWhlbHBNZXNzYWdlLFxuICAgICAgICAgICAgdW5pcXVlSWQsXG4gICAgICAgICAgfSl9XG4gICAgICAgICAgY2xhc3NOYW1lPXtjbHN4KFxuICAgICAgICAgICAgY2xhc3Nlcy5pbnB1dCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgW2NsYXNzZXMuaW5wdXRJbnZlcnNlXTogY29sb3IgPT09ICdpbnZlcnNlJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIFtjbGFzc2VzLmlucHV0SGVpZ2h0MF06IGhlaWdodCA9PT0gMCxcbiAgICAgICAgICAgICAgW2NsYXNzZXMuaW5wdXRIZWlnaHQxXTogaGVpZ2h0ID09PSAxLFxuICAgICAgICAgICAgfVxuICAgICAgICAgICl9XG4gICAgICAgICAgaWQ9e3VuaXF1ZUlkfVxuICAgICAgICAgIG5hbWU9e25hbWV9XG4gICAgICAgICAgcmVmPXtyZWZ9XG4gICAgICAgICAgdHlwZT1cInNlYXJjaFwiXG4gICAgICAgICAgb25DaGFuZ2U9e2hhbmRsZUNoYW5nZX1cbiAgICAgICAgICBvbktleVByZXNzPXtoYW5kbGVLZXlQcmVzc31cbiAgICAgICAgICBvbkZvY3VzPXtoYW5kbGVGb2N1c31cbiAgICAgICAgICBvbkJsdXI9e2hhbmRsZUJsdXJ9XG4gICAgICAgICAgdmFsdWU9e3NlYXJjaFRleHR9XG4gICAgICAgICAgey4uLnJvb3RQcm9wc31cbiAgICAgICAgLz5cbiAgICAgICAgPGJ1dHRvblxuICAgICAgICAgIGFyaWEtbGFiZWw9e3Nob3dDbGVhciA/ICdDbGVhciBpbnB1dCcgOiAnU2VhcmNoJ31cbiAgICAgICAgICBjbGFzc05hbWU9e2Nsc3goY2xhc3Nlcy5idXR0b24sIHtcbiAgICAgICAgICAgIFtjbGFzc2VzLmJ1dHRvbkhlaWdodDBdOiBoZWlnaHQgPT09IDAsXG4gICAgICAgICAgICBbY2xhc3Nlcy5idXR0b25IZWlnaHQxXTogaGVpZ2h0ID09PSAxLFxuICAgICAgICAgIH0pfVxuICAgICAgICAgIHRhYkluZGV4PXstMX1cbiAgICAgICAgICBvbkNsaWNrPXtoYW5kbGVDbGVhckJ1dHRvbkNsaWNrfVxuICAgICAgICA+XG4gICAgICAgICAgPHN2Z1xuICAgICAgICAgICAgY2xhc3NOYW1lPXtjbHN4KFxuICAgICAgICAgICAgICBjbGFzc2VzLmJ1dHRvblN2ZyxcbiAgICAgICAgICAgICAgY29sb3IgPT09ICdpbnZlcnNlJyAmJiBjbGFzc2VzLmJ1dHRvblN2Z0ludmVyc2UsXG4gICAgICAgICAgICAgIHNob3dDbGVhciAmJiBjbGFzc2VzLmJ1dHRvblN2Z0NsZWFyLFxuICAgICAgICAgICAgICBjb2xvciA9PT0gJ2ludmVyc2UnICYmIHNob3dDbGVhciAmJiBjbGFzc2VzLmJ1dHRvblN2Z0NsZWFySW52ZXJzZVxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIHZpZXdCb3g9XCIwIDAgMTAwIDEwMFwiXG4gICAgICAgICAgICByb2xlPVwiaW1nXCJcbiAgICAgICAgICAgIGFyaWEtaGlkZGVuXG4gICAgICAgICAgPlxuICAgICAgICAgICAgPGNpcmNsZSByPVwiMjQuNVwiIGN5PVwiNTQuMjAwMDAxXCIgY3g9XCI0NS43MDAwMDFcIiAvPlxuICAgICAgICAgICAgPHBhdGggZD1cIk0gMzcuMjQwMzQ5LDQ2LjczMzI0MyA3Mi41NTExODUsODIuNDE0MzgyXCIgLz5cblxuICAgICAgICAgICAgPHJlY3QgeD1cIjBcIiB5PVwiMFwiIHdpZHRoPVwiMTAwXCIgaGVpZ2h0PVwiMTAwXCIgLz5cbiAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgPC9idXR0b24+XG4gICAgICAgIHtoZWxwTWVzc2FnZSAmJiAoXG4gICAgICAgICAgPEZvcm1IZWxwTWVzc2FnZVxuICAgICAgICAgICAgY2xhc3NOYW1lPXtjbGFzc2VzLmhlbHBNZXNzYWdlfVxuICAgICAgICAgICAgY29sb3I9e2NvbG9yfVxuICAgICAgICAgICAgcm9vdEVsZW1lbnRJZD17dW5pcXVlSWR9XG4gICAgICAgICAgICBkZXNjcmliZWRCeUlkPXtoZWxwRm9yKHVuaXF1ZUlkKX1cbiAgICAgICAgICA+XG4gICAgICAgICAgICB7aGVscE1lc3NhZ2V9XG4gICAgICAgICAgPC9Gb3JtSGVscE1lc3NhZ2U+XG4gICAgICAgICl9XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG4pO1xuIl19