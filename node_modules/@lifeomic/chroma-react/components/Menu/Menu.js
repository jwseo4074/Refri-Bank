"use strict";
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.Menu = exports.useStyles = exports.MenuStylesKey = void 0;
var ConditionalWrapper_1 = require("../_private/ConditionalWrapper");
var styles_1 = require("../../styles");
var MenuItem_1 = require("./MenuItem");
var framer_motion_1 = require("framer-motion");
var Portal_1 = require("reakit/Portal");
var Text_1 = require("../Text");
var Menu_1 = require("reakit/Menu");
var clsx_1 = __importDefault(require("clsx"));
var React = __importStar(require("react"));
require("focus-visible");
exports.MenuStylesKey = 'ChromaMenu';
exports.useStyles = (0, styles_1.makeStyles)(function (theme) { return ({
    root: {
        backgroundColor: theme.palette.common.white,
        borderRadius: theme.pxToRem(10),
        boxShadow: theme.boxShadows.popover,
        maxHeight: theme.pxToRem(432),
        minWidth: theme.pxToRem(224),
        overflowY: 'auto',
        paddingBottom: theme.spacing(1),
        paddingTop: theme.spacing(1),
        zIndex: 40,
        '&:focus': {
            outline: 'none',
        },
        '&:focus.focus-visible': {
            boxShadow: theme.boxShadows.focusVisible,
        },
    },
    title: {
        paddingBottom: theme.spacing(2),
        paddingLeft: theme.spacing(2.5),
        paddingRight: theme.spacing(2.5),
    },
}); }, { name: exports.MenuStylesKey });
var isMenuItemElement = function (el) { return el.type === MenuItem_1.MenuItem; };
var Menu = function (_a) {
    var ariaLabel = _a["aria-label"], anchorElement = _a.anchorElement, children = _a.children, className = _a.className, gutter = _a.gutter, items = _a.items, _b = _a.placement, placement = _b === void 0 ? 'bottom' : _b, title = _a.title, _c = _a.usePortal, usePortal = _c === void 0 ? false : _c, rootProps = __rest(_a, ['aria-label', "anchorElement", "children", "className", "gutter", "items", "placement", "title", "usePortal"]);
    var classes = (0, exports.useStyles)({});
    var shouldReduceMotion = (0, framer_motion_1.useReducedMotion)();
    var menu = (0, Menu_1.useMenuState)({ placement: placement, gutter: gutter });
    var handleStopPropagation = function (e) {
        return e.stopPropagation();
    };
    return (React.createElement(React.Fragment, null,
        React.createElement(Menu_1.MenuButton, __assign({}, menu, anchorElement.props, { onClick: handleStopPropagation }), function (disclosureProps) {
            return React.cloneElement(React.Children.only(anchorElement), disclosureProps);
        }),
        React.createElement(ConditionalWrapper_1.ConditionalWrapper, { condition: usePortal, wrapper: function (children) { return React.createElement(Portal_1.Portal, null, children); } },
            React.createElement(Menu_1.Menu, __assign({}, menu, { as: framer_motion_1.motion.div, "aria-label": ariaLabel, className: (0, clsx_1.default)(classes.root, className), animate: menu.visible
                    ? shouldReduceMotion
                        ? { opacity: 1 }
                        : {
                            opacity: 1,
                            transition: { duration: 0.3 },
                        }
                    : shouldReduceMotion
                        ? { opacity: 0 }
                        : {
                            opacity: 0,
                            transition: { duration: 0.1 },
                        } }, rootProps),
                !!title && (React.createElement(Text_1.Text, { className: classes.title, weight: "bold", size: "subbody" }, title)),
                items &&
                    items.map(function (item, i) {
                        return isMenuItemElement(item) ? (React.createElement(Menu_1.MenuItem, __assign({}, menu, item.props, { key: "item-".concat(i), onClick: function (e) {
                                menu.hide();
                                item.props.onClick && item.props.onClick(e);
                            } }), function (itemProps) {
                            return React.cloneElement(React.Children.only(item), itemProps);
                        })) : (item);
                    })))));
};
exports.Menu = Menu;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTWVudS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL01lbnUvTWVudS50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEscUVBQW9FO0FBRXBFLHVDQUEwQztBQUMxQyx1Q0FBcUQ7QUFDckQsK0NBQXlEO0FBQ3pELHdDQUF1QztBQUN2QyxnQ0FBK0I7QUFDL0Isb0NBTXFCO0FBQ3JCLDhDQUF3QjtBQUN4QiwyQ0FBK0I7QUFDL0IseUJBQXVCO0FBR1YsUUFBQSxhQUFhLEdBQUcsWUFBWSxDQUFDO0FBRTdCLFFBQUEsU0FBUyxHQUFHLElBQUEsbUJBQVUsRUFDakMsVUFBQyxLQUFLLElBQUssT0FBQSxDQUFDO0lBQ1YsSUFBSSxFQUFFO1FBQ0osZUFBZSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUs7UUFDM0MsWUFBWSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDO1FBQy9CLFNBQVMsRUFBRSxLQUFLLENBQUMsVUFBVSxDQUFDLE9BQU87UUFDbkMsU0FBUyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDO1FBQzdCLFFBQVEsRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQztRQUM1QixTQUFTLEVBQUUsTUFBTTtRQUNqQixhQUFhLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFDL0IsVUFBVSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1FBQzVCLE1BQU0sRUFBRSxFQUFFO1FBQ1YsU0FBUyxFQUFFO1lBQ1QsT0FBTyxFQUFFLE1BQU07U0FDaEI7UUFDRCx1QkFBdUIsRUFBRTtZQUN2QixTQUFTLEVBQUUsS0FBSyxDQUFDLFVBQVUsQ0FBQyxZQUFZO1NBQ3pDO0tBQ0Y7SUFDRCxLQUFLLEVBQUU7UUFD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QkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FDeEIsb0JBQUMsZUFBYyxlQUNULElBQUksRUFDSixJQUFJLENBQUMsS0FBSyxJQUNkLEdBQUcsRUFBRSxlQUFRLENBQUMsQ0FBRSxFQUNoQixPQUFPLEVBQUUsVUFBQyxDQUFNO2dDQUNkLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztnQ0FDWixJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQzs0QkFDOUMsQ0FBQyxLQUVBLFVBQUMsU0FBUzs0QkFDVCxPQUFBLEtBQUssQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsU0FBUyxDQUFDO3dCQUF4RCxDQUF3RCxDQUUzQyxDQUNsQixDQUFDLENBQUMsQ0FBQyxDQUNGLElBQUksQ0FDTDtvQkFoQkQsQ0FnQkMsQ0FDRixDQUNRLENBQ00sQ0FDcEIsQ0FDSixDQUFDO0FBQ0osQ0FBQyxDQUFDO0FBMUZXLFFBQUEsSUFBSSxRQTBGZiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbmRpdGlvbmFsV3JhcHBlciB9IGZyb20gJy4uL19wcml2YXRlL0NvbmRpdGlvbmFsV3JhcHBlcic7XG5pbXBvcnQgeyBHZXRDbGFzc2VzIH0gZnJvbSAnLi4vLi4vdHlwZVV0aWxzJztcbmltcG9ydCB7IG1ha2VTdHlsZXMgfSBmcm9tICcuLi8uLi9zdHlsZXMnO1xuaW1wb3J0IHsgTWVudUl0ZW0sIE1lbnVJdGVtUHJvcHMgfSBmcm9tICcuL01lbnVJdGVtJztcbmltcG9ydCB7IG1vdGlvbiwgdXNlUmVkdWNlZE1vdGlvbiB9IGZyb20gJ2ZyYW1lci1tb3Rpb24nO1xuaW1wb3J0IHsgUG9ydGFsIH0gZnJvbSAncmVha2l0L1BvcnRhbCc7XG5pbXBvcnQgeyBUZXh0IH0gZnJvbSAnLi4vVGV4dCc7XG5pbXBvcnQge1xuICBNZW51IGFzIFJlYWtpdE1lbnUsXG4gIE1lbnVCdXR0b24sXG4gIE1lbnVJdGVtIGFzIFJlYWtpdE1lbnVJdGVtLFxuICBNZW51SW5pdGlhbFN0YXRlLFxuICB1c2VNZW51U3RhdGUsXG59IGZyb20gJ3JlYWtpdC9NZW51JztcbmltcG9ydCBjbHN4IGZyb20gJ2Nsc3gnO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0ICdmb2N1cy12aXNpYmxlJztcbmltcG9ydCB7IE1lbnVHcm91cEhlYWRpbmdQcm9wcyB9IGZyb20gJy4vTWVudUdyb3VwSGVhZGluZyc7XG5cbmV4cG9ydCBjb25zdCBNZW51U3R5bGVzS2V5ID0gJ0Nocm9tYU1lbnUnO1xuXG5leHBvcnQgY29uc3QgdXNlU3R5bGVzID0gbWFrZVN0eWxlcyhcbiAgKHRoZW1lKSA9PiAoe1xuICAgIHJvb3Q6IHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogdGhlbWUucGFsZXR0ZS5jb21tb24ud2hpdGUsXG4gICAgICBib3JkZXJSYWRpdXM6IHRoZW1lLnB4VG9SZW0oMTApLFxuICAgICAgYm94U2hhZG93OiB0aGVtZS5ib3hTaGFkb3dzLnBvcG92ZXIsXG4gICAgICBtYXhIZWlnaHQ6IHRoZW1lLnB4VG9SZW0oNDMyKSxcbiAgICAgIG1pbldpZHRoOiB0aGVtZS5weFRvUmVtKDIyNCksXG4gICAgICBvdmVyZmxvd1k6ICdhdXRvJyxcbiAgICAgIHBhZGRpbmdCb3R0b206IHRoZW1lLnNwYWNpbmcoMSksXG4gICAgICBwYWRkaW5nVG9wOiB0aGVtZS5zcGFjaW5nKDEpLFxuICAgICAgekluZGV4OiA0MCxcbiAgICAgICcmOmZvY3VzJzoge1xuICAgICAgICBvdXRsaW5lOiAnbm9uZScsXG4gICAgICB9LFxuICAgICAgJyY6Zm9jdXMuZm9jdXMtdmlzaWJsZSc6IHtcbiAgICAgICAgYm94U2hhZG93OiB0aGVtZS5ib3hTaGFkb3dzLmZvY3VzVmlzaWJsZSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICB0aXRsZToge1xuICAgICAgcGFkZGluZ0JvdHRvbTogdGhlbWUuc3BhY2luZygyKSxcbiAgICAgIHBhZGRpbmdMZWZ0OiB0aGVtZS5zcGFjaW5nKDIuNSksXG4gICAgICBwYWRkaW5nUmlnaHQ6IHRoZW1lLnNwYWNpbmcoMi41KSxcbiAgICB9LFxuICB9KSxcbiAgeyBuYW1lOiBNZW51U3R5bGVzS2V5IH1cbik7XG5cbmV4cG9ydCB0eXBlIE1lbnVDbGFzc2VzID0gR2V0Q2xhc3Nlczx0eXBlb2YgdXNlU3R5bGVzPjtcblxuZXhwb3J0IGludGVyZmFjZSBNZW51UHJvcHNcbiAgZXh0ZW5kcyBQaWNrPE1lbnVJbml0aWFsU3RhdGUsICdwbGFjZW1lbnQnIHwgJ2d1dHRlcic+IHtcbiAgWydhcmlhLWxhYmVsJ106IHN0cmluZztcbiAgYW5jaG9yRWxlbWVudD86IGFueTtcbiAgY2hpbGRyZW4/OiBSZWFjdC5SZWFjdE5vZGU7XG4gIGNsYXNzTmFtZT86IHN0cmluZztcbiAgaXRlbXM/OiBBcnJheTxcbiAgICB8IFJlYWN0LlJlYWN0RWxlbWVudDxNZW51SXRlbVByb3BzPlxuICAgIHwgUmVhY3QuUmVhY3RFbGVtZW50PE1lbnVHcm91cEhlYWRpbmdQcm9wcz5cbiAgPjtcbiAgdGl0bGU/OiBzdHJpbmc7XG4gIHVzZVBvcnRhbD86IGJvb2xlYW47XG59XG5cbmNvbnN0IGlzTWVudUl0ZW1FbGVtZW50ID0gKFxuICBlbDpcbiAgICB8IFJlYWN0LlJlYWN0RWxlbWVudDxNZW51SXRlbVByb3BzPlxuICAgIHwgUmVhY3QuUmVhY3RFbGVtZW50PE1lbnVHcm91cEhlYWRpbmdQcm9wcz5cbik6IGVsIGlzIFJlYWN0LlJlYWN0RWxlbWVudDxNZW51SXRlbVByb3BzPiA9PiBlbC50eXBlID09PSBNZW51SXRlbTtcblxuZXhwb3J0IGNvbnN0IE1lbnU6IFJlYWN0LkZDPE1lbnVQcm9wcz4gPSAoe1xuICAnYXJpYS1sYWJlbCc6IGFyaWFMYWJlbCxcbiAgYW5jaG9yRWxlbWVudCxcbiAgY2hpbGRyZW4sXG4gIGNsYXNzTmFtZSxcbiAgZ3V0dGVyLFxuICBpdGVtcyxcbiAgcGxhY2VtZW50ID0gJ2JvdHRvbScsXG4gIHRpdGxlLFxuICB1c2VQb3J0YWwgPSBmYWxzZSxcbiAgLi4ucm9vdFByb3BzXG59KSA9PiB7XG4gIGNvbnN0IGNsYXNzZXMgPSB1c2VTdHlsZXMoe30pO1xuXG4gIGNvbnN0IHNob3VsZFJlZHVjZU1vdGlvbiA9IHVzZVJlZHVjZWRNb3Rpb24oKTtcblxuICBjb25zdCBtZW51ID0gdXNlTWVudVN0YXRlKHsgcGxhY2VtZW50LCBndXR0ZXIgfSk7XG5cbiAgY29uc3QgaGFuZGxlU3RvcFByb3BhZ2F0aW9uID0gKGU6IFJlYWN0LlN5bnRoZXRpY0V2ZW50KSA9PlxuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgcmV0dXJuIChcbiAgICA8PlxuICAgICAgPE1lbnVCdXR0b25cbiAgICAgICAgey4uLm1lbnV9XG4gICAgICAgIHsuLi5hbmNob3JFbGVtZW50LnByb3BzfVxuICAgICAgICBvbkNsaWNrPXtoYW5kbGVTdG9wUHJvcGFnYXRpb259XG4gICAgICA+XG4gICAgICAgIHsoZGlzY2xvc3VyZVByb3BzKSA9PlxuICAgICAgICAgIFJlYWN0LmNsb25lRWxlbWVudChcbiAgICAgICAgICAgIFJlYWN0LkNoaWxkcmVuLm9ubHkoYW5jaG9yRWxlbWVudCksXG4gICAgICAgICAgICBkaXNjbG9zdXJlUHJvcHNcbiAgICAgICAgICApXG4gICAgICAgIH1cbiAgICAgIDwvTWVudUJ1dHRvbj5cbiAgICAgIDxDb25kaXRpb25hbFdyYXBwZXJcbiAgICAgICAgY29uZGl0aW9uPXt1c2VQb3J0YWx9XG4gICAgICAgIHdyYXBwZXI9eyhjaGlsZHJlbjogUmVhY3QuUmVhY3ROb2RlKSA9PiA8UG9ydGFsPntjaGlsZHJlbn08L1BvcnRhbD59XG4gICAgICA+XG4gICAgICAgIDxSZWFraXRNZW51XG4gICAgICAgICAgey4uLm1lbnV9XG4gICAgICAgICAgYXM9e21vdGlvbi5kaXZ9XG4gICAgICAgICAgYXJpYS1sYWJlbD17YXJpYUxhYmVsfVxuICAgICAgICAgIGNsYXNzTmFtZT17Y2xzeChjbGFzc2VzLnJvb3QsIGNsYXNzTmFtZSl9XG4gICAgICAgICAgYW5pbWF0ZT17XG4gICAgICAgICAgICBtZW51LnZpc2libGVcbiAgICAgICAgICAgICAgPyBzaG91bGRSZWR1Y2VNb3Rpb25cbiAgICAgICAgICAgICAgICA/IHsgb3BhY2l0eTogMSB9XG4gICAgICAgICAgICAgICAgOiB7XG4gICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zaXRpb246IHsgZHVyYXRpb246IDAuMyB9LFxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICA6IHNob3VsZFJlZHVjZU1vdGlvblxuICAgICAgICAgICAgICA/IHsgb3BhY2l0eTogMCB9XG4gICAgICAgICAgICAgIDoge1xuICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMCxcbiAgICAgICAgICAgICAgICAgIHRyYW5zaXRpb246IHsgZHVyYXRpb246IDAuMSB9LFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgey4uLnJvb3RQcm9wc31cbiAgICAgICAgPlxuICAgICAgICAgIHshIXRpdGxlICYmIChcbiAgICAgICAgICAgIDxUZXh0IGNsYXNzTmFtZT17Y2xhc3Nlcy50aXRsZX0gd2VpZ2h0PVwiYm9sZFwiIHNpemU9XCJzdWJib2R5XCI+XG4gICAgICAgICAgICAgIHt0aXRsZX1cbiAgICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgICApfVxuICAgICAgICAgIHtpdGVtcyAmJlxuICAgICAgICAgICAgaXRlbXMubWFwKChpdGVtLCBpKSA9PlxuICAgICAgICAgICAgICBpc01lbnVJdGVtRWxlbWVudChpdGVtKSA/IChcbiAgICAgICAgICAgICAgICA8UmVha2l0TWVudUl0ZW1cbiAgICAgICAgICAgICAgICAgIHsuLi5tZW51fVxuICAgICAgICAgICAgICAgICAgey4uLml0ZW0ucHJvcHN9XG4gICAgICAgICAgICAgICAgICBrZXk9e2BpdGVtLSR7aX1gfVxuICAgICAgICAgICAgICAgICAgb25DbGljaz17KGU6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBtZW51LmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5wcm9wcy5vbkNsaWNrICYmIGl0ZW0ucHJvcHMub25DbGljayhlKTtcbiAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgeyhpdGVtUHJvcHMpID0+XG4gICAgICAgICAgICAgICAgICAgIFJlYWN0LmNsb25lRWxlbWVudChSZWFjdC5DaGlsZHJlbi5vbmx5KGl0ZW0pLCBpdGVtUHJvcHMpXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgPC9SZWFraXRNZW51SXRlbT5cbiAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICBpdGVtXG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgICl9XG4gICAgICAgIDwvUmVha2l0TWVudT5cbiAgICAgIDwvQ29uZGl0aW9uYWxXcmFwcGVyPlxuICAgIDwvPlxuICApO1xufTtcbiJdfQ==