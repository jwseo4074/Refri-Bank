"use strict";
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result["default"] = mod;
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
var ConditionalWrapper_1 = require("../_private/ConditionalWrapper");
var styles_1 = require("../../styles");
var framer_motion_1 = require("framer-motion");
var Portal_1 = require("reakit/Portal");
var Text_1 = require("../Text");
var Menu_1 = require("reakit/Menu");
var clsx_1 = __importDefault(require("clsx"));
var React = __importStar(require("react"));
require("focus-visible");
exports.MenuStylesKey = 'ChromaMenu';
exports.useStyles = styles_1.makeStyles(function (theme) { return ({
    root: {
        backgroundColor: theme.palette.common.white,
        borderRadius: theme.pxToRem(10),
        boxShadow: theme.boxShadows.popover,
        maxHeight: theme.pxToRem(432),
        minWidth: theme.pxToRem(224),
        overflowY: 'auto',
        paddingBottom: theme.spacing(2),
        paddingTop: theme.spacing(2),
        zIndex: 40,
        '&:focus': {
            outline: 'none',
        },
        '&:focus.focus-visible': {
            boxShadow: theme.boxShadows.focusVisible,
        },
    },
    title: {
        paddingBottom: theme.spacing(2),
        paddingLeft: theme.spacing(2.5),
        paddingRight: theme.spacing(2.5),
    },
}); }, { name: exports.MenuStylesKey });
exports.Menu = function (_a) {
    var ariaLabel = _a["aria-label"], anchorElement = _a.anchorElement, children = _a.children, className = _a.className, gutter = _a.gutter, items = _a.items, _b = _a.placement, placement = _b === void 0 ? 'bottom' : _b, title = _a.title, _c = _a.usePortal, usePortal = _c === void 0 ? false : _c, rootProps = __rest(_a, ['aria-label', "anchorElement", "children", "className", "gutter", "items", "placement", "title", "usePortal"]);
    var classes = exports.useStyles({});
    var shouldReduceMotion = framer_motion_1.useReducedMotion();
    var menu = Menu_1.useMenuState({ placement: placement, gutter: gutter });
    var handleStopPropagation = function (e) {
        return e.stopPropagation();
    };
    return (React.createElement(React.Fragment, null,
        React.createElement(Menu_1.MenuButton, __assign({}, menu, anchorElement.props, { onClick: handleStopPropagation }), function (disclosureProps) {
            return React.cloneElement(React.Children.only(anchorElement), disclosureProps);
        }),
        React.createElement(ConditionalWrapper_1.ConditionalWrapper, { condition: usePortal, wrapper: function (children) { return React.createElement(Portal_1.Portal, null, children); } },
            React.createElement(Menu_1.Menu, __assign({}, menu, { as: framer_motion_1.motion.div, "aria-label": ariaLabel, className: clsx_1.default(classes.root, className), animate: menu.visible
                    ? shouldReduceMotion
                        ? { opacity: 1 }
                        : {
                            opacity: 1,
                            transition: { duration: 0.3 },
                        }
                    : shouldReduceMotion
                        ? { opacity: 0 }
                        : {
                            opacity: 0,
                            transition: { duration: 0.1 },
                        } }, rootProps),
                !!title && (React.createElement(Text_1.Text, { className: classes.title, weight: "bold", size: "subbody" }, title)),
                items &&
                    items.map(function (item, i) { return (React.createElement(Menu_1.MenuItem, __assign({}, menu, item.props, { key: i, onClick: function (e) {
                            menu.hide();
                            item.props.onClick && item.props.onClick(e);
                        } }), function (itemProps) {
                        return React.cloneElement(React.Children.only(item), itemProps);
                    })); })))));
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTWVudS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL01lbnUvTWVudS50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLHFFQUFvRTtBQUVwRSx1Q0FBMEM7QUFFMUMsK0NBQXlEO0FBQ3pELHdDQUF1QztBQUN2QyxnQ0FBK0I7QUFDL0Isb0NBTXFCO0FBQ3JCLDhDQUF3QjtBQUN4QiwyQ0FBK0I7QUFDL0IseUJBQXVCO0FBRVYsUUFBQSxhQUFhLEdBQUcsWUFBWSxDQUFDO0FBRTdCLFFBQUEsU0FBUyxHQUFHLG1CQUFVLENBQ2pDLFVBQUMsS0FBSyxJQUFLLE9BQUEsQ0FBQztJQUNWLElBQUksRUFBRTtRQUNKLGVBQWUsRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxLQUFLO1FBQzNDLFlBQVksRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQztRQUMvQixTQUFTLEVBQUUsS0FBSyxDQUFDLFVBQVUsQ0FBQyxPQUFPO1FBQ25DLFNBQVMsRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQztRQUM3QixRQUFRLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUM7UUFDNUIsU0FBUyxFQUFFLE1BQU07UUFDakIsYUFBYSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1FBQy9CLFVBQVUsRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztRQUM1QixNQUFNLEVBQUUsRUFBRTtRQUNWLFNBQVMsRUFBRTtZQUNULE9BQU8sRUFBRSxNQUFNO1NBQ2hCO1FBQ0QsdUJBQXVCLEVBQUU7WUFDdkIsU0FBUyxFQUFFLEtBQUssQ0FBQyxVQUFVLENBQUMsWUFBWTtTQUN6QztLQUNGO0lBQ0QsS0FBSyxFQUFFO1FBQ0wsYUFBYSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FB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LFVBQUMsU0FBUzt3QkFDVCxPQUFBLEtBQUssQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsU0FBUyxDQUFDO29CQUF4RCxDQUF3RCxDQUUzQyxDQUNsQixFQWRzQixDQWN0QixDQUFDLENBQ08sQ0FDTSxDQUNwQixDQUNKLENBQUM7QUFDSixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb25kaXRpb25hbFdyYXBwZXIgfSBmcm9tICcuLi9fcHJpdmF0ZS9Db25kaXRpb25hbFdyYXBwZXInO1xuaW1wb3J0IHsgR2V0Q2xhc3NlcyB9IGZyb20gJy4uLy4uL3R5cGVVdGlscyc7XG5pbXBvcnQgeyBtYWtlU3R5bGVzIH0gZnJvbSAnLi4vLi4vc3R5bGVzJztcbmltcG9ydCB7IE1lbnVJdGVtUHJvcHMgfSBmcm9tICcuL01lbnVJdGVtJztcbmltcG9ydCB7IG1vdGlvbiwgdXNlUmVkdWNlZE1vdGlvbiB9IGZyb20gJ2ZyYW1lci1tb3Rpb24nO1xuaW1wb3J0IHsgUG9ydGFsIH0gZnJvbSAncmVha2l0L1BvcnRhbCc7XG5pbXBvcnQgeyBUZXh0IH0gZnJvbSAnLi4vVGV4dCc7XG5pbXBvcnQge1xuICBNZW51IGFzIFJlYWtpdE1lbnUsXG4gIE1lbnVCdXR0b24sXG4gIE1lbnVJdGVtIGFzIFJlYWtpdE1lbnVJdGVtLFxuICBNZW51SW5pdGlhbFN0YXRlLFxuICB1c2VNZW51U3RhdGUsXG59IGZyb20gJ3JlYWtpdC9NZW51JztcbmltcG9ydCBjbHN4IGZyb20gJ2Nsc3gnO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0ICdmb2N1cy12aXNpYmxlJztcblxuZXhwb3J0IGNvbnN0IE1lbnVTdHlsZXNLZXkgPSAnQ2hyb21hTWVudSc7XG5cbmV4cG9ydCBjb25zdCB1c2VTdHlsZXMgPSBtYWtlU3R5bGVzKFxuICAodGhlbWUpID0+ICh7XG4gICAgcm9vdDoge1xuICAgICAgYmFja2dyb3VuZENvbG9yOiB0aGVtZS5wYWxldHRlLmNvbW1vbi53aGl0ZSxcbiAgICAgIGJvcmRlclJhZGl1czogdGhlbWUucHhUb1JlbSgxMCksXG4gICAgICBib3hTaGFkb3c6IHRoZW1lLmJveFNoYWRvd3MucG9wb3ZlcixcbiAgICAgIG1heEhlaWdodDogdGhlbWUucHhUb1JlbSg0MzIpLFxuICAgICAgbWluV2lkdGg6IHRoZW1lLnB4VG9SZW0oMjI0KSxcbiAgICAgIG92ZXJmbG93WTogJ2F1dG8nLFxuICAgICAgcGFkZGluZ0JvdHRvbTogdGhlbWUuc3BhY2luZygyKSxcbiAgICAgIHBhZGRpbmdUb3A6IHRoZW1lLnNwYWNpbmcoMiksXG4gICAgICB6SW5kZXg6IDQwLFxuICAgICAgJyY6Zm9jdXMnOiB7XG4gICAgICAgIG91dGxpbmU6ICdub25lJyxcbiAgICAgIH0sXG4gICAgICAnJjpmb2N1cy5mb2N1cy12aXNpYmxlJzoge1xuICAgICAgICBib3hTaGFkb3c6IHRoZW1lLmJveFNoYWRvd3MuZm9jdXNWaXNpYmxlLFxuICAgICAgfSxcbiAgICB9LFxuICAgIHRpdGxlOiB7XG4gICAgICBwYWRkaW5nQm90dG9tOiB0aGVtZS5zcGFjaW5nKDIpLFxuICAgICAgcGFkZGluZ0xlZnQ6IHRoZW1lLnNwYWNpbmcoMi41KSxcbiAgICAgIHBhZGRpbmdSaWdodDogdGhlbWUuc3BhY2luZygyLjUpLFxuICAgIH0sXG4gIH0pLFxuICB7IG5hbWU6IE1lbnVTdHlsZXNLZXkgfVxuKTtcblxuZXhwb3J0IHR5cGUgTWVudUNsYXNzZXMgPSBHZXRDbGFzc2VzPHR5cGVvZiB1c2VTdHlsZXM+O1xuXG5leHBvcnQgaW50ZXJmYWNlIE1lbnVQcm9wc1xuICBleHRlbmRzIFBpY2s8TWVudUluaXRpYWxTdGF0ZSwgJ3BsYWNlbWVudCcgfCAnZ3V0dGVyJz4ge1xuICBbJ2FyaWEtbGFiZWwnXTogc3RyaW5nO1xuICBhbmNob3JFbGVtZW50PzogYW55O1xuICBjaGlsZHJlbj86IFJlYWN0LlJlYWN0Tm9kZTtcbiAgY2xhc3NOYW1lPzogc3RyaW5nO1xuICBpdGVtcz86IEFycmF5PFJlYWN0LlJlYWN0RWxlbWVudDxNZW51SXRlbVByb3BzPj47XG4gIHRpdGxlPzogc3RyaW5nO1xuICB1c2VQb3J0YWw/OiBib29sZWFuO1xufVxuXG5leHBvcnQgY29uc3QgTWVudTogUmVhY3QuRkM8TWVudVByb3BzPiA9ICh7XG4gICdhcmlhLWxhYmVsJzogYXJpYUxhYmVsLFxuICBhbmNob3JFbGVtZW50LFxuICBjaGlsZHJlbixcbiAgY2xhc3NOYW1lLFxuICBndXR0ZXIsXG4gIGl0ZW1zLFxuICBwbGFjZW1lbnQgPSAnYm90dG9tJyxcbiAgdGl0bGUsXG4gIHVzZVBvcnRhbCA9IGZhbHNlLFxuICAuLi5yb290UHJvcHNcbn0pID0+IHtcbiAgY29uc3QgY2xhc3NlcyA9IHVzZVN0eWxlcyh7fSk7XG5cbiAgY29uc3Qgc2hvdWxkUmVkdWNlTW90aW9uID0gdXNlUmVkdWNlZE1vdGlvbigpO1xuXG4gIGNvbnN0IG1lbnUgPSB1c2VNZW51U3RhdGUoeyBwbGFjZW1lbnQsIGd1dHRlciB9KTtcblxuICBjb25zdCBoYW5kbGVTdG9wUHJvcGFnYXRpb24gPSAoZTogUmVhY3QuU3ludGhldGljRXZlbnQpID0+XG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuICByZXR1cm4gKFxuICAgIDw+XG4gICAgICA8TWVudUJ1dHRvblxuICAgICAgICB7Li4ubWVudX1cbiAgICAgICAgey4uLmFuY2hvckVsZW1lbnQucHJvcHN9XG4gICAgICAgIG9uQ2xpY2s9e2hhbmRsZVN0b3BQcm9wYWdhdGlvbn1cbiAgICAgID5cbiAgICAgICAgeyhkaXNjbG9zdXJlUHJvcHMpID0+XG4gICAgICAgICAgUmVhY3QuY2xvbmVFbGVtZW50KFxuICAgICAgICAgICAgUmVhY3QuQ2hpbGRyZW4ub25seShhbmNob3JFbGVtZW50KSxcbiAgICAgICAgICAgIGRpc2Nsb3N1cmVQcm9wc1xuICAgICAgICAgIClcbiAgICAgICAgfVxuICAgICAgPC9NZW51QnV0dG9uPlxuICAgICAgPENvbmRpdGlvbmFsV3JhcHBlclxuICAgICAgICBjb25kaXRpb249e3VzZVBvcnRhbH1cbiAgICAgICAgd3JhcHBlcj17KGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGUpID0+IDxQb3J0YWw+e2NoaWxkcmVufTwvUG9ydGFsPn1cbiAgICAgID5cbiAgICAgICAgPFJlYWtpdE1lbnVcbiAgICAgICAgICB7Li4ubWVudX1cbiAgICAgICAgICBhcz17bW90aW9uLmRpdn1cbiAgICAgICAgICBhcmlhLWxhYmVsPXthcmlhTGFiZWx9XG4gICAgICAgICAgY2xhc3NOYW1lPXtjbHN4KGNsYXNzZXMucm9vdCwgY2xhc3NOYW1lKX1cbiAgICAgICAgICBhbmltYXRlPXtcbiAgICAgICAgICAgIG1lbnUudmlzaWJsZVxuICAgICAgICAgICAgICA/IHNob3VsZFJlZHVjZU1vdGlvblxuICAgICAgICAgICAgICAgID8geyBvcGFjaXR5OiAxIH1cbiAgICAgICAgICAgICAgICA6IHtcbiAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvbjogeyBkdXJhdGlvbjogMC4zIH0sXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIDogc2hvdWxkUmVkdWNlTW90aW9uXG4gICAgICAgICAgICAgID8geyBvcGFjaXR5OiAwIH1cbiAgICAgICAgICAgICAgOiB7XG4gICAgICAgICAgICAgICAgICBvcGFjaXR5OiAwLFxuICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvbjogeyBkdXJhdGlvbjogMC4xIH0sXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICB7Li4ucm9vdFByb3BzfVxuICAgICAgICA+XG4gICAgICAgICAgeyEhdGl0bGUgJiYgKFxuICAgICAgICAgICAgPFRleHQgY2xhc3NOYW1lPXtjbGFzc2VzLnRpdGxlfSB3ZWlnaHQ9XCJib2xkXCIgc2l6ZT1cInN1YmJvZHlcIj5cbiAgICAgICAgICAgICAge3RpdGxlfVxuICAgICAgICAgICAgPC9UZXh0PlxuICAgICAgICAgICl9XG4gICAgICAgICAge2l0ZW1zICYmXG4gICAgICAgICAgICBpdGVtcy5tYXAoKGl0ZW0sIGkpID0+IChcbiAgICAgICAgICAgICAgPFJlYWtpdE1lbnVJdGVtXG4gICAgICAgICAgICAgICAgey4uLm1lbnV9XG4gICAgICAgICAgICAgICAgey4uLml0ZW0ucHJvcHN9XG4gICAgICAgICAgICAgICAga2V5PXtpfVxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9eyhlOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICAgIG1lbnUuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgaXRlbS5wcm9wcy5vbkNsaWNrICYmIGl0ZW0ucHJvcHMub25DbGljayhlKTtcbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgeyhpdGVtUHJvcHMpID0+XG4gICAgICAgICAgICAgICAgICBSZWFjdC5jbG9uZUVsZW1lbnQoUmVhY3QuQ2hpbGRyZW4ub25seShpdGVtKSwgaXRlbVByb3BzKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgPC9SZWFraXRNZW51SXRlbT5cbiAgICAgICAgICAgICkpfVxuICAgICAgICA8L1JlYWtpdE1lbnU+XG4gICAgICA8L0NvbmRpdGlvbmFsV3JhcHBlcj5cbiAgICA8Lz5cbiAgKTtcbn07XG4iXX0=