"use strict";
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result["default"] = mod;
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
var clsx_1 = __importDefault(require("clsx"));
var React = __importStar(require("react"));
var styles_1 = require("../../styles");
var forms_1 = require("../_private/forms");
var UniqueId_1 = require("../_private/UniqueId");
var Text_1 = require("../Text");
var screenreaderOnly_1 = require("../../styles/screenreaderOnly");
exports.ToggleStylesKey = 'ChromaToggle';
exports.useStyles = styles_1.makeStyles(function (theme) { return ({
    root: {
        display: 'flex',
        // Setup default ball styles
        '& > input[type="checkbox"]::after': {
            background: theme.palette.common.white,
            transform: 'translateX(0px)',
            transition: 'transform .3s cubic-bezier(.2, .85, .32, 1.2), opacity .2s',
        },
        // Target the ball to move *and* change color to white
        '& > input[type="checkbox"]:checked::after': {
            background: theme.palette.common.white,
            transform: 'translateX(17px)',
        },
        // Targets the ball when the input is disabled and not checked
        '& > input[type="checkbox"]:disabled:not(:checked)::after': {
            opacity: 0.6,
        },
    },
    input: {
        background: 'rgba(132, 137, 166, 0.15)',
        border: '1px solid transparent',
        borderRadius: theme.pxToRem(11),
        cursor: 'pointer',
        display: 'inline-block',
        height: theme.pxToRem(21),
        margin: 0,
        MozAppearance: 'none',
        outline: 'none',
        position: 'relative',
        transition: 'background .3s, border-color .3s, box-shadow .2s',
        verticalAlign: 'top',
        WebkitAppearance: 'none',
        minWidth: theme.pxToRem(38),
        '&:after': {
            background: theme.palette.common.white,
            borderRadius: '50%',
            content: '" "',
            display: 'block',
            height: theme.pxToRem(15),
            left: theme.pxToRem(2),
            position: 'absolute',
            top: theme.pxToRem(2),
            width: theme.pxToRem(15),
        },
        '&:checked': {
            background: theme.palette.primary.main,
            border: "1px solid " + theme.palette.primary.main,
        },
        '&:disabled': {
            cursor: 'not-allowed',
            opacity: 0.625,
            // Ensure the label sibling cannot be clicked as well
            '& + label': {
                cursor: 'not-allowed',
            },
        },
        '&:focus': {
            boxShadow: '0 0 0 2px rgba(0, 150, 225, .3)',
        },
        '&:hover:not(:disabled):not(:checked)': {
            border: "1px solid " + theme.palette.primary[700],
        },
    },
    inputInverse: {
        backgroundColor: 'rgba(230, 231, 237, 0.1)',
        border: '1px solid rgba(255, 255, 255, 0.2)',
        mixBlendMode: 'hard-light',
        '&:checked': {
            background: theme.palette.secondary[500],
            border: "1px solid " + theme.palette.secondary[500],
        },
        '&:focus': {
            boxShadow: '0 0 0 2px rgba(255, 255, 255, .3)',
        },
        '&:hover:not(:disabled):not(:checked)': {
            border: "1px solid " + theme.palette.common.white,
        },
    },
    labelContainer: {
        flex: '0 auto',
        marginLeft: theme.spacing(1),
    },
    label: {
        cursor: 'pointer',
        display: 'inline-block',
        marginBottom: 0,
        marginTop: theme.spacing(0.25),
        verticalAlign: 'top',
        '& p': {
            lineHeight: 1.25,
        },
    },
    labelInverse: {
        color: theme.palette.common.white,
    },
    message: {},
    error: {
        border: "1px solid " + theme.palette.red.main,
    },
    rootRight: {
        flexFlow: 'row-reverse',
        justifyContent: 'flex-end',
    },
    labelContainerRight: {
        marginRight: theme.spacing(1),
        marginLeft: 0,
    },
    labelContainerFullWidth: {
        flex: 1,
    },
    labelFullWidth: {
        display: 'flex',
    },
    srOnly: __assign({}, screenreaderOnly_1.screenreaderOnlyStyles),
}); }, { name: exports.ToggleStylesKey });
exports.Toggle = React.forwardRef(function (_a, ref) {
    var _b, _c, _d;
    var ariaLabel = _a["aria-label"], checked = _a.checked, className = _a.className, _e = _a.color, color = _e === void 0 ? 'default' : _e, fullWidth = _a.fullWidth, errorMessage = _a.errorMessage, hasError = _a.hasError, helpMessage = _a.helpMessage, id = _a.id, label = _a.label, name = _a.name, _f = _a.placement, placement = _f === void 0 ? 'left' : _f, rootProps = __rest(_a, ['aria-label', "checked", "className", "color", "fullWidth", "errorMessage", "hasError", "helpMessage", "id", "label", "name", "placement"]);
    var classes = exports.useStyles({});
    var uniqueId = React.useState(function () { return id || name || UniqueId_1.generateUniqueId('toggle-'); })[0];
    if (!label && !ariaLabel && process.env.NODE_ENV === 'development') {
        throw new Error('If a "label" is not provided to Toggle, please provide "aria-label".');
    }
    return (React.createElement("div", { className: clsx_1.default(classes.root, (_b = {}, _b[classes.rootRight] = placement === 'right', _b), className) },
        React.createElement("input", __assign({ "aria-describedby": forms_1.buildDescribedBy({
                hasError: hasError,
                hasHelpMessage: !!helpMessage,
                uniqueId: uniqueId,
            }), className: clsx_1.default(classes.input, hasError && classes.error, (_c = {},
                _c[classes.inputInverse] = color === 'inverse',
                _c)), ref: ref, type: "checkbox", id: uniqueId, checked: checked, tabIndex: 0 }, rootProps)),
        React.createElement("div", { className: clsx_1.default(classes.labelContainer, fullWidth && classes.labelContainerFullWidth, (_d = {},
                _d[classes.labelContainerRight] = placement === 'right',
                _d), !label && ariaLabel && classes.srOnly) },
            React.createElement("label", { className: clsx_1.default(classes.label, fullWidth && classes.labelFullWidth), htmlFor: uniqueId },
                React.createElement(Text_1.Text, { className: color === 'inverse' ? classes.labelInverse : undefined, size: "subbody" }, label || ariaLabel)),
            helpMessage && (React.createElement(forms_1.FormHelpMessage, { className: classes.message, color: color, rootElementId: uniqueId, describedById: forms_1.helpFor(uniqueId) }, helpMessage)),
            hasError && (React.createElement(forms_1.FormErrorMessage, { className: classes.message, color: color, rootElementId: uniqueId, describedById: forms_1.errorFor(uniqueId) }, errorMessage)))));
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVG9nZ2xlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvVG9nZ2xlL1RvZ2dsZS50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDhDQUF3QjtBQUN4QiwyQ0FBK0I7QUFDL0IsdUNBQTBDO0FBRTFDLDJDQU8yQjtBQUMzQixpREFBd0Q7QUFDeEQsZ0NBQStCO0FBQy9CLGtFQUF1RTtBQUUxRCxRQUFBLGVBQWUsR0FBRyxjQUFjLENBQUM7QUFFakMsUUFBQSxTQUFTLEdBQUcsbUJBQVUsQ0FDakMsVUFBQyxLQUFLLElBQUssT0FBQSxDQUFDO0lBQ1YsSUFBSSxFQUFFO1FBQ0osT0FBTyxFQUFFLE1BQU07UUFDZiw0QkFBNEI7UUFDNUIsbUNBQW1DLEVBQUU7WUFDbkMsVUFBVSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUs7WUFDdEMsU0FBUyxFQUFFLGlCQUFpQjtZQUM1QixVQUFVLEVBQ1IsNERBQTREO1NBQy9EO1FBQ0Qsc0RBQXNEO1FBQ3RELDJDQUEyQyxFQUFFO1lBQzNDLFVBQVUsRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxLQUFLO1lBQ3RDLFNBQVMsRUFBRSxrQkFBa0I7U0FDOUI7UUFDRCw4REFBOEQ7UUFDOUQsMERBQTBELEVBQUU7WUFDMUQsT0FBTyxFQUFFLEdBQUc7U0FDYjtLQUNGO0lBQ0QsS0FBSyxFQUFFO1FBQ0wsVUFBVSxFQUFFLDJCQUEyQjtRQUN2QyxNQUFNLEVBQUUsdUJBQXVCO1FBQy9CLFlBQVksRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQztRQUMvQixNQUFNLEVBQUUsU0FBUztRQUNqQixPQUFPLEVBQUUsY0FBYztRQUN2QixNQUFNLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUM7UUFDekIsTUFBTSxFQUFFLENBQUM7UUFDVCxh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QUUsZ0JBQVEsQ0FBQyxRQUFRLENBQUMsSUFFaEMsWUFBWSxDQUNJLENBQ3BCLENBQ0csQ0FDRixDQUNQLENBQUM7QUFDSixDQUFDLENBQ0YsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjbHN4IGZyb20gJ2Nsc3gnO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgbWFrZVN0eWxlcyB9IGZyb20gJy4uLy4uL3N0eWxlcyc7XG5pbXBvcnQgeyBHZXRDbGFzc2VzIH0gZnJvbSAnLi4vLi4vdHlwZVV0aWxzJztcbmltcG9ydCB7XG4gIEJhc2VGb3JtRWxlbWVudCxcbiAgYnVpbGREZXNjcmliZWRCeSxcbiAgZXJyb3JGb3IsXG4gIEZvcm1FcnJvck1lc3NhZ2UsXG4gIEZvcm1IZWxwTWVzc2FnZSxcbiAgaGVscEZvcixcbn0gZnJvbSAnLi4vX3ByaXZhdGUvZm9ybXMnO1xuaW1wb3J0IHsgZ2VuZXJhdGVVbmlxdWVJZCB9IGZyb20gJy4uL19wcml2YXRlL1VuaXF1ZUlkJztcbmltcG9ydCB7IFRleHQgfSBmcm9tICcuLi9UZXh0JztcbmltcG9ydCB7IHNjcmVlbnJlYWRlck9ubHlTdHlsZXMgfSBmcm9tICcuLi8uLi9zdHlsZXMvc2NyZWVucmVhZGVyT25seSc7XG5cbmV4cG9ydCBjb25zdCBUb2dnbGVTdHlsZXNLZXkgPSAnQ2hyb21hVG9nZ2xlJztcblxuZXhwb3J0IGNvbnN0IHVzZVN0eWxlcyA9IG1ha2VTdHlsZXMoXG4gICh0aGVtZSkgPT4gKHtcbiAgICByb290OiB7XG4gICAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgICAvLyBTZXR1cCBkZWZhdWx0IGJhbGwgc3R5bGVzXG4gICAgICAnJiA+IGlucHV0W3R5cGU9XCJjaGVja2JveFwiXTo6YWZ0ZXInOiB7XG4gICAgICAgIGJhY2tncm91bmQ6IHRoZW1lLnBhbGV0dGUuY29tbW9uLndoaXRlLFxuICAgICAgICB0cmFuc2Zvcm06ICd0cmFuc2xhdGVYKDBweCknLFxuICAgICAgICB0cmFuc2l0aW9uOlxuICAgICAgICAgICd0cmFuc2Zvcm0gLjNzIGN1YmljLWJlemllciguMiwgLjg1LCAuMzIsIDEuMiksIG9wYWNpdHkgLjJzJyxcbiAgICAgIH0sXG4gICAgICAvLyBUYXJnZXQgdGhlIGJhbGwgdG8gbW92ZSAqYW5kKiBjaGFuZ2UgY29sb3IgdG8gd2hpdGVcbiAgICAgICcmID4gaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdOmNoZWNrZWQ6OmFmdGVyJzoge1xuICAgICAgICBiYWNrZ3JvdW5kOiB0aGVtZS5wYWxldHRlLmNvbW1vbi53aGl0ZSxcbiAgICAgICAgdHJhbnNmb3JtOiAndHJhbnNsYXRlWCgxN3B4KScsXG4gICAgICB9LFxuICAgICAgLy8gVGFyZ2V0cyB0aGUgYmFsbCB3aGVuIHRoZSBpbnB1dCBpcyBkaXNhYmxlZCBhbmQgbm90IGNoZWNrZWRcbiAgICAgICcmID4gaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdOmRpc2FibGVkOm5vdCg6Y2hlY2tlZCk6OmFmdGVyJzoge1xuICAgICAgICBvcGFjaXR5OiAwLjYsXG4gICAgICB9LFxuICAgIH0sXG4gICAgaW5wdXQ6IHtcbiAgICAgIGJhY2tncm91bmQ6ICdyZ2JhKDEzMiwgMTM3LCAxNjYsIDAuMTUpJyxcbiAgICAgIGJvcmRlcjogJzFweCBzb2xpZCB0cmFuc3BhcmVudCcsXG4gICAgICBib3JkZXJSYWRpdXM6IHRoZW1lLnB4VG9SZW0oMTEpLFxuICAgICAgY3Vyc29yOiAncG9pbnRlcicsXG4gICAgICBkaXNwbGF5OiAnaW5saW5lLWJsb2NrJyxcbiAgICAgIGhlaWdodDogdGhlbWUucHhUb1JlbSgyMSksXG4gICAgICBtYXJnaW46IDAsXG4gICAgICBNb3pBcHBlYXJhbmNlOiAnbm9uZScsXG4gICAgICBvdXRsaW5lOiAnbm9uZScsXG4gICAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJyxcbiAgICAgIHRyYW5zaXRpb246ICdiYWNrZ3JvdW5kIC4zcywgYm9yZGVyLWNvbG9yIC4zcywgYm94LXNoYWRvdyAuMnMnLFxuICAgICAgdmVydGljYWxBbGlnbjogJ3RvcCcsXG4gICAgICBXZWJraXRBcHBlYXJhbmNlOiAnbm9uZScsXG4gICAgICBtaW5XaWR0aDogdGhlbWUucHhUb1JlbSgzOCksXG4gICAgICAnJjphZnRlcic6IHtcbiAgICAgICAgYmFja2dyb3VuZDogdGhlbWUucGFsZXR0ZS5jb21tb24ud2hpdGUsXG4gICAgICAgIGJvcmRlclJhZGl1czogJzUwJScsXG4gICAgICAgIGNvbnRlbnQ6ICdcIiBcIicsXG4gICAgICAgIGRpc3BsYXk6ICdibG9jaycsXG4gICAgICAgIGhlaWdodDogdGhlbWUucHhUb1JlbSgxNSksXG4gICAgICAgIGxlZnQ6IHRoZW1lLnB4VG9SZW0oMiksXG4gICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgICB0b3A6IHRoZW1lLnB4VG9SZW0oMiksXG4gICAgICAgIHdpZHRoOiB0aGVtZS5weFRvUmVtKDE1KSxcbiAgICAgIH0sXG4gICAgICAnJjpjaGVja2VkJzoge1xuICAgICAgICBiYWNrZ3JvdW5kOiB0aGVtZS5wYWxldHRlLnByaW1hcnkubWFpbixcbiAgICAgICAgYm9yZGVyOiBgMXB4IHNvbGlkICR7dGhlbWUucGFsZXR0ZS5wcmltYXJ5Lm1haW59YCxcbiAgICAgIH0sXG4gICAgICAnJjpkaXNhYmxlZCc6IHtcbiAgICAgICAgY3Vyc29yOiAnbm90LWFsbG93ZWQnLFxuICAgICAgICBvcGFjaXR5OiAwLjYyNSxcbiAgICAgICAgLy8gRW5zdXJlIHRoZSBsYWJlbCBzaWJsaW5nIGNhbm5vdCBiZSBjbGlja2VkIGFzIHdlbGxcbiAgICAgICAgJyYgKyBsYWJlbCc6IHtcbiAgICAgICAgICBjdXJzb3I6ICdub3QtYWxsb3dlZCcsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgJyY6Zm9jdXMnOiB7XG4gICAgICAgIGJveFNoYWRvdzogJzAgMCAwIDJweCByZ2JhKDAsIDE1MCwgMjI1LCAuMyknLFxuICAgICAgfSxcbiAgICAgICcmOmhvdmVyOm5vdCg6ZGlzYWJsZWQpOm5vdCg6Y2hlY2tlZCknOiB7XG4gICAgICAgIGJvcmRlcjogYDFweCBzb2xpZCAke3RoZW1lLnBhbGV0dGUucHJpbWFyeVs3MDBdfWAsXG4gICAgICB9LFxuICAgIH0sXG4gICAgaW5wdXRJbnZlcnNlOiB7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6ICdyZ2JhKDIzMCwgMjMxLCAyMzcsIDAuMSknLFxuICAgICAgYm9yZGVyOiAnMXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKScsXG4gICAgICBtaXhCbGVuZE1vZGU6ICdoYXJkLWxpZ2h0JyxcbiAgICAgICcmOmNoZWNrZWQnOiB7XG4gICAgICAgIGJhY2tncm91bmQ6IHRoZW1lLnBhbGV0dGUuc2Vjb25kYXJ5WzUwMF0sXG4gICAgICAgIGJvcmRlcjogYDFweCBzb2xpZCAke3RoZW1lLnBhbGV0dGUuc2Vjb25kYXJ5WzUwMF19YCxcbiAgICAgIH0sXG4gICAgICAnJjpmb2N1cyc6IHtcbiAgICAgICAgYm94U2hhZG93OiAnMCAwIDAgMnB4IHJnYmEoMjU1LCAyNTUsIDI1NSwgLjMpJyxcbiAgICAgIH0sXG4gICAgICAnJjpob3Zlcjpub3QoOmRpc2FibGVkKTpub3QoOmNoZWNrZWQpJzoge1xuICAgICAgICBib3JkZXI6IGAxcHggc29saWQgJHt0aGVtZS5wYWxldHRlLmNvbW1vbi53aGl0ZX1gLFxuICAgICAgfSxcbiAgICB9LFxuICAgIGxhYmVsQ29udGFpbmVyOiB7XG4gICAgICBmbGV4OiAnMCBhdXRvJyxcbiAgICAgIG1hcmdpbkxlZnQ6IHRoZW1lLnNwYWNpbmcoMSksXG4gICAgfSxcbiAgICBsYWJlbDoge1xuICAgICAgY3Vyc29yOiAncG9pbnRlcicsXG4gICAgICBkaXNwbGF5OiAnaW5saW5lLWJsb2NrJyxcbiAgICAgIG1hcmdpbkJvdHRvbTogMCxcbiAgICAgIG1hcmdpblRvcDogdGhlbWUuc3BhY2luZygwLjI1KSxcbiAgICAgIHZlcnRpY2FsQWxpZ246ICd0b3AnLFxuICAgICAgJyYgcCc6IHtcbiAgICAgICAgbGluZUhlaWdodDogMS4yNSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBsYWJlbEludmVyc2U6IHtcbiAgICAgIGNvbG9yOiB0aGVtZS5wYWxldHRlLmNvbW1vbi53aGl0ZSxcbiAgICB9LFxuICAgIG1lc3NhZ2U6IHt9LFxuICAgIGVycm9yOiB7XG4gICAgICBib3JkZXI6IGAxcHggc29saWQgJHt0aGVtZS5wYWxldHRlLnJlZC5tYWlufWAsXG4gICAgfSxcbiAgICByb290UmlnaHQ6IHtcbiAgICAgIGZsZXhGbG93OiAncm93LXJldmVyc2UnLFxuICAgICAganVzdGlmeUNvbnRlbnQ6ICdmbGV4LWVuZCcsXG4gICAgfSxcbiAgICBsYWJlbENvbnRhaW5lclJpZ2h0OiB7XG4gICAgICBtYXJnaW5SaWdodDogdGhlbWUuc3BhY2luZygxKSxcbiAgICAgIG1hcmdpbkxlZnQ6IDAsXG4gICAgfSxcbiAgICBsYWJlbENvbnRhaW5lckZ1bGxXaWR0aDoge1xuICAgICAgZmxleDogMSxcbiAgICB9LFxuICAgIGxhYmVsRnVsbFdpZHRoOiB7XG4gICAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgfSxcbiAgICBzck9ubHk6IHtcbiAgICAgIC4uLnNjcmVlbnJlYWRlck9ubHlTdHlsZXMsXG4gICAgfSxcbiAgfSksXG4gIHsgbmFtZTogVG9nZ2xlU3R5bGVzS2V5IH1cbik7XG5cbmV4cG9ydCB0eXBlIFRvZ2dsZUNsYXNzZXMgPSBHZXRDbGFzc2VzPHR5cGVvZiB1c2VTdHlsZXM+O1xuXG5leHBvcnQgaW50ZXJmYWNlIFRvZ2dsZVByb3BzIGV4dGVuZHMgQmFzZUZvcm1FbGVtZW50IHtcbiAgZnVsbFdpZHRoPzogYm9vbGVhbjtcbiAgcGxhY2VtZW50PzogJ2xlZnQnIHwgJ3JpZ2h0Jztcbn1cblxuZXhwb3J0IGNvbnN0IFRvZ2dsZSA9IFJlYWN0LmZvcndhcmRSZWY8SFRNTElucHV0RWxlbWVudCwgVG9nZ2xlUHJvcHM+KFxuICAoXG4gICAge1xuICAgICAgWydhcmlhLWxhYmVsJ106IGFyaWFMYWJlbCxcbiAgICAgIGNoZWNrZWQsXG4gICAgICBjbGFzc05hbWUsXG4gICAgICBjb2xvciA9ICdkZWZhdWx0JyxcbiAgICAgIGZ1bGxXaWR0aCxcbiAgICAgIGVycm9yTWVzc2FnZSxcbiAgICAgIGhhc0Vycm9yLFxuICAgICAgaGVscE1lc3NhZ2UsXG4gICAgICBpZCxcbiAgICAgIGxhYmVsLFxuICAgICAgbmFtZSxcbiAgICAgIHBsYWNlbWVudCA9ICdsZWZ0JyxcbiAgICAgIC4uLnJvb3RQcm9wc1xuICAgIH0sXG4gICAgcmVmXG4gICkgPT4ge1xuICAgIGNvbnN0IGNsYXNzZXMgPSB1c2VTdHlsZXMoe30pO1xuXG4gICAgY29uc3QgW3VuaXF1ZUlkXSA9IFJlYWN0LnVzZVN0YXRlPHN0cmluZz4oXG4gICAgICAoKSA9PiBpZCB8fCBuYW1lIHx8IGdlbmVyYXRlVW5pcXVlSWQoJ3RvZ2dsZS0nKVxuICAgICk7XG5cbiAgICBpZiAoIWxhYmVsICYmICFhcmlhTGFiZWwgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgJ0lmIGEgXCJsYWJlbFwiIGlzIG5vdCBwcm92aWRlZCB0byBUb2dnbGUsIHBsZWFzZSBwcm92aWRlIFwiYXJpYS1sYWJlbFwiLidcbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXZcbiAgICAgICAgY2xhc3NOYW1lPXtjbHN4KFxuICAgICAgICAgIGNsYXNzZXMucm9vdCxcbiAgICAgICAgICB7IFtjbGFzc2VzLnJvb3RSaWdodF06IHBsYWNlbWVudCA9PT0gJ3JpZ2h0JyB9LFxuICAgICAgICAgIGNsYXNzTmFtZVxuICAgICAgICApfVxuICAgICAgPlxuICAgICAgICA8aW5wdXRcbiAgICAgICAgICBhcmlhLWRlc2NyaWJlZGJ5PXtidWlsZERlc2NyaWJlZEJ5KHtcbiAgICAgICAgICAgIGhhc0Vycm9yLFxuICAgICAgICAgICAgaGFzSGVscE1lc3NhZ2U6ICEhaGVscE1lc3NhZ2UsXG4gICAgICAgICAgICB1bmlxdWVJZCxcbiAgICAgICAgICB9KX1cbiAgICAgICAgICBjbGFzc05hbWU9e2Nsc3goY2xhc3Nlcy5pbnB1dCwgaGFzRXJyb3IgJiYgY2xhc3Nlcy5lcnJvciwge1xuICAgICAgICAgICAgW2NsYXNzZXMuaW5wdXRJbnZlcnNlXTogY29sb3IgPT09ICdpbnZlcnNlJyxcbiAgICAgICAgICB9KX1cbiAgICAgICAgICByZWY9e3JlZn1cbiAgICAgICAgICB0eXBlPVwiY2hlY2tib3hcIlxuICAgICAgICAgIGlkPXt1bmlxdWVJZH1cbiAgICAgICAgICBjaGVja2VkPXtjaGVja2VkfVxuICAgICAgICAgIHRhYkluZGV4PXswfVxuICAgICAgICAgIHsuLi5yb290UHJvcHN9XG4gICAgICAgIC8+XG4gICAgICAgIDxkaXZcbiAgICAgICAgICBjbGFzc05hbWU9e2Nsc3goXG4gICAgICAgICAgICBjbGFzc2VzLmxhYmVsQ29udGFpbmVyLFxuICAgICAgICAgICAgZnVsbFdpZHRoICYmIGNsYXNzZXMubGFiZWxDb250YWluZXJGdWxsV2lkdGgsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIFtjbGFzc2VzLmxhYmVsQ29udGFpbmVyUmlnaHRdOiBwbGFjZW1lbnQgPT09ICdyaWdodCcsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgIWxhYmVsICYmIGFyaWFMYWJlbCAmJiBjbGFzc2VzLnNyT25seVxuICAgICAgICAgICl9XG4gICAgICAgID5cbiAgICAgICAgICA8bGFiZWxcbiAgICAgICAgICAgIGNsYXNzTmFtZT17Y2xzeChjbGFzc2VzLmxhYmVsLCBmdWxsV2lkdGggJiYgY2xhc3Nlcy5sYWJlbEZ1bGxXaWR0aCl9XG4gICAgICAgICAgICBodG1sRm9yPXt1bmlxdWVJZH1cbiAgICAgICAgICA+XG4gICAgICAgICAgICA8VGV4dFxuICAgICAgICAgICAgICBjbGFzc05hbWU9e2NvbG9yID09PSAnaW52ZXJzZScgPyBjbGFzc2VzLmxhYmVsSW52ZXJzZSA6IHVuZGVmaW5lZH1cbiAgICAgICAgICAgICAgc2l6ZT1cInN1YmJvZHlcIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7bGFiZWwgfHwgYXJpYUxhYmVsfVxuICAgICAgICAgICAgPC9UZXh0PlxuICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgICAge2hlbHBNZXNzYWdlICYmIChcbiAgICAgICAgICAgIDxGb3JtSGVscE1lc3NhZ2VcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbGFzc2VzLm1lc3NhZ2V9XG4gICAgICAgICAgICAgIGNvbG9yPXtjb2xvcn1cbiAgICAgICAgICAgICAgcm9vdEVsZW1lbnRJZD17dW5pcXVlSWR9XG4gICAgICAgICAgICAgIGRlc2NyaWJlZEJ5SWQ9e2hlbHBGb3IodW5pcXVlSWQpfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7aGVscE1lc3NhZ2V9XG4gICAgICAgICAgICA8L0Zvcm1IZWxwTWVzc2FnZT5cbiAgICAgICAgICApfVxuICAgICAgICAgIHtoYXNFcnJvciAmJiAoXG4gICAgICAgICAgICA8Rm9ybUVycm9yTWVzc2FnZVxuICAgICAgICAgICAgICBjbGFzc05hbWU9e2NsYXNzZXMubWVzc2FnZX1cbiAgICAgICAgICAgICAgY29sb3I9e2NvbG9yfVxuICAgICAgICAgICAgICByb290RWxlbWVudElkPXt1bmlxdWVJZH1cbiAgICAgICAgICAgICAgZGVzY3JpYmVkQnlJZD17ZXJyb3JGb3IodW5pcXVlSWQpfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7ZXJyb3JNZXNzYWdlfVxuICAgICAgICAgICAgPC9Gb3JtRXJyb3JNZXNzYWdlPlxuICAgICAgICAgICl9XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxuKTtcbiJdfQ==