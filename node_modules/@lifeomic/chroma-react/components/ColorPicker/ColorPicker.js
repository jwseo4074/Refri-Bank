"use strict";
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result["default"] = mod;
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
var clsx_1 = __importDefault(require("clsx"));
var React = __importStar(require("react"));
var forms_1 = require("../_private/forms");
var ButtonUnstyled_1 = require("../ButtonUnstyled");
var UniqueId_1 = require("../_private/UniqueId");
var styles_1 = require("../../styles");
var Popover_1 = require("../Popover");
var Tooltip_1 = require("../Tooltip");
var colorManipulator_1 = require("@material-ui/core/styles/colorManipulator");
require("focus-visible");
exports.ColorPickerStylesKey = 'ChromaColorPicker';
exports.useStyles = styles_1.makeStyles(function (theme) { return ({
    root: {},
    label: {
        alignItems: 'center',
        color: theme.palette.black[800],
        display: 'flex',
        fontSize: theme.pxToRem(14),
        fontWeight: theme.typography.fontWeightBold,
        marginBottom: theme.spacing(1),
        '&:empty': {
            marginBottom: theme.spacing(0),
        },
    },
    labelIcon: {
        marginLeft: theme.spacing(0.75),
        color: theme.palette.primary.main,
    },
    labelIconInverse: {
        mixBlendMode: 'screen',
    },
    labelSecondary: {
        color: theme.palette.text.hint,
        fontSize: theme.pxToRem(11),
        display: 'inline-block',
        margin: theme.spacing(0, 0.75),
    },
    labelInverse: {
        color: theme.palette.common.white,
        '&$labelSecondary': {
            opacity: 0.9,
        },
    },
    input: {
        backgroundColor: 'rgba(132, 137, 166, 0.15)',
        border: "1px solid transparent",
        borderRadius: theme.pxToRem(4),
        color: theme.palette.text.primary,
        fontFamily: theme.typography.fontFamily,
        fontSize: theme.pxToRem(14),
        minWidth: theme.pxToRem(175),
        lineHeight: 1.25,
        paddingBottom: theme.spacing(1),
        paddingLeft: theme.spacing(1.25),
        paddingRight: theme.spacing(1.25),
        paddingTop: theme.spacing(1),
        transition: 'border 0.25s ease',
        '&:focus': {
            outline: 'none',
            backgroundColor: 'rgba(255, 255, 255, 0.5)',
            border: "1px solid rgba(132, 137, 166, 0.45)",
        },
        '&:disabled': {
            cursor: 'not-allowed',
            opacity: 0.625,
        },
        '&:read-only': {
            cursor: 'not-allowed',
            opacity: 0.9,
            '&:focus': {
                backgroundColor: 'rgba(132, 137, 166, 0.15)',
                border: "1px solid transparent",
            },
        },
        '&::-webkit-input-placeholder': {
            color: theme.palette.black[400],
        },
        '&::-moz-placeholder': {
            color: theme.palette.black[400],
        },
        '&:-ms-input-placeholder': {
            color: theme.palette.black[400],
        },
        '&:-moz-placeholder': {
            color: theme.palette.black[400],
        },
    },
    inputInverse: {
        backgroundColor: 'rgba(230, 231, 237, 0.1)',
        color: theme.palette.common.white,
        '&:focus': {
            backgroundColor: 'rgba(230, 231, 237, 0.1)',
            border: "1px solid rgba(230, 231, 237, 0.55)",
        },
        '&:read-only': {
            opacity: 1,
            '&:focus': {
                backgroundColor: 'rgba(230, 231, 237, 0.1)',
            },
        },
        '&::-webkit-input-placeholder': {
            color: 'rgba(255, 255, 255, 0.8)',
        },
        '&::-moz-placeholder': {
            color: 'rgba(255, 255, 255, 0.8)',
        },
        '&:-ms-input-placeholder': {
            color: 'rgba(255, 255, 255, 0.8)',
        },
        '&:-moz-placeholder': {
            color: 'rgba(255, 255, 255, 0.8)',
        },
    },
    hasTrailer: {
        marginBottom: theme.spacing(0.5),
    },
    inputContainer: {
        position: 'relative',
        width: 'fit-content',
    },
    inputError: {
        backgroundColor: 'rgba(230, 231, 237, 0.1)',
        border: "1px solid " + theme.palette.error.main,
        '&:focus': {
            border: "1px solid " + theme.palette.error.main,
        },
    },
    inputErrorInverse: {
        border: "1px solid " + theme.palette.error[700],
    },
    inputFullWidth: {
        width: '100%',
    },
    trailerMessage: {
        marginTop: theme.spacing(0.875),
        marginLeft: 0,
    },
    errorMessage: {
        color: theme.palette.error.main,
        fontSize: theme.typography.caption.fontSize,
        fontWeight: theme.typography.fontWeightBold,
    },
    errorMessageInverse: {
        mixBlendMode: 'color-dodge',
    },
    helpMessage: {
        fontSize: theme.typography.caption.fontSize,
        color: theme.palette.text.hint,
    },
    helpMessageInverse: {
        color: theme.palette.common.white,
    },
    tooltipContainer: {
        display: 'flex',
        outline: 'none',
    },
    valueDisplay: {
        alignItems: 'center',
        display: 'flex',
        height: theme.pxToRem(50),
        justifyContent: 'center',
        position: 'relative',
        '&::after': {
            background: colorManipulator_1.fade(theme.palette.common.black, 0.25),
            bottom: 0,
            content: "''",
            height: theme.pxToRem(1),
            position: 'absolute',
            width: '100%',
        },
    },
    swatchButton: {
        height: theme.pxToRem(20),
        width: theme.pxToRem(20),
        position: 'absolute',
        right: theme.spacing(1),
        top: theme.spacing(1),
    },
    popover: {
        minWidth: 'unset',
    },
    popoverList: {
        display: 'grid',
        gridGap: theme.spacing(1.5),
        gridTemplateColumns: "repeat(6, " + theme.pxToRem(20) + ")",
        margin: theme.spacing(2),
        padding: 0,
        '& $color': {
            margin: 0,
        },
        '&:focus': {
            outline: 'none',
        },
        // We use this + a polyfill for older browser
        // to get accessible buttons for keyboard-users.
        // Users will not see these styles unless they use their keyboard
        // to focus the element
        '&:focus.focus-visible': {
            outline: "solid 2px " + theme.palette.primary.main,
            outlineOffset: theme.spacing(1),
        },
    },
    popoverItem: {
        padding: 0,
    },
    colorButton: {
        transition: 'transform 0.25s ease-in-out',
        transform: 'scale(1)',
        '&:hover,&:focus': {
            transform: 'scale(1.2)',
        },
    },
    color: {
        boxShadow: 'inset 0 0 3px rgb(38 44 50 / 20%)',
        display: 'block',
        height: theme.pxToRem(20),
        width: theme.pxToRem(20),
    },
    colorCircle: {
        borderRadius: theme.pxToRem(10),
    },
    colorSquare: {
        borderRadius: theme.pxToRem(4),
    },
}); }, { name: exports.ColorPickerStylesKey });
exports.isValidHexColor = function (color) {
    var hexRegex = new RegExp(/^#[0-9A-F]{6}$/i);
    var shortHandHexRegex = new RegExp(/^#([0-9A-F]{3}){1,2}$/i);
    return hexRegex.test(color) || shortHandHexRegex.test(color);
};
exports.ColorPicker = React.forwardRef(function (_a, ref) {
    var _b;
    var ariaLabel = _a["aria-label"], className = _a.className, _c = _a.color, color = _c === void 0 ? 'default' : _c, colorSuggestions = _a.colorSuggestions, disabled = _a.disabled, errorMessage = _a.errorMessage, fullWidth = _a.fullWidth, hasError = _a.hasError, helpMessage = _a.helpMessage, Icon = _a.icon, id = _a.id, _d = _a.invalidColorText, invalidColorText = _d === void 0 ? 'Invalid Color' : _d, label = _a.label, name = _a.name, onChange = _a.onChange, readOnly = _a.readOnly, secondaryLabel = _a.secondaryLabel, tooltipMessage = _a.tooltipMessage, _e = _a.value, value = _e === void 0 ? '' : _e, _f = _a.variant, variant = _f === void 0 ? 'square' : _f, rootProps = __rest(_a, ['aria-label', "className", "color", "colorSuggestions", "disabled", "errorMessage", "fullWidth", "hasError", "helpMessage", "icon", "id", "invalidColorText", "label", "name", "onChange", "readOnly", "secondaryLabel", "tooltipMessage", "value", "variant"]);
    var _g = React.useState(value), colorValue = _g[0], setColorValue = _g[1];
    var classes = exports.useStyles({});
    var palette = styles_1.useTheme().palette;
    var colors = (colorSuggestions === null || colorSuggestions === void 0 ? void 0 : colorSuggestions.length) ? colorSuggestions
        : [
            palette.red.main,
            palette.red.light,
            palette.orange.main,
            palette.orange.light,
            palette.yellow.main,
            palette.yellow.light,
            palette.green.main,
            palette.green.light,
            palette.blue.main,
            palette.blue.light,
            palette.purple.main,
            palette.purple.light,
            palette.black.main,
            palette.black.light,
            palette.common.white,
        ];
    var isValidColor = exports.isValidHexColor(colorValue);
    var uniqueId = React.useState(function () { return id || name || UniqueId_1.generateUniqueId('ColorPicker-'); })[0];
    // istanbul ignore if - not testing dev errors
    if (!label && !ariaLabel && process.env.NODE_ENV === 'development') {
        throw new Error('If a "label" is not provided to ColorPicker, please provide "aria-label".');
    }
    var Color = function (_a) {
        var className = _a.className, color = _a.color;
        return (React.createElement("span", { className: clsx_1.default(className, classes.color, variant === 'circle' && classes.colorCircle, variant === 'square' && classes.colorSquare), style: {
                backgroundColor: exports.isValidHexColor(color) ? color : '#000000',
            } }));
    };
    var handleChange = function (color) {
        setColorValue(color);
        // istanbul ignore next - not a great way to test not calling onChange
        onChange === null || onChange === void 0 ? void 0 : onChange(color);
    };
    return (React.createElement("div", { className: clsx_1.default(classes.root, className) },
        label && (React.createElement("label", { className: clsx_1.default(classes.label, color === 'inverse' && classes.labelInverse), htmlFor: uniqueId },
            label,
            !!Icon && tooltipMessage && (React.createElement(Tooltip_1.Tooltip, { title: tooltipMessage },
                React.createElement("span", { className: classes.tooltipContainer },
                    React.createElement(Icon, { "aria-hidden": true, className: clsx_1.default(classes.labelIcon, color === 'inverse' && classes.labelIconInverse), height: 16, width: 16, role: "img" })))),
            secondaryLabel && (React.createElement("span", { className: clsx_1.default(classes.labelSecondary, color === 'inverse' && classes.labelInverse) }, secondaryLabel)))),
        React.createElement("div", { className: clsx_1.default(classes.inputContainer, fullWidth && classes.inputFullWidth) },
            React.createElement("input", __assign({ "aria-describedby": forms_1.buildDescribedBy({
                    hasError: hasError,
                    hasHelpMessage: !!helpMessage,
                    uniqueId: uniqueId,
                }), "aria-label": ariaLabel, className: clsx_1.default(classes.input, fullWidth && classes.inputFullWidth, hasError && classes.inputError, hasError && color === 'inverse' && classes.inputErrorInverse, (_b = {}, _b[classes.inputInverse] = color === 'inverse', _b)), disabled: disabled, id: uniqueId, name: name, onChange: function (e) { return handleChange(e.target.value); }, readOnly: readOnly, ref: ref, type: "text", value: colorValue }, rootProps)),
            React.createElement(Popover_1.Popover, { anchorElement: React.createElement(ButtonUnstyled_1.ButtonUnstyled, { className: classes.swatchButton, "aria-label": "Pick color", disabled: disabled || readOnly },
                    React.createElement(Color, { color: colorValue })), "aria-label": "Color Picker", className: classes.popover }, function (_a) {
                var popover = _a.popover;
                return (React.createElement(React.Fragment, null,
                    React.createElement("div", { className: classes.valueDisplay, style: {
                            backgroundColor: isValidColor
                                ? value
                                : palette.common.black,
                            color: exports.isValidHexColor(value)
                                ? palette.getContrastText(value)
                                : palette.common.white,
                        } }, isValidColor ? value : invalidColorText),
                    React.createElement(Popover_1.PopoverList, { className: classes.popoverList }, colors.map(function (color, index) { return (React.createElement(Popover_1.PopoverItem, { className: classes.popoverItem, key: index },
                        React.createElement(ButtonUnstyled_1.ButtonUnstyled, { "aria-label": "Pick " + color, className: classes.colorButton, onClick: function () {
                                // istanbul ignore next - not a great way to test not calling onChange
                                handleChange === null || handleChange === void 0 ? void 0 : handleChange(color);
                                popover.hide();
                            } },
                            React.createElement(Color, { color: color })))); }))));
            })),
        helpMessage && (React.createElement(forms_1.FormHelpMessage, { color: color, className: clsx_1.default(classes.trailerMessage, classes.helpMessage, color === 'inverse' && classes.helpMessageInverse), describedById: forms_1.helpFor(uniqueId), rootElementId: uniqueId }, helpMessage)),
        hasError && errorMessage && (React.createElement(forms_1.FormErrorMessage, { className: clsx_1.default(classes.trailerMessage), color: color, describedById: forms_1.errorFor(uniqueId), rootElementId: uniqueId }, errorMessage))));
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29sb3JQaWNrZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29tcG9uZW50cy9Db2xvclBpY2tlci9Db2xvclBpY2tlci50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDhDQUF3QjtBQUN4QiwyQ0FBK0I7QUFDL0IsMkNBTzJCO0FBQzNCLG9EQUFtRDtBQUNuRCxpREFBd0Q7QUFFeEQsdUNBQW9EO0FBQ3BELHNDQUtvQjtBQUNwQixzQ0FBcUM7QUFDckMsOEVBQWlFO0FBQ2pFLHlCQUF1QjtBQUVWLFFBQUEsb0JBQW9CLEdBQUcsbUJBQW1CLENBQUM7QUFFM0MsUUFBQSxTQUFTLEdBQUcsbUJBQVUsQ0FDakMsVUFBQyxLQUFLLElBQUssT0FBQSxDQUFDO0lBQ1YsSUFBSSxFQUFFLEVBQUU7SUFDUixLQUFLLEVBQUU7UUFDTCxVQUFVLEVBQUUsUUFBUTtRQUNwQixLQUFLLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDO1FBQy9CLE9BQU8sRUFBRSxNQUFNO1FBQ2YsUUFBUSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDO1FBQzNCLFVBQVUsRUFBRSxLQUFLLENBQUMsVUFBVSxDQUFDLGNBQWM7UUFDM0MsWUFBWSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1FBQzlCLFNBQVMsRUFBRTtZQUNULFlBQVksRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztTQUMvQjtLQUNGO0lBQ0QsU0FBUyxFQUFFO1FBQ1QsVUFBVSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDO1FBQy9CLEtBQUssRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFJO0tBQ2xDO0lBQ0QsZ0JBQWdCLEVBQUU7UUFDaEIsWUFBWSxFQUFFLFFBQVE7S0FDdkI7SUFDRCxj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QVEsSUFBSSxZQUFZLElBQUksQ0FDM0Isb0JBQUMsd0JBQWdCLElBQ2YsU0FBUyxFQUFFLGNBQUksQ0FBQyxPQUFPLENBQUMsY0FBYyxDQUFDLEVBQ3ZDLEtBQUssRUFBRSxLQUFLLEVBQ1osYUFBYSxFQUFFLGdCQUFRLENBQUMsUUFBUSxDQUFDLEVBQ2pDLGFBQWEsRUFBRSxRQUFRLElBRXRCLFlBQVksQ0FDSSxDQUNwQixDQUNHLENBQ1AsQ0FBQztBQUNKLENBQUMsQ0FDRixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNsc3ggZnJvbSAnY2xzeCc7XG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQge1xuICBCYXNlRm9ybUVsZW1lbnQsXG4gIGJ1aWxkRGVzY3JpYmVkQnksXG4gIGVycm9yRm9yLFxuICBGb3JtRXJyb3JNZXNzYWdlLFxuICBGb3JtSGVscE1lc3NhZ2UsXG4gIGhlbHBGb3IsXG59IGZyb20gJy4uL19wcml2YXRlL2Zvcm1zJztcbmltcG9ydCB7IEJ1dHRvblVuc3R5bGVkIH0gZnJvbSAnLi4vQnV0dG9uVW5zdHlsZWQnO1xuaW1wb3J0IHsgZ2VuZXJhdGVVbmlxdWVJZCB9IGZyb20gJy4uL19wcml2YXRlL1VuaXF1ZUlkJztcbmltcG9ydCB7IEdldENsYXNzZXMgfSBmcm9tICcuLi8uLi90eXBlVXRpbHMnO1xuaW1wb3J0IHsgbWFrZVN0eWxlcywgdXNlVGhlbWUgfSBmcm9tICcuLi8uLi9zdHlsZXMnO1xuaW1wb3J0IHtcbiAgUG9wb3ZlcixcbiAgUG9wb3Zlckl0ZW0sXG4gIFBvcG92ZXJMaXN0LFxuICBQb3BvdmVyUmVuZGVyUHJvcHMsXG59IGZyb20gJy4uL1BvcG92ZXInO1xuaW1wb3J0IHsgVG9vbHRpcCB9IGZyb20gJy4uL1Rvb2x0aXAnO1xuaW1wb3J0IHsgZmFkZSB9IGZyb20gJ0BtYXRlcmlhbC11aS9jb3JlL3N0eWxlcy9jb2xvck1hbmlwdWxhdG9yJztcbmltcG9ydCAnZm9jdXMtdmlzaWJsZSc7XG5cbmV4cG9ydCBjb25zdCBDb2xvclBpY2tlclN0eWxlc0tleSA9ICdDaHJvbWFDb2xvclBpY2tlcic7XG5cbmV4cG9ydCBjb25zdCB1c2VTdHlsZXMgPSBtYWtlU3R5bGVzKFxuICAodGhlbWUpID0+ICh7XG4gICAgcm9vdDoge30sXG4gICAgbGFiZWw6IHtcbiAgICAgIGFsaWduSXRlbXM6ICdjZW50ZXInLFxuICAgICAgY29sb3I6IHRoZW1lLnBhbGV0dGUuYmxhY2tbODAwXSxcbiAgICAgIGRpc3BsYXk6ICdmbGV4JyxcbiAgICAgIGZvbnRTaXplOiB0aGVtZS5weFRvUmVtKDE0KSxcbiAgICAgIGZvbnRXZWlnaHQ6IHRoZW1lLnR5cG9ncmFwaHkuZm9udFdlaWdodEJvbGQsXG4gICAgICBtYXJnaW5Cb3R0b206IHRoZW1lLnNwYWNpbmcoMSksXG4gICAgICAnJjplbXB0eSc6IHtcbiAgICAgICAgbWFyZ2luQm90dG9tOiB0aGVtZS5zcGFjaW5nKDApLFxuICAgICAgfSxcbiAgICB9LFxuICAgIGxhYmVsSWNvbjoge1xuICAgICAgbWFyZ2luTGVmdDogdGhlbWUuc3BhY2luZygwLjc1KSxcbiAgICAgIGNvbG9yOiB0aGVtZS5wYWxldHRlLnByaW1hcnkubWFpbixcbiAgICB9LFxuICAgIGxhYmVsSWNvbkludmVyc2U6IHtcbiAgICAgIG1peEJsZW5kTW9kZTogJ3NjcmVlbicsXG4gICAgfSxcbiAgICBsYWJlbFNlY29uZGFyeToge1xuICAgICAgY29sb3I6IHRoZW1lLnBhbGV0dGUudGV4dC5oaW50LFxuICAgICAgZm9udFNpemU6IHRoZW1lLnB4VG9SZW0oMTEpLFxuICAgICAgZGlzcGxheTogJ2lubGluZS1ibG9jaycsXG4gICAgICBtYXJnaW46IHRoZW1lLnNwYWNpbmcoMCwgMC43NSksXG4gICAgfSxcbiAgICBsYWJlbEludmVyc2U6IHtcbiAgICAgIGNvbG9yOiB0aGVtZS5wYWxldHRlLmNvbW1vbi53aGl0ZSxcbiAgICAgICcmJGxhYmVsU2Vjb25kYXJ5Jzoge1xuICAgICAgICBvcGFjaXR5OiAwLjksXG4gICAgICB9LFxuICAgIH0sXG4gICAgaW5wdXQ6IHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogJ3JnYmEoMTMyLCAxMzcsIDE2NiwgMC4xNSknLFxuICAgICAgYm9yZGVyOiBgMXB4IHNvbGlkIHRyYW5zcGFyZW50YCxcbiAgICAgIGJvcmRlclJhZGl1czogdGhlbWUucHhUb1JlbSg0KSxcbiAgICAgIGNvbG9yOiB0aGVtZS5wYWxldHRlLnRleHQucHJpbWFyeSxcbiAgICAgIGZvbnRGYW1pbHk6IHRoZW1lLnR5cG9ncmFwaHkuZm9udEZhbWlseSxcbiAgICAgIGZvbnRTaXplOiB0aGVtZS5weFRvUmVtKDE0KSxcbiAgICAgIG1pbldpZHRoOiB0aGVtZS5weFRvUmVtKDE3NSksXG4gICAgICBsaW5lSGVpZ2h0OiAxLjI1LFxuICAgICAgcGFkZGluZ0JvdHRvbTogdGhlbWUuc3BhY2luZygxKSxcbiAgICAgIHBhZGRpbmdMZWZ0OiB0aGVtZS5zcGFjaW5nKDEuMjUpLFxuICAgICAgcGFkZGluZ1JpZ2h0OiB0aGVtZS5zcGFjaW5nKDEuMjUpLFxuICAgICAgcGFkZGluZ1RvcDogdGhlbWUuc3BhY2luZygxKSxcbiAgICAgIHRyYW5zaXRpb246ICdib3JkZXIgMC4yNXMgZWFzZScsXG4gICAgICAnJjpmb2N1cyc6IHtcbiAgICAgICAgb3V0bGluZTogJ25vbmUnLFxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNSknLFxuICAgICAgICBib3JkZXI6IGAxcHggc29saWQgcmdiYSgxMzIsIDEzNywgMTY2LCAwLjQ1KWAsXG4gICAgICB9LFxuICAgICAgJyY6ZGlzYWJsZWQnOiB7XG4gICAgICAgIGN1cnNvcjogJ25vdC1hbGxvd2VkJyxcbiAgICAgICAgb3BhY2l0eTogMC42MjUsXG4gICAgICB9LFxuICAgICAgJyY6cmVhZC1vbmx5Jzoge1xuICAgICAgICBjdXJzb3I6ICdub3QtYWxsb3dlZCcsXG4gICAgICAgIG9wYWNpdHk6IDAuOSxcbiAgICAgICAgJyY6Zm9jdXMnOiB7XG4gICAgICAgICAgYmFja2dyb3VuZENvbG9yOiAncmdiYSgxMzIsIDEzNywgMTY2LCAwLjE1KScsXG4gICAgICAgICAgYm9yZGVyOiBgMXB4IHNvbGlkIHRyYW5zcGFyZW50YCxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICAnJjo6LXdlYmtpdC1pbnB1dC1wbGFjZWhvbGRlcic6IHtcbiAgICAgICAgY29sb3I6IHRoZW1lLnBhbGV0dGUuYmxhY2tbNDAwXSxcbiAgICAgIH0sXG4gICAgICAnJjo6LW1vei1wbGFjZWhvbGRlcic6IHtcbiAgICAgICAgY29sb3I6IHRoZW1lLnBhbGV0dGUuYmxhY2tbNDAwXSxcbiAgICAgIH0sXG4gICAgICAnJjotbXMtaW5wdXQtcGxhY2Vob2xkZXInOiB7XG4gICAgICAgIGNvbG9yOiB0aGVtZS5wYWxldHRlLmJsYWNrWzQwMF0sXG4gICAgICB9LFxuICAgICAgJyY6LW1vei1wbGFjZWhvbGRlcic6IHtcbiAgICAgICAgY29sb3I6IHRoZW1lLnBhbGV0dGUuYmxhY2tbNDAwXSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBpbnB1dEludmVyc2U6IHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogJ3JnYmEoMjMwLCAyMzEsIDIzNywgMC4xKScsXG4gICAgICBjb2xvcjogdGhlbWUucGFsZXR0ZS5jb21tb24ud2hpdGUsXG4gICAgICAnJjpmb2N1cyc6IHtcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiAncmdiYSgyMzAsIDIzMSwgMjM3LCAwLjEpJyxcbiAgICAgICAgYm9yZGVyOiBgMXB4IHNvbGlkIHJnYmEoMjMwLCAyMzEsIDIzNywgMC41NSlgLFxuICAgICAgfSxcbiAgICAgICcmOnJlYWQtb25seSc6IHtcbiAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgJyY6Zm9jdXMnOiB7XG4gICAgICAgICAgYmFja2dyb3VuZENvbG9yOiAncmdiYSgyMzAsIDIzMSwgMjM3LCAwLjEpJyxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICAnJjo6LXdlYmtpdC1pbnB1dC1wbGFjZWhvbGRlcic6IHtcbiAgICAgICAgY29sb3I6ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuOCknLFxuICAgICAgfSxcbiAgICAgICcmOjotbW96LXBsYWNlaG9sZGVyJzoge1xuICAgICAgICBjb2xvcjogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC44KScsXG4gICAgICB9LFxuICAgICAgJyY6LW1zLWlucHV0LXBsYWNlaG9sZGVyJzoge1xuICAgICAgICBjb2xvcjogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC44KScsXG4gICAgICB9LFxuICAgICAgJyY6LW1vei1wbGFjZWhvbGRlcic6IHtcbiAgICAgICAgY29sb3I6ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuOCknLFxuICAgICAgfSxcbiAgICB9LFxuICAgIGhhc1RyYWlsZXI6IHtcbiAgICAgIG1hcmdpbkJvdHRvbTogdGhlbWUuc3BhY2luZygwLjUpLFxuICAgIH0sXG4gICAgaW5wdXRDb250YWluZXI6IHtcbiAgICAgIHBvc2l0aW9uOiAncmVsYXRpdmUnLFxuICAgICAgd2lkdGg6ICdmaXQtY29udGVudCcsXG4gICAgfSxcbiAgICBpbnB1dEVycm9yOiB7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6ICdyZ2JhKDIzMCwgMjMxLCAyMzcsIDAuMSknLFxuICAgICAgYm9yZGVyOiBgMXB4IHNvbGlkICR7dGhlbWUucGFsZXR0ZS5lcnJvci5tYWlufWAsXG4gICAgICAnJjpmb2N1cyc6IHtcbiAgICAgICAgYm9yZGVyOiBgMXB4IHNvbGlkICR7dGhlbWUucGFsZXR0ZS5lcnJvci5tYWlufWAsXG4gICAgICB9LFxuICAgIH0sXG4gICAgaW5wdXRFcnJvckludmVyc2U6IHtcbiAgICAgIGJvcmRlcjogYDFweCBzb2xpZCAke3RoZW1lLnBhbGV0dGUuZXJyb3JbNzAwXX1gLFxuICAgIH0sXG4gICAgaW5wdXRGdWxsV2lkdGg6IHtcbiAgICAgIHdpZHRoOiAnMTAwJScsXG4gICAgfSxcbiAgICB0cmFpbGVyTWVzc2FnZToge1xuICAgICAgbWFyZ2luVG9wOiB0aGVtZS5zcGFjaW5nKDAuODc1KSxcbiAgICAgIG1hcmdpbkxlZnQ6IDAsXG4gICAgfSxcbiAgICBlcnJvck1lc3NhZ2U6IHtcbiAgICAgIGNvbG9yOiB0aGVtZS5wYWxldHRlLmVycm9yLm1haW4sXG4gICAgICBmb250U2l6ZTogdGhlbWUudHlwb2dyYXBoeS5jYXB0aW9uLmZvbnRTaXplLFxuICAgICAgZm9udFdlaWdodDogdGhlbWUudHlwb2dyYXBoeS5mb250V2VpZ2h0Qm9sZCxcbiAgICB9LFxuICAgIGVycm9yTWVzc2FnZUludmVyc2U6IHtcbiAgICAgIG1peEJsZW5kTW9kZTogJ2NvbG9yLWRvZGdlJyxcbiAgICB9LFxuICAgIGhlbHBNZXNzYWdlOiB7XG4gICAgICBmb250U2l6ZTogdGhlbWUudHlwb2dyYXBoeS5jYXB0aW9uLmZvbnRTaXplLFxuICAgICAgY29sb3I6IHRoZW1lLnBhbGV0dGUudGV4dC5oaW50LFxuICAgIH0sXG4gICAgaGVscE1lc3NhZ2VJbnZlcnNlOiB7XG4gICAgICBjb2xvcjogdGhlbWUucGFsZXR0ZS5jb21tb24ud2hpdGUsXG4gICAgfSxcbiAgICB0b29sdGlwQ29udGFpbmVyOiB7XG4gICAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgICBvdXRsaW5lOiAnbm9uZScsXG4gICAgfSxcbiAgICB2YWx1ZURpc3BsYXk6IHtcbiAgICAgIGFsaWduSXRlbXM6ICdjZW50ZXInLFxuICAgICAgZGlzcGxheTogJ2ZsZXgnLFxuICAgICAgaGVpZ2h0OiB0aGVtZS5weFRvUmVtKDUwKSxcbiAgICAgIGp1c3RpZnlDb250ZW50OiAnY2VudGVyJyxcbiAgICAgIHBvc2l0aW9uOiAncmVsYXRpdmUnLFxuICAgICAgJyY6OmFmdGVyJzoge1xuICAgICAgICBiYWNrZ3JvdW5kOiBmYWRlKHRoZW1lLnBhbGV0dGUuY29tbW9uLmJsYWNrLCAwLjI1KSxcbiAgICAgICAgYm90dG9tOiAwLFxuICAgICAgICBjb250ZW50OiBgJydgLFxuICAgICAgICBoZWlnaHQ6IHRoZW1lLnB4VG9SZW0oMSksXG4gICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgICB3aWR0aDogJzEwMCUnLFxuICAgICAgfSxcbiAgICB9LFxuICAgIHN3YXRjaEJ1dHRvbjoge1xuICAgICAgaGVpZ2h0OiB0aGVtZS5weFRvUmVtKDIwKSxcbiAgICAgIHdpZHRoOiB0aGVtZS5weFRvUmVtKDIwKSxcbiAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgcmlnaHQ6IHRoZW1lLnNwYWNpbmcoMSksXG4gICAgICB0b3A6IHRoZW1lLnNwYWNpbmcoMSksXG4gICAgfSxcbiAgICBwb3BvdmVyOiB7XG4gICAgICBtaW5XaWR0aDogJ3Vuc2V0JyxcbiAgICB9LFxuICAgIHBvcG92ZXJMaXN0OiB7XG4gICAgICBkaXNwbGF5OiAnZ3JpZCcsXG4gICAgICBncmlkR2FwOiB0aGVtZS5zcGFjaW5nKDEuNSksXG4gICAgICBncmlkVGVtcGxhdGVDb2x1bW5zOiBgcmVwZWF0KDYsICR7dGhlbWUucHhUb1JlbSgyMCl9KWAsXG4gICAgICBtYXJnaW46IHRoZW1lLnNwYWNpbmcoMiksXG4gICAgICBwYWRkaW5nOiAwLFxuICAgICAgJyYgJGNvbG9yJzoge1xuICAgICAgICBtYXJnaW46IDAsXG4gICAgICB9LFxuICAgICAgJyY6Zm9jdXMnOiB7XG4gICAgICAgIG91dGxpbmU6ICdub25lJyxcbiAgICAgIH0sXG4gICAgICAvLyBXZSB1c2UgdGhpcyArIGEgcG9seWZpbGwgZm9yIG9sZGVyIGJyb3dzZXJcbiAgICAgIC8vIHRvIGdldCBhY2Nlc3NpYmxlIGJ1dHRvbnMgZm9yIGtleWJvYXJkLXVzZXJzLlxuICAgICAgLy8gVXNlcnMgd2lsbCBub3Qgc2VlIHRoZXNlIHN0eWxlcyB1bmxlc3MgdGhleSB1c2UgdGhlaXIga2V5Ym9hcmRcbiAgICAgIC8vIHRvIGZvY3VzIHRoZSBlbGVtZW50XG4gICAgICAnJjpmb2N1cy5mb2N1cy12aXNpYmxlJzoge1xuICAgICAgICBvdXRsaW5lOiBgc29saWQgMnB4ICR7dGhlbWUucGFsZXR0ZS5wcmltYXJ5Lm1haW59YCxcbiAgICAgICAgb3V0bGluZU9mZnNldDogdGhlbWUuc3BhY2luZygxKSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBwb3BvdmVySXRlbToge1xuICAgICAgcGFkZGluZzogMCxcbiAgICB9LFxuICAgIGNvbG9yQnV0dG9uOiB7XG4gICAgICB0cmFuc2l0aW9uOiAndHJhbnNmb3JtIDAuMjVzIGVhc2UtaW4tb3V0JyxcbiAgICAgIHRyYW5zZm9ybTogJ3NjYWxlKDEpJyxcbiAgICAgICcmOmhvdmVyLCY6Zm9jdXMnOiB7XG4gICAgICAgIHRyYW5zZm9ybTogJ3NjYWxlKDEuMiknLFxuICAgICAgfSxcbiAgICB9LFxuICAgIGNvbG9yOiB7XG4gICAgICBib3hTaGFkb3c6ICdpbnNldCAwIDAgM3B4IHJnYigzOCA0NCA1MCAvIDIwJSknLFxuICAgICAgZGlzcGxheTogJ2Jsb2NrJyxcbiAgICAgIGhlaWdodDogdGhlbWUucHhUb1JlbSgyMCksXG4gICAgICB3aWR0aDogdGhlbWUucHhUb1JlbSgyMCksXG4gICAgfSxcbiAgICBjb2xvckNpcmNsZToge1xuICAgICAgYm9yZGVyUmFkaXVzOiB0aGVtZS5weFRvUmVtKDEwKSxcbiAgICB9LFxuICAgIGNvbG9yU3F1YXJlOiB7XG4gICAgICBib3JkZXJSYWRpdXM6IHRoZW1lLnB4VG9SZW0oNCksXG4gICAgfSxcbiAgfSksXG4gIHsgbmFtZTogQ29sb3JQaWNrZXJTdHlsZXNLZXkgfVxuKTtcblxuZXhwb3J0IGNvbnN0IGlzVmFsaWRIZXhDb2xvciA9IChjb2xvcjogc3RyaW5nKSA9PiB7XG4gIGNvbnN0IGhleFJlZ2V4ID0gbmV3IFJlZ0V4cCgvXiNbMC05QS1GXXs2fSQvaSk7XG4gIGNvbnN0IHNob3J0SGFuZEhleFJlZ2V4ID0gbmV3IFJlZ0V4cCgvXiMoWzAtOUEtRl17M30pezEsMn0kL2kpO1xuICByZXR1cm4gaGV4UmVnZXgudGVzdChjb2xvcikgfHwgc2hvcnRIYW5kSGV4UmVnZXgudGVzdChjb2xvcik7XG59O1xuXG5leHBvcnQgdHlwZSBDb2xvclBpY2tlckNsYXNzZXMgPSBHZXRDbGFzc2VzPHR5cGVvZiB1c2VTdHlsZXM+O1xuXG5leHBvcnQgaW50ZXJmYWNlIENvbG9yUGlja2VyUHJvcHNcbiAgZXh0ZW5kcyBPbWl0PFJlYWN0LkNvbXBvbmVudFByb3BzV2l0aG91dFJlZjwnaW5wdXQnPiwgJ29uQ2hhbmdlJz4ge1xuICBjb2xvcj86IEJhc2VGb3JtRWxlbWVudFsnY29sb3InXTtcbiAgY29sb3JTdWdnZXN0aW9ucz86IEFycmF5PHN0cmluZz47XG4gIGVycm9yTWVzc2FnZT86IEJhc2VGb3JtRWxlbWVudFsnZXJyb3JNZXNzYWdlJ107XG4gIGZ1bGxXaWR0aD86IGJvb2xlYW47XG4gIGhhc0Vycm9yPzogQmFzZUZvcm1FbGVtZW50WydoYXNFcnJvciddO1xuICBoZWxwTWVzc2FnZT86IEJhc2VGb3JtRWxlbWVudFsnaGVscE1lc3NhZ2UnXTtcbiAgaWNvbj86IFJlYWN0LkNvbXBvbmVudFR5cGU8UmVhY3QuU1ZHUHJvcHM8U1ZHU1ZHRWxlbWVudD4+O1xuICBpbnZhbGlkQ29sb3JUZXh0Pzogc3RyaW5nO1xuICBsYWJlbD86IEJhc2VGb3JtRWxlbWVudFsnbGFiZWwnXTtcbiAgb25DaGFuZ2U/OiAoY29sb3I6IHN0cmluZykgPT4gdm9pZDtcbiAgc2Vjb25kYXJ5TGFiZWw/OiBzdHJpbmc7XG4gIHRvb2x0aXBNZXNzYWdlPzogc3RyaW5nO1xuICB2YWx1ZT86IHN0cmluZztcbiAgdmFyaWFudD86ICdzcXVhcmUnIHwgJ2NpcmNsZSc7XG59XG5cbmV4cG9ydCBjb25zdCBDb2xvclBpY2tlciA9IFJlYWN0LmZvcndhcmRSZWY8SFRNTElucHV0RWxlbWVudCwgQ29sb3JQaWNrZXJQcm9wcz4oXG4gIChcbiAgICB7XG4gICAgICBbJ2FyaWEtbGFiZWwnXTogYXJpYUxhYmVsLFxuICAgICAgY2xhc3NOYW1lLFxuICAgICAgY29sb3IgPSAnZGVmYXVsdCcsXG4gICAgICBjb2xvclN1Z2dlc3Rpb25zLFxuICAgICAgZGlzYWJsZWQsXG4gICAgICBlcnJvck1lc3NhZ2UsXG4gICAgICBmdWxsV2lkdGgsXG4gICAgICBoYXNFcnJvcixcbiAgICAgIGhlbHBNZXNzYWdlLFxuICAgICAgaWNvbjogSWNvbixcbiAgICAgIGlkLFxuICAgICAgaW52YWxpZENvbG9yVGV4dCA9ICdJbnZhbGlkIENvbG9yJyxcbiAgICAgIGxhYmVsLFxuICAgICAgbmFtZSxcbiAgICAgIG9uQ2hhbmdlLFxuICAgICAgcmVhZE9ubHksXG4gICAgICBzZWNvbmRhcnlMYWJlbCxcbiAgICAgIHRvb2x0aXBNZXNzYWdlLFxuICAgICAgdmFsdWUgPSAnJyxcbiAgICAgIHZhcmlhbnQgPSAnc3F1YXJlJyxcbiAgICAgIC4uLnJvb3RQcm9wc1xuICAgIH0sXG4gICAgcmVmXG4gICkgPT4ge1xuICAgIGNvbnN0IFtjb2xvclZhbHVlLCBzZXRDb2xvclZhbHVlXSA9IFJlYWN0LnVzZVN0YXRlPHN0cmluZz4odmFsdWUpO1xuXG4gICAgY29uc3QgY2xhc3NlcyA9IHVzZVN0eWxlcyh7fSk7XG4gICAgY29uc3QgeyBwYWxldHRlIH0gPSB1c2VUaGVtZSgpO1xuXG4gICAgY29uc3QgY29sb3JzID0gY29sb3JTdWdnZXN0aW9ucz8ubGVuZ3RoXG4gICAgICA/IGNvbG9yU3VnZ2VzdGlvbnNcbiAgICAgIDogKFtcbiAgICAgICAgICBwYWxldHRlLnJlZC5tYWluLFxuICAgICAgICAgIHBhbGV0dGUucmVkLmxpZ2h0LFxuICAgICAgICAgIHBhbGV0dGUub3JhbmdlLm1haW4sXG4gICAgICAgICAgcGFsZXR0ZS5vcmFuZ2UubGlnaHQsXG4gICAgICAgICAgcGFsZXR0ZS55ZWxsb3cubWFpbixcbiAgICAgICAgICBwYWxldHRlLnllbGxvdy5saWdodCxcbiAgICAgICAgICBwYWxldHRlLmdyZWVuLm1haW4sXG4gICAgICAgICAgcGFsZXR0ZS5ncmVlbi5saWdodCxcbiAgICAgICAgICBwYWxldHRlLmJsdWUubWFpbixcbiAgICAgICAgICBwYWxldHRlLmJsdWUubGlnaHQsXG4gICAgICAgICAgcGFsZXR0ZS5wdXJwbGUubWFpbixcbiAgICAgICAgICBwYWxldHRlLnB1cnBsZS5saWdodCxcbiAgICAgICAgICBwYWxldHRlLmJsYWNrLm1haW4sXG4gICAgICAgICAgcGFsZXR0ZS5ibGFjay5saWdodCxcbiAgICAgICAgICBwYWxldHRlLmNvbW1vbi53aGl0ZSxcbiAgICAgICAgXSBhcyBBcnJheTxzdHJpbmc+KTtcblxuICAgIGNvbnN0IGlzVmFsaWRDb2xvciA9IGlzVmFsaWRIZXhDb2xvcihjb2xvclZhbHVlKTtcblxuICAgIGNvbnN0IFt1bmlxdWVJZF0gPSBSZWFjdC51c2VTdGF0ZTxzdHJpbmc+KFxuICAgICAgKCkgPT4gaWQgfHwgbmFtZSB8fCBnZW5lcmF0ZVVuaXF1ZUlkKCdDb2xvclBpY2tlci0nKVxuICAgICk7XG5cbiAgICAvLyBpc3RhbmJ1bCBpZ25vcmUgaWYgLSBub3QgdGVzdGluZyBkZXYgZXJyb3JzXG4gICAgaWYgKCFsYWJlbCAmJiAhYXJpYUxhYmVsICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICdJZiBhIFwibGFiZWxcIiBpcyBub3QgcHJvdmlkZWQgdG8gQ29sb3JQaWNrZXIsIHBsZWFzZSBwcm92aWRlIFwiYXJpYS1sYWJlbFwiLidcbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QgQ29sb3IgPSAoe1xuICAgICAgY2xhc3NOYW1lLFxuICAgICAgY29sb3IsXG4gICAgfToge1xuICAgICAgY2xhc3NOYW1lPzogc3RyaW5nO1xuICAgICAgY29sb3I6IHN0cmluZztcbiAgICB9KSA9PiAoXG4gICAgICA8c3BhblxuICAgICAgICBjbGFzc05hbWU9e2Nsc3goXG4gICAgICAgICAgY2xhc3NOYW1lLFxuICAgICAgICAgIGNsYXNzZXMuY29sb3IsXG4gICAgICAgICAgdmFyaWFudCA9PT0gJ2NpcmNsZScgJiYgY2xhc3Nlcy5jb2xvckNpcmNsZSxcbiAgICAgICAgICB2YXJpYW50ID09PSAnc3F1YXJlJyAmJiBjbGFzc2VzLmNvbG9yU3F1YXJlXG4gICAgICAgICl9XG4gICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBpc1ZhbGlkSGV4Q29sb3IoY29sb3IpID8gY29sb3IgOiAnIzAwMDAwMCcsXG4gICAgICAgIH19XG4gICAgICAvPlxuICAgICk7XG5cbiAgICBjb25zdCBoYW5kbGVDaGFuZ2UgPSAoY29sb3I6IHN0cmluZykgPT4ge1xuICAgICAgc2V0Q29sb3JWYWx1ZShjb2xvcik7XG4gICAgICAvLyBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAtIG5vdCBhIGdyZWF0IHdheSB0byB0ZXN0IG5vdCBjYWxsaW5nIG9uQ2hhbmdlXG4gICAgICBvbkNoYW5nZT8uKGNvbG9yKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPXtjbHN4KGNsYXNzZXMucm9vdCwgY2xhc3NOYW1lKX0+XG4gICAgICAgIHtsYWJlbCAmJiAoXG4gICAgICAgICAgPGxhYmVsXG4gICAgICAgICAgICBjbGFzc05hbWU9e2Nsc3goXG4gICAgICAgICAgICAgIGNsYXNzZXMubGFiZWwsXG4gICAgICAgICAgICAgIGNvbG9yID09PSAnaW52ZXJzZScgJiYgY2xhc3Nlcy5sYWJlbEludmVyc2VcbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICBodG1sRm9yPXt1bmlxdWVJZH1cbiAgICAgICAgICA+XG4gICAgICAgICAgICB7bGFiZWx9XG4gICAgICAgICAgICB7ISFJY29uICYmIHRvb2x0aXBNZXNzYWdlICYmIChcbiAgICAgICAgICAgICAgPFRvb2x0aXAgdGl0bGU9e3Rvb2x0aXBNZXNzYWdlfT5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9e2NsYXNzZXMudG9vbHRpcENvbnRhaW5lcn0+XG4gICAgICAgICAgICAgICAgICA8SWNvblxuICAgICAgICAgICAgICAgICAgICBhcmlhLWhpZGRlblxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2Nsc3goXG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3Nlcy5sYWJlbEljb24sXG4gICAgICAgICAgICAgICAgICAgICAgY29sb3IgPT09ICdpbnZlcnNlJyAmJiBjbGFzc2VzLmxhYmVsSWNvbkludmVyc2VcbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0PXsxNn1cbiAgICAgICAgICAgICAgICAgICAgd2lkdGg9ezE2fVxuICAgICAgICAgICAgICAgICAgICByb2xlPVwiaW1nXCJcbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICApfVxuICAgICAgICAgICAge3NlY29uZGFyeUxhYmVsICYmIChcbiAgICAgICAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2Nsc3goXG4gICAgICAgICAgICAgICAgICBjbGFzc2VzLmxhYmVsU2Vjb25kYXJ5LFxuICAgICAgICAgICAgICAgICAgY29sb3IgPT09ICdpbnZlcnNlJyAmJiBjbGFzc2VzLmxhYmVsSW52ZXJzZVxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7c2Vjb25kYXJ5TGFiZWx9XG4gICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgKX1cbiAgICAgICAgPGRpdlxuICAgICAgICAgIGNsYXNzTmFtZT17Y2xzeChcbiAgICAgICAgICAgIGNsYXNzZXMuaW5wdXRDb250YWluZXIsXG4gICAgICAgICAgICBmdWxsV2lkdGggJiYgY2xhc3Nlcy5pbnB1dEZ1bGxXaWR0aFxuICAgICAgICAgICl9XG4gICAgICAgID5cbiAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgIGFyaWEtZGVzY3JpYmVkYnk9e2J1aWxkRGVzY3JpYmVkQnkoe1xuICAgICAgICAgICAgICBoYXNFcnJvcixcbiAgICAgICAgICAgICAgaGFzSGVscE1lc3NhZ2U6ICEhaGVscE1lc3NhZ2UsXG4gICAgICAgICAgICAgIHVuaXF1ZUlkLFxuICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICBhcmlhLWxhYmVsPXthcmlhTGFiZWx9XG4gICAgICAgICAgICBjbGFzc05hbWU9e2Nsc3goXG4gICAgICAgICAgICAgIGNsYXNzZXMuaW5wdXQsXG4gICAgICAgICAgICAgIGZ1bGxXaWR0aCAmJiBjbGFzc2VzLmlucHV0RnVsbFdpZHRoLFxuICAgICAgICAgICAgICBoYXNFcnJvciAmJiBjbGFzc2VzLmlucHV0RXJyb3IsXG4gICAgICAgICAgICAgIGhhc0Vycm9yICYmIGNvbG9yID09PSAnaW52ZXJzZScgJiYgY2xhc3Nlcy5pbnB1dEVycm9ySW52ZXJzZSxcbiAgICAgICAgICAgICAgeyBbY2xhc3Nlcy5pbnB1dEludmVyc2VdOiBjb2xvciA9PT0gJ2ludmVyc2UnIH1cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICBkaXNhYmxlZD17ZGlzYWJsZWR9XG4gICAgICAgICAgICBpZD17dW5pcXVlSWR9XG4gICAgICAgICAgICBuYW1lPXtuYW1lfVxuICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBoYW5kbGVDaGFuZ2UoZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgcmVhZE9ubHk9e3JlYWRPbmx5fVxuICAgICAgICAgICAgcmVmPXtyZWZ9XG4gICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICB2YWx1ZT17Y29sb3JWYWx1ZX1cbiAgICAgICAgICAgIHsuLi5yb290UHJvcHN9XG4gICAgICAgICAgLz5cblxuICAgICAgICAgIDxQb3BvdmVyXG4gICAgICAgICAgICBhbmNob3JFbGVtZW50PXtcbiAgICAgICAgICAgICAgPEJ1dHRvblVuc3R5bGVkXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbGFzc2VzLnN3YXRjaEJ1dHRvbn1cbiAgICAgICAgICAgICAgICBhcmlhLWxhYmVsPVwiUGljayBjb2xvclwiXG4gICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2Rpc2FibGVkIHx8IHJlYWRPbmx5fVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPENvbG9yIGNvbG9yPXtjb2xvclZhbHVlfSAvPlxuICAgICAgICAgICAgICA8L0J1dHRvblVuc3R5bGVkPlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXJpYS1sYWJlbD1cIkNvbG9yIFBpY2tlclwiXG4gICAgICAgICAgICBjbGFzc05hbWU9e2NsYXNzZXMucG9wb3Zlcn1cbiAgICAgICAgICA+XG4gICAgICAgICAgICB7KHsgcG9wb3ZlciB9OiBQb3BvdmVyUmVuZGVyUHJvcHMpID0+IChcbiAgICAgICAgICAgICAgPD5cbiAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2NsYXNzZXMudmFsdWVEaXNwbGF5fVxuICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBpc1ZhbGlkQ29sb3JcbiAgICAgICAgICAgICAgICAgICAgICA/IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgOiBwYWxldHRlLmNvbW1vbi5ibGFjayxcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IGlzVmFsaWRIZXhDb2xvcih2YWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgICA/IHBhbGV0dGUuZ2V0Q29udHJhc3RUZXh0KHZhbHVlKVxuICAgICAgICAgICAgICAgICAgICAgIDogcGFsZXR0ZS5jb21tb24ud2hpdGUsXG4gICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgIHtpc1ZhbGlkQ29sb3IgPyB2YWx1ZSA6IGludmFsaWRDb2xvclRleHR9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICA8UG9wb3Zlckxpc3QgY2xhc3NOYW1lPXtjbGFzc2VzLnBvcG92ZXJMaXN0fT5cbiAgICAgICAgICAgICAgICAgIHtjb2xvcnMubWFwKChjb2xvcjogc3RyaW5nLCBpbmRleDogbnVtYmVyKSA9PiAoXG4gICAgICAgICAgICAgICAgICAgIDxQb3BvdmVySXRlbSBjbGFzc05hbWU9e2NsYXNzZXMucG9wb3Zlckl0ZW19IGtleT17aW5kZXh9PlxuICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b25VbnN0eWxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgYXJpYS1sYWJlbD17YFBpY2sgJHtjb2xvcn1gfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbGFzc2VzLmNvbG9yQnV0dG9ufVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAtIG5vdCBhIGdyZWF0IHdheSB0byB0ZXN0IG5vdCBjYWxsaW5nIG9uQ2hhbmdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUNoYW5nZT8uKGNvbG9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcG9wb3Zlci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxDb2xvciBjb2xvcj17Y29sb3J9IC8+XG4gICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b25VbnN0eWxlZD5cbiAgICAgICAgICAgICAgICAgICAgPC9Qb3BvdmVySXRlbT5cbiAgICAgICAgICAgICAgICAgICkpfVxuICAgICAgICAgICAgICAgIDwvUG9wb3Zlckxpc3Q+XG4gICAgICAgICAgICAgIDwvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8L1BvcG92ZXI+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIHtoZWxwTWVzc2FnZSAmJiAoXG4gICAgICAgICAgPEZvcm1IZWxwTWVzc2FnZVxuICAgICAgICAgICAgY29sb3I9e2NvbG9yfVxuICAgICAgICAgICAgY2xhc3NOYW1lPXtjbHN4KFxuICAgICAgICAgICAgICBjbGFzc2VzLnRyYWlsZXJNZXNzYWdlLFxuICAgICAgICAgICAgICBjbGFzc2VzLmhlbHBNZXNzYWdlLFxuICAgICAgICAgICAgICBjb2xvciA9PT0gJ2ludmVyc2UnICYmIGNsYXNzZXMuaGVscE1lc3NhZ2VJbnZlcnNlXG4gICAgICAgICAgICApfVxuICAgICAgICAgICAgZGVzY3JpYmVkQnlJZD17aGVscEZvcih1bmlxdWVJZCl9XG4gICAgICAgICAgICByb290RWxlbWVudElkPXt1bmlxdWVJZH1cbiAgICAgICAgICA+XG4gICAgICAgICAgICB7aGVscE1lc3NhZ2V9XG4gICAgICAgICAgPC9Gb3JtSGVscE1lc3NhZ2U+XG4gICAgICAgICl9XG4gICAgICAgIHtoYXNFcnJvciAmJiBlcnJvck1lc3NhZ2UgJiYgKFxuICAgICAgICAgIDxGb3JtRXJyb3JNZXNzYWdlXG4gICAgICAgICAgICBjbGFzc05hbWU9e2Nsc3goY2xhc3Nlcy50cmFpbGVyTWVzc2FnZSl9XG4gICAgICAgICAgICBjb2xvcj17Y29sb3J9XG4gICAgICAgICAgICBkZXNjcmliZWRCeUlkPXtlcnJvckZvcih1bmlxdWVJZCl9XG4gICAgICAgICAgICByb290RWxlbWVudElkPXt1bmlxdWVJZH1cbiAgICAgICAgICA+XG4gICAgICAgICAgICB7ZXJyb3JNZXNzYWdlfVxuICAgICAgICAgIDwvRm9ybUVycm9yTWVzc2FnZT5cbiAgICAgICAgKX1cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cbik7XG4iXX0=