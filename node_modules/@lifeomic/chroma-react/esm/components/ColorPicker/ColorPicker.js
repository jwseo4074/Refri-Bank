var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};
import clsx from 'clsx';
import * as React from 'react';
import { buildDescribedBy, errorFor, FormErrorMessage, FormHelpMessage, helpFor, } from '../_private/forms';
import { ButtonUnstyled } from '../ButtonUnstyled';
import { generateUniqueId } from '../_private/UniqueId';
import { makeStyles, useTheme } from '../../styles';
import { Popover, PopoverItem, PopoverList, } from '../Popover';
import { Tooltip } from '../Tooltip';
import { fade } from '@material-ui/core/styles/colorManipulator';
import 'focus-visible';
export var ColorPickerStylesKey = 'ChromaColorPicker';
export var useStyles = makeStyles(function (theme) { return ({
    root: {},
    label: {
        alignItems: 'center',
        color: theme.palette.black[800],
        display: 'flex',
        fontSize: theme.pxToRem(14),
        fontWeight: theme.typography.fontWeightBold,
        marginBottom: theme.spacing(1),
        '&:empty': {
            marginBottom: theme.spacing(0),
        },
    },
    labelIcon: {
        marginLeft: theme.spacing(0.75),
        color: theme.palette.primary.main,
    },
    labelIconInverse: {
        mixBlendMode: 'screen',
    },
    labelSecondary: {
        color: theme.palette.text.hint,
        fontSize: theme.pxToRem(11),
        display: 'inline-block',
        margin: theme.spacing(0, 0.75),
    },
    labelInverse: {
        color: theme.palette.common.white,
        '&$labelSecondary': {
            opacity: 0.9,
        },
    },
    input: {
        backgroundColor: 'rgba(132, 137, 166, 0.15)',
        border: "1px solid transparent",
        borderRadius: theme.pxToRem(4),
        color: theme.palette.text.primary,
        fontFamily: theme.typography.fontFamily,
        fontSize: theme.pxToRem(14),
        minWidth: theme.pxToRem(175),
        lineHeight: 1.25,
        paddingBottom: theme.spacing(1),
        paddingLeft: theme.spacing(1.25),
        paddingRight: theme.spacing(1.25),
        paddingTop: theme.spacing(1),
        transition: 'border 0.25s ease',
        '&:focus': {
            outline: 'none',
            backgroundColor: 'rgba(255, 255, 255, 0.5)',
            border: "1px solid rgba(132, 137, 166, 0.45)",
        },
        '&:disabled': {
            cursor: 'not-allowed',
            opacity: 0.625,
        },
        '&:read-only': {
            cursor: 'not-allowed',
            opacity: 0.9,
            '&:focus': {
                backgroundColor: 'rgba(132, 137, 166, 0.15)',
                border: "1px solid transparent",
            },
        },
        '&::-webkit-input-placeholder': {
            color: theme.palette.black[400],
        },
        '&::-moz-placeholder': {
            color: theme.palette.black[400],
        },
        '&:-ms-input-placeholder': {
            color: theme.palette.black[400],
        },
        '&:-moz-placeholder': {
            color: theme.palette.black[400],
        },
    },
    inputInverse: {
        backgroundColor: 'rgba(230, 231, 237, 0.1)',
        color: theme.palette.common.white,
        '&:focus': {
            backgroundColor: 'rgba(230, 231, 237, 0.1)',
            border: "1px solid rgba(230, 231, 237, 0.55)",
        },
        '&:read-only': {
            opacity: 1,
            '&:focus': {
                backgroundColor: 'rgba(230, 231, 237, 0.1)',
            },
        },
        '&::-webkit-input-placeholder': {
            color: 'rgba(255, 255, 255, 0.8)',
        },
        '&::-moz-placeholder': {
            color: 'rgba(255, 255, 255, 0.8)',
        },
        '&:-ms-input-placeholder': {
            color: 'rgba(255, 255, 255, 0.8)',
        },
        '&:-moz-placeholder': {
            color: 'rgba(255, 255, 255, 0.8)',
        },
    },
    hasTrailer: {
        marginBottom: theme.spacing(0.5),
    },
    inputContainer: {
        position: 'relative',
        width: 'fit-content',
    },
    inputError: {
        backgroundColor: 'rgba(230, 231, 237, 0.1)',
        border: "1px solid ".concat(theme.palette.error.main),
        '&:focus': {
            border: "1px solid ".concat(theme.palette.error.main),
        },
    },
    inputErrorInverse: {
        border: "1px solid ".concat(theme.palette.error[700]),
    },
    inputFullWidth: {
        width: '100%',
    },
    trailerMessage: {
        marginTop: theme.spacing(0.875),
        marginLeft: 0,
    },
    errorMessage: {
        color: theme.palette.error.main,
        fontSize: theme.typography.caption.fontSize,
        fontWeight: theme.typography.fontWeightBold,
    },
    errorMessageInverse: {
        mixBlendMode: 'color-dodge',
    },
    helpMessage: {
        fontSize: theme.typography.caption.fontSize,
        color: theme.palette.text.hint,
    },
    helpMessageInverse: {
        color: theme.palette.common.white,
    },
    tooltipContainer: {
        display: 'flex',
        outline: 'none',
    },
    valueDisplay: {
        alignItems: 'center',
        display: 'flex',
        height: theme.pxToRem(50),
        justifyContent: 'center',
        position: 'relative',
        '&::after': {
            background: fade(theme.palette.common.black, 0.25),
            bottom: 0,
            content: "''",
            height: theme.pxToRem(1),
            position: 'absolute',
            width: '100%',
        },
    },
    swatchButton: {
        height: theme.pxToRem(20),
        width: theme.pxToRem(20),
        position: 'absolute',
        right: theme.spacing(1),
        top: theme.spacing(1),
    },
    popover: {
        minWidth: 'unset',
    },
    popoverList: {
        display: 'grid',
        gridGap: theme.spacing(1.5),
        gridTemplateColumns: "repeat(6, ".concat(theme.pxToRem(20), ")"),
        margin: theme.spacing(2),
        padding: 0,
        '& $color': {
            margin: 0,
        },
        '&:focus': {
            outline: 'none',
        },
        // We use this + a polyfill for older browser
        // to get accessible buttons for keyboard-users.
        // Users will not see these styles unless they use their keyboard
        // to focus the element
        '&:focus.focus-visible': {
            outline: "solid 2px ".concat(theme.palette.primary.main),
            outlineOffset: theme.spacing(1),
        },
    },
    popoverItem: {
        padding: 0,
    },
    colorButton: {
        transition: 'transform 0.25s ease-in-out',
        transform: 'scale(1)',
        '&:hover,&:focus': {
            transform: 'scale(1.2)',
        },
    },
    color: {
        boxShadow: 'inset 0 0 3px rgb(38 44 50 / 20%)',
        display: 'block',
        height: theme.pxToRem(20),
        width: theme.pxToRem(20),
    },
    colorCircle: {
        borderRadius: theme.pxToRem(10),
    },
    colorSquare: {
        borderRadius: theme.pxToRem(4),
    },
}); }, { name: ColorPickerStylesKey });
export var isValidHexColor = function (color) {
    var hexRegex = new RegExp(/^#[0-9A-F]{6}$/i);
    var shortHandHexRegex = new RegExp(/^#([0-9A-F]{3}){1,2}$/i);
    return hexRegex.test(color) || shortHandHexRegex.test(color);
};
export var ColorPicker = React.forwardRef(function (_a, ref) {
    var _b;
    var ariaLabel = _a["aria-label"], className = _a.className, _c = _a.color, color = _c === void 0 ? 'default' : _c, colorSuggestions = _a.colorSuggestions, disabled = _a.disabled, errorMessage = _a.errorMessage, fullWidth = _a.fullWidth, hasError = _a.hasError, helpMessage = _a.helpMessage, Icon = _a.icon, id = _a.id, _d = _a.invalidColorText, invalidColorText = _d === void 0 ? 'Invalid Color' : _d, label = _a.label, name = _a.name, onChange = _a.onChange, readOnly = _a.readOnly, secondaryLabel = _a.secondaryLabel, tooltipMessage = _a.tooltipMessage, _e = _a.value, value = _e === void 0 ? '' : _e, _f = _a.variant, variant = _f === void 0 ? 'square' : _f, rootProps = __rest(_a, ['aria-label', "className", "color", "colorSuggestions", "disabled", "errorMessage", "fullWidth", "hasError", "helpMessage", "icon", "id", "invalidColorText", "label", "name", "onChange", "readOnly", "secondaryLabel", "tooltipMessage", "value", "variant"]);
    var _g = React.useState(value), colorValue = _g[0], setColorValue = _g[1];
    var classes = useStyles({});
    var palette = useTheme().palette;
    var colors = (colorSuggestions === null || colorSuggestions === void 0 ? void 0 : colorSuggestions.length)
        ? colorSuggestions
        : [
            palette.red.main,
            palette.red.light,
            palette.orange.main,
            palette.orange.light,
            palette.yellow.main,
            palette.yellow.light,
            palette.green.main,
            palette.green.light,
            palette.blue.main,
            palette.blue.light,
            palette.purple.main,
            palette.purple.light,
            palette.black.main,
            palette.black.light,
            palette.common.white,
        ];
    var isValidColor = isValidHexColor(colorValue);
    var uniqueId = React.useState(function () { return id || name || generateUniqueId('ColorPicker-'); })[0];
    // istanbul ignore if - not testing dev errors
    if (!label && !ariaLabel && process.env.NODE_ENV === 'development') {
        throw new Error('If a "label" is not provided to ColorPicker, please provide "aria-label".');
    }
    var Color = function (_a) {
        var className = _a.className, color = _a.color;
        return (React.createElement("span", { className: clsx(className, classes.color, variant === 'circle' && classes.colorCircle, variant === 'square' && classes.colorSquare), style: {
                backgroundColor: isValidHexColor(color) ? color : '#000000',
            } }));
    };
    var handleChange = function (color) {
        setColorValue(color);
        // istanbul ignore next - not a great way to test not calling onChange
        onChange === null || onChange === void 0 ? void 0 : onChange(color);
    };
    return (React.createElement("div", { className: clsx(classes.root, className) },
        label && (React.createElement("label", { className: clsx(classes.label, color === 'inverse' && classes.labelInverse), htmlFor: uniqueId },
            label,
            !!Icon && tooltipMessage && (React.createElement(Tooltip, { title: tooltipMessage },
                React.createElement("span", { className: classes.tooltipContainer },
                    React.createElement(Icon, { "aria-hidden": true, className: clsx(classes.labelIcon, color === 'inverse' && classes.labelIconInverse), height: 16, width: 16, role: "img" })))),
            secondaryLabel && (React.createElement("span", { className: clsx(classes.labelSecondary, color === 'inverse' && classes.labelInverse) }, secondaryLabel)))),
        React.createElement("div", { className: clsx(classes.inputContainer, fullWidth && classes.inputFullWidth) },
            React.createElement("input", __assign({ "aria-describedby": buildDescribedBy({
                    hasError: hasError,
                    hasHelpMessage: !!helpMessage,
                    uniqueId: uniqueId,
                }), "aria-label": ariaLabel, className: clsx(classes.input, fullWidth && classes.inputFullWidth, hasError && classes.inputError, hasError && color === 'inverse' && classes.inputErrorInverse, (_b = {}, _b[classes.inputInverse] = color === 'inverse', _b)), disabled: disabled, id: uniqueId, name: name, onChange: function (e) { return handleChange(e.target.value); }, readOnly: readOnly, ref: ref, type: "text", value: colorValue }, rootProps)),
            React.createElement(Popover, { anchorElement: React.createElement(ButtonUnstyled, { className: classes.swatchButton, "aria-label": "Pick color", disabled: disabled || readOnly },
                    React.createElement(Color, { color: colorValue })), "aria-label": "Color Picker", className: classes.popover }, function (_a) {
                var popover = _a.popover;
                return (React.createElement(React.Fragment, null,
                    React.createElement("div", { className: classes.valueDisplay, style: {
                            backgroundColor: isValidColor
                                ? value
                                : palette.common.black,
                            color: isValidHexColor(value)
                                ? palette.getContrastText(value)
                                : palette.common.white,
                        } }, isValidColor ? value : invalidColorText),
                    React.createElement(PopoverList, { className: classes.popoverList }, colors.map(function (color, index) { return (React.createElement(PopoverItem, { className: classes.popoverItem, key: index },
                        React.createElement(ButtonUnstyled, { "aria-label": "Pick ".concat(color), className: classes.colorButton, onClick: function () {
                                // istanbul ignore next - not a great way to test not calling onChange
                                handleChange === null || handleChange === void 0 ? void 0 : handleChange(color);
                                popover.hide();
                            } },
                            React.createElement(Color, { color: color })))); }))));
            })),
        helpMessage && (React.createElement(FormHelpMessage, { color: color, className: clsx(classes.trailerMessage, classes.helpMessage, color === 'inverse' && classes.helpMessageInverse), describedById: helpFor(uniqueId), rootElementId: uniqueId }, helpMessage)),
        hasError && errorMessage && (React.createElement(FormErrorMessage, { className: clsx(classes.trailerMessage), color: color, describedById: errorFor(uniqueId), rootElementId: uniqueId }, errorMessage))));
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29sb3JQaWNrZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy9Db2xvclBpY2tlci9Db2xvclBpY2tlci50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLE9BQU8sSUFBSSxNQUFNLE1BQU0sQ0FBQztBQUN4QixPQUFPLEtBQUssS0FBSyxNQUFNLE9BQU8sQ0FBQztBQUMvQixPQUFPLEVBRUwsZ0JBQWdCLEVBQ2hCLFFBQVEsRUFDUixnQkFBZ0IsRUFDaEIsZUFBZSxFQUNmLE9BQU8sR0FDUixNQUFNLG1CQUFtQixDQUFDO0FBQzNCLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNuRCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUV4RCxPQUFPLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxNQUFNLGNBQWMsQ0FBQztBQUNwRCxPQUFPLEVBQ0wsT0FBTyxFQUNQLFdBQVcsRUFDWCxXQUFXLEdBRVosTUFBTSxZQUFZLENBQUM7QUFDcEIsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLFlBQVksQ0FBQztBQUNyQyxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sMkNBQTJDLENBQUM7QUFDakUsT0FBTyxlQUFlLENBQUM7QUFFdkIsTUFBTSxDQUFDLElBQU0sb0JBQW9CLEdBQUcsbUJBQW1CLENBQUM7QUFFeEQsTUFBTSxDQUFDLElBQU0sU0FBUyxHQUFHLFVBQVUsQ0FDakMsVUFBQyxLQUFLLElBQUssT0FBQSxDQUFDO0lBQ1YsSUFBSSxFQUFFLEVBQUU7SUFDUixLQUFLLEVBQUU7UUFDTCxVQUFVLEVBQUUsUUFBUTtRQUNwQixLQUFLLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDO1FBQy9CLE9BQU8sRUFBRSxNQUFNO1FBQ2YsUUFBUSxFQUFFLEtBQUssQ0FBQyxPQUFP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QUM7QUFDSixDQUFDLENBQ0YsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjbHN4IGZyb20gJ2Nsc3gnO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtcbiAgQmFzZUZvcm1FbGVtZW50LFxuICBidWlsZERlc2NyaWJlZEJ5LFxuICBlcnJvckZvcixcbiAgRm9ybUVycm9yTWVzc2FnZSxcbiAgRm9ybUhlbHBNZXNzYWdlLFxuICBoZWxwRm9yLFxufSBmcm9tICcuLi9fcHJpdmF0ZS9mb3Jtcyc7XG5pbXBvcnQgeyBCdXR0b25VbnN0eWxlZCB9IGZyb20gJy4uL0J1dHRvblVuc3R5bGVkJztcbmltcG9ydCB7IGdlbmVyYXRlVW5pcXVlSWQgfSBmcm9tICcuLi9fcHJpdmF0ZS9VbmlxdWVJZCc7XG5pbXBvcnQgeyBHZXRDbGFzc2VzIH0gZnJvbSAnLi4vLi4vdHlwZVV0aWxzJztcbmltcG9ydCB7IG1ha2VTdHlsZXMsIHVzZVRoZW1lIH0gZnJvbSAnLi4vLi4vc3R5bGVzJztcbmltcG9ydCB7XG4gIFBvcG92ZXIsXG4gIFBvcG92ZXJJdGVtLFxuICBQb3BvdmVyTGlzdCxcbiAgUG9wb3ZlclJlbmRlclByb3BzLFxufSBmcm9tICcuLi9Qb3BvdmVyJztcbmltcG9ydCB7IFRvb2x0aXAgfSBmcm9tICcuLi9Ub29sdGlwJztcbmltcG9ydCB7IGZhZGUgfSBmcm9tICdAbWF0ZXJpYWwtdWkvY29yZS9zdHlsZXMvY29sb3JNYW5pcHVsYXRvcic7XG5pbXBvcnQgJ2ZvY3VzLXZpc2libGUnO1xuXG5leHBvcnQgY29uc3QgQ29sb3JQaWNrZXJTdHlsZXNLZXkgPSAnQ2hyb21hQ29sb3JQaWNrZXInO1xuXG5leHBvcnQgY29uc3QgdXNlU3R5bGVzID0gbWFrZVN0eWxlcyhcbiAgKHRoZW1lKSA9PiAoe1xuICAgIHJvb3Q6IHt9LFxuICAgIGxhYmVsOiB7XG4gICAgICBhbGlnbkl0ZW1zOiAnY2VudGVyJyxcbiAgICAgIGNvbG9yOiB0aGVtZS5wYWxldHRlLmJsYWNrWzgwMF0sXG4gICAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgICBmb250U2l6ZTogdGhlbWUucHhUb1JlbSgxNCksXG4gICAgICBmb250V2VpZ2h0OiB0aGVtZS50eXBvZ3JhcGh5LmZvbnRXZWlnaHRCb2xkLFxuICAgICAgbWFyZ2luQm90dG9tOiB0aGVtZS5zcGFjaW5nKDEpLFxuICAgICAgJyY6ZW1wdHknOiB7XG4gICAgICAgIG1hcmdpbkJvdHRvbTogdGhlbWUuc3BhY2luZygwKSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBsYWJlbEljb246IHtcbiAgICAgIG1hcmdpbkxlZnQ6IHRoZW1lLnNwYWNpbmcoMC43NSksXG4gICAgICBjb2xvcjogdGhlbWUucGFsZXR0ZS5wcmltYXJ5Lm1haW4sXG4gICAgfSxcbiAgICBsYWJlbEljb25JbnZlcnNlOiB7XG4gICAgICBtaXhCbGVuZE1vZGU6ICdzY3JlZW4nLFxuICAgIH0sXG4gICAgbGFiZWxTZWNvbmRhcnk6IHtcbiAgICAgIGNvbG9yOiB0aGVtZS5wYWxldHRlLnRleHQuaGludCxcbiAgICAgIGZvbnRTaXplOiB0aGVtZS5weFRvUmVtKDExKSxcbiAgICAgIGRpc3BsYXk6ICdpbmxpbmUtYmxvY2snLFxuICAgICAgbWFyZ2luOiB0aGVtZS5zcGFjaW5nKDAsIDAuNzUpLFxuICAgIH0sXG4gICAgbGFiZWxJbnZlcnNlOiB7XG4gICAgICBjb2xvcjogdGhlbWUucGFsZXR0ZS5jb21tb24ud2hpdGUsXG4gICAgICAnJiRsYWJlbFNlY29uZGFyeSc6IHtcbiAgICAgICAgb3BhY2l0eTogMC45LFxuICAgICAgfSxcbiAgICB9LFxuICAgIGlucHV0OiB7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6ICdyZ2JhKDEzMiwgMTM3LCAxNjYsIDAuMTUpJyxcbiAgICAgIGJvcmRlcjogYDFweCBzb2xpZCB0cmFuc3BhcmVudGAsXG4gICAgICBib3JkZXJSYWRpdXM6IHRoZW1lLnB4VG9SZW0oNCksXG4gICAgICBjb2xvcjogdGhlbWUucGFsZXR0ZS50ZXh0LnByaW1hcnksXG4gICAgICBmb250RmFtaWx5OiB0aGVtZS50eXBvZ3JhcGh5LmZvbnRGYW1pbHksXG4gICAgICBmb250U2l6ZTogdGhlbWUucHhUb1JlbSgxNCksXG4gICAgICBtaW5XaWR0aDogdGhlbWUucHhUb1JlbSgxNzUpLFxuICAgICAgbGluZUhlaWdodDogMS4yNSxcbiAgICAgIHBhZGRpbmdCb3R0b206IHRoZW1lLnNwYWNpbmcoMSksXG4gICAgICBwYWRkaW5nTGVmdDogdGhlbWUuc3BhY2luZygxLjI1KSxcbiAgICAgIHBhZGRpbmdSaWdodDogdGhlbWUuc3BhY2luZygxLjI1KSxcbiAgICAgIHBhZGRpbmdUb3A6IHRoZW1lLnNwYWNpbmcoMSksXG4gICAgICB0cmFuc2l0aW9uOiAnYm9yZGVyIDAuMjVzIGVhc2UnLFxuICAgICAgJyY6Zm9jdXMnOiB7XG4gICAgICAgIG91dGxpbmU6ICdub25lJyxcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjUpJyxcbiAgICAgICAgYm9yZGVyOiBgMXB4IHNvbGlkIHJnYmEoMTMyLCAxMzcsIDE2NiwgMC40NSlgLFxuICAgICAgfSxcbiAgICAgICcmOmRpc2FibGVkJzoge1xuICAgICAgICBjdXJzb3I6ICdub3QtYWxsb3dlZCcsXG4gICAgICAgIG9wYWNpdHk6IDAuNjI1LFxuICAgICAgfSxcbiAgICAgICcmOnJlYWQtb25seSc6IHtcbiAgICAgICAgY3Vyc29yOiAnbm90LWFsbG93ZWQnLFxuICAgICAgICBvcGFjaXR5OiAwLjksXG4gICAgICAgICcmOmZvY3VzJzoge1xuICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJ3JnYmEoMTMyLCAxMzcsIDE2NiwgMC4xNSknLFxuICAgICAgICAgIGJvcmRlcjogYDFweCBzb2xpZCB0cmFuc3BhcmVudGAsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgJyY6Oi13ZWJraXQtaW5wdXQtcGxhY2Vob2xkZXInOiB7XG4gICAgICAgIGNvbG9yOiB0aGVtZS5wYWxldHRlLmJsYWNrWzQwMF0sXG4gICAgICB9LFxuICAgICAgJyY6Oi1tb3otcGxhY2Vob2xkZXInOiB7XG4gICAgICAgIGNvbG9yOiB0aGVtZS5wYWxldHRlLmJsYWNrWzQwMF0sXG4gICAgICB9LFxuICAgICAgJyY6LW1zLWlucHV0LXBsYWNlaG9sZGVyJzoge1xuICAgICAgICBjb2xvcjogdGhlbWUucGFsZXR0ZS5ibGFja1s0MDBdLFxuICAgICAgfSxcbiAgICAgICcmOi1tb3otcGxhY2Vob2xkZXInOiB7XG4gICAgICAgIGNvbG9yOiB0aGVtZS5wYWxldHRlLmJsYWNrWzQwMF0sXG4gICAgICB9LFxuICAgIH0sXG4gICAgaW5wdXRJbnZlcnNlOiB7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6ICdyZ2JhKDIzMCwgMjMxLCAyMzcsIDAuMSknLFxuICAgICAgY29sb3I6IHRoZW1lLnBhbGV0dGUuY29tbW9uLndoaXRlLFxuICAgICAgJyY6Zm9jdXMnOiB7XG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogJ3JnYmEoMjMwLCAyMzEsIDIzNywgMC4xKScsXG4gICAgICAgIGJvcmRlcjogYDFweCBzb2xpZCByZ2JhKDIzMCwgMjMxLCAyMzcsIDAuNTUpYCxcbiAgICAgIH0sXG4gICAgICAnJjpyZWFkLW9ubHknOiB7XG4gICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICcmOmZvY3VzJzoge1xuICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJ3JnYmEoMjMwLCAyMzEsIDIzNywgMC4xKScsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgJyY6Oi13ZWJraXQtaW5wdXQtcGxhY2Vob2xkZXInOiB7XG4gICAgICAgIGNvbG9yOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjgpJyxcbiAgICAgIH0sXG4gICAgICAnJjo6LW1vei1wbGFjZWhvbGRlcic6IHtcbiAgICAgICAgY29sb3I6ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuOCknLFxuICAgICAgfSxcbiAgICAgICcmOi1tcy1pbnB1dC1wbGFjZWhvbGRlcic6IHtcbiAgICAgICAgY29sb3I6ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuOCknLFxuICAgICAgfSxcbiAgICAgICcmOi1tb3otcGxhY2Vob2xkZXInOiB7XG4gICAgICAgIGNvbG9yOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjgpJyxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBoYXNUcmFpbGVyOiB7XG4gICAgICBtYXJnaW5Cb3R0b206IHRoZW1lLnNwYWNpbmcoMC41KSxcbiAgICB9LFxuICAgIGlucHV0Q29udGFpbmVyOiB7XG4gICAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJyxcbiAgICAgIHdpZHRoOiAnZml0LWNvbnRlbnQnLFxuICAgIH0sXG4gICAgaW5wdXRFcnJvcjoge1xuICAgICAgYmFja2dyb3VuZENvbG9yOiAncmdiYSgyMzAsIDIzMSwgMjM3LCAwLjEpJyxcbiAgICAgIGJvcmRlcjogYDFweCBzb2xpZCAke3RoZW1lLnBhbGV0dGUuZXJyb3IubWFpbn1gLFxuICAgICAgJyY6Zm9jdXMnOiB7XG4gICAgICAgIGJvcmRlcjogYDFweCBzb2xpZCAke3RoZW1lLnBhbGV0dGUuZXJyb3IubWFpbn1gLFxuICAgICAgfSxcbiAgICB9LFxuICAgIGlucHV0RXJyb3JJbnZlcnNlOiB7XG4gICAgICBib3JkZXI6IGAxcHggc29saWQgJHt0aGVtZS5wYWxldHRlLmVycm9yWzcwMF19YCxcbiAgICB9LFxuICAgIGlucHV0RnVsbFdpZHRoOiB7XG4gICAgICB3aWR0aDogJzEwMCUnLFxuICAgIH0sXG4gICAgdHJhaWxlck1lc3NhZ2U6IHtcbiAgICAgIG1hcmdpblRvcDogdGhlbWUuc3BhY2luZygwLjg3NSksXG4gICAgICBtYXJnaW5MZWZ0OiAwLFxuICAgIH0sXG4gICAgZXJyb3JNZXNzYWdlOiB7XG4gICAgICBjb2xvcjogdGhlbWUucGFsZXR0ZS5lcnJvci5tYWluLFxuICAgICAgZm9udFNpemU6IHRoZW1lLnR5cG9ncmFwaHkuY2FwdGlvbi5mb250U2l6ZSxcbiAgICAgIGZvbnRXZWlnaHQ6IHRoZW1lLnR5cG9ncmFwaHkuZm9udFdlaWdodEJvbGQsXG4gICAgfSxcbiAgICBlcnJvck1lc3NhZ2VJbnZlcnNlOiB7XG4gICAgICBtaXhCbGVuZE1vZGU6ICdjb2xvci1kb2RnZScsXG4gICAgfSxcbiAgICBoZWxwTWVzc2FnZToge1xuICAgICAgZm9udFNpemU6IHRoZW1lLnR5cG9ncmFwaHkuY2FwdGlvbi5mb250U2l6ZSxcbiAgICAgIGNvbG9yOiB0aGVtZS5wYWxldHRlLnRleHQuaGludCxcbiAgICB9LFxuICAgIGhlbHBNZXNzYWdlSW52ZXJzZToge1xuICAgICAgY29sb3I6IHRoZW1lLnBhbGV0dGUuY29tbW9uLndoaXRlLFxuICAgIH0sXG4gICAgdG9vbHRpcENvbnRhaW5lcjoge1xuICAgICAgZGlzcGxheTogJ2ZsZXgnLFxuICAgICAgb3V0bGluZTogJ25vbmUnLFxuICAgIH0sXG4gICAgdmFsdWVEaXNwbGF5OiB7XG4gICAgICBhbGlnbkl0ZW1zOiAnY2VudGVyJyxcbiAgICAgIGRpc3BsYXk6ICdmbGV4JyxcbiAgICAgIGhlaWdodDogdGhlbWUucHhUb1JlbSg1MCksXG4gICAgICBqdXN0aWZ5Q29udGVudDogJ2NlbnRlcicsXG4gICAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJyxcbiAgICAgICcmOjphZnRlcic6IHtcbiAgICAgICAgYmFja2dyb3VuZDogZmFkZSh0aGVtZS5wYWxldHRlLmNvbW1vbi5ibGFjaywgMC4yNSksXG4gICAgICAgIGJvdHRvbTogMCxcbiAgICAgICAgY29udGVudDogYCcnYCxcbiAgICAgICAgaGVpZ2h0OiB0aGVtZS5weFRvUmVtKDEpLFxuICAgICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICAgICAgd2lkdGg6ICcxMDAlJyxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBzd2F0Y2hCdXR0b246IHtcbiAgICAgIGhlaWdodDogdGhlbWUucHhUb1JlbSgyMCksXG4gICAgICB3aWR0aDogdGhlbWUucHhUb1JlbSgyMCksXG4gICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICAgIHJpZ2h0OiB0aGVtZS5zcGFjaW5nKDEpLFxuICAgICAgdG9wOiB0aGVtZS5zcGFjaW5nKDEpLFxuICAgIH0sXG4gICAgcG9wb3Zlcjoge1xuICAgICAgbWluV2lkdGg6ICd1bnNldCcsXG4gICAgfSxcbiAgICBwb3BvdmVyTGlzdDoge1xuICAgICAgZGlzcGxheTogJ2dyaWQnLFxuICAgICAgZ3JpZEdhcDogdGhlbWUuc3BhY2luZygxLjUpLFxuICAgICAgZ3JpZFRlbXBsYXRlQ29sdW1uczogYHJlcGVhdCg2LCAke3RoZW1lLnB4VG9SZW0oMjApfSlgLFxuICAgICAgbWFyZ2luOiB0aGVtZS5zcGFjaW5nKDIpLFxuICAgICAgcGFkZGluZzogMCxcbiAgICAgICcmICRjb2xvcic6IHtcbiAgICAgICAgbWFyZ2luOiAwLFxuICAgICAgfSxcbiAgICAgICcmOmZvY3VzJzoge1xuICAgICAgICBvdXRsaW5lOiAnbm9uZScsXG4gICAgICB9LFxuICAgICAgLy8gV2UgdXNlIHRoaXMgKyBhIHBvbHlmaWxsIGZvciBvbGRlciBicm93c2VyXG4gICAgICAvLyB0byBnZXQgYWNjZXNzaWJsZSBidXR0b25zIGZvciBrZXlib2FyZC11c2Vycy5cbiAgICAgIC8vIFVzZXJzIHdpbGwgbm90IHNlZSB0aGVzZSBzdHlsZXMgdW5sZXNzIHRoZXkgdXNlIHRoZWlyIGtleWJvYXJkXG4gICAgICAvLyB0byBmb2N1cyB0aGUgZWxlbWVudFxuICAgICAgJyY6Zm9jdXMuZm9jdXMtdmlzaWJsZSc6IHtcbiAgICAgICAgb3V0bGluZTogYHNvbGlkIDJweCAke3RoZW1lLnBhbGV0dGUucHJpbWFyeS5tYWlufWAsXG4gICAgICAgIG91dGxpbmVPZmZzZXQ6IHRoZW1lLnNwYWNpbmcoMSksXG4gICAgICB9LFxuICAgIH0sXG4gICAgcG9wb3Zlckl0ZW06IHtcbiAgICAgIHBhZGRpbmc6IDAsXG4gICAgfSxcbiAgICBjb2xvckJ1dHRvbjoge1xuICAgICAgdHJhbnNpdGlvbjogJ3RyYW5zZm9ybSAwLjI1cyBlYXNlLWluLW91dCcsXG4gICAgICB0cmFuc2Zvcm06ICdzY2FsZSgxKScsXG4gICAgICAnJjpob3ZlciwmOmZvY3VzJzoge1xuICAgICAgICB0cmFuc2Zvcm06ICdzY2FsZSgxLjIpJyxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBjb2xvcjoge1xuICAgICAgYm94U2hhZG93OiAnaW5zZXQgMCAwIDNweCByZ2IoMzggNDQgNTAgLyAyMCUpJyxcbiAgICAgIGRpc3BsYXk6ICdibG9jaycsXG4gICAgICBoZWlnaHQ6IHRoZW1lLnB4VG9SZW0oMjApLFxuICAgICAgd2lkdGg6IHRoZW1lLnB4VG9SZW0oMjApLFxuICAgIH0sXG4gICAgY29sb3JDaXJjbGU6IHtcbiAgICAgIGJvcmRlclJhZGl1czogdGhlbWUucHhUb1JlbSgxMCksXG4gICAgfSxcbiAgICBjb2xvclNxdWFyZToge1xuICAgICAgYm9yZGVyUmFkaXVzOiB0aGVtZS5weFRvUmVtKDQpLFxuICAgIH0sXG4gIH0pLFxuICB7IG5hbWU6IENvbG9yUGlja2VyU3R5bGVzS2V5IH1cbik7XG5cbmV4cG9ydCBjb25zdCBpc1ZhbGlkSGV4Q29sb3IgPSAoY29sb3I6IHN0cmluZykgPT4ge1xuICBjb25zdCBoZXhSZWdleCA9IG5ldyBSZWdFeHAoL14jWzAtOUEtRl17Nn0kL2kpO1xuICBjb25zdCBzaG9ydEhhbmRIZXhSZWdleCA9IG5ldyBSZWdFeHAoL14jKFswLTlBLUZdezN9KXsxLDJ9JC9pKTtcbiAgcmV0dXJuIGhleFJlZ2V4LnRlc3QoY29sb3IpIHx8IHNob3J0SGFuZEhleFJlZ2V4LnRlc3QoY29sb3IpO1xufTtcblxuZXhwb3J0IHR5cGUgQ29sb3JQaWNrZXJDbGFzc2VzID0gR2V0Q2xhc3Nlczx0eXBlb2YgdXNlU3R5bGVzPjtcblxuZXhwb3J0IGludGVyZmFjZSBDb2xvclBpY2tlclByb3BzXG4gIGV4dGVuZHMgT21pdDxSZWFjdC5Db21wb25lbnRQcm9wc1dpdGhvdXRSZWY8J2lucHV0Jz4sICdvbkNoYW5nZSc+IHtcbiAgY29sb3I/OiBCYXNlRm9ybUVsZW1lbnRbJ2NvbG9yJ107XG4gIGNvbG9yU3VnZ2VzdGlvbnM/OiBBcnJheTxzdHJpbmc+O1xuICBlcnJvck1lc3NhZ2U/OiBCYXNlRm9ybUVsZW1lbnRbJ2Vycm9yTWVzc2FnZSddO1xuICBmdWxsV2lkdGg/OiBib29sZWFuO1xuICBoYXNFcnJvcj86IEJhc2VGb3JtRWxlbWVudFsnaGFzRXJyb3InXTtcbiAgaGVscE1lc3NhZ2U/OiBCYXNlRm9ybUVsZW1lbnRbJ2hlbHBNZXNzYWdlJ107XG4gIGljb24/OiBSZWFjdC5Db21wb25lbnRUeXBlPFJlYWN0LlNWR1Byb3BzPFNWR1NWR0VsZW1lbnQ+PjtcbiAgaW52YWxpZENvbG9yVGV4dD86IHN0cmluZztcbiAgbGFiZWw/OiBCYXNlRm9ybUVsZW1lbnRbJ2xhYmVsJ107XG4gIG9uQ2hhbmdlPzogKGNvbG9yOiBzdHJpbmcpID0+IHZvaWQ7XG4gIHNlY29uZGFyeUxhYmVsPzogc3RyaW5nO1xuICB0b29sdGlwTWVzc2FnZT86IHN0cmluZztcbiAgdmFsdWU/OiBzdHJpbmc7XG4gIHZhcmlhbnQ/OiAnc3F1YXJlJyB8ICdjaXJjbGUnO1xufVxuXG5leHBvcnQgY29uc3QgQ29sb3JQaWNrZXIgPSBSZWFjdC5mb3J3YXJkUmVmPEhUTUxJbnB1dEVsZW1lbnQsIENvbG9yUGlja2VyUHJvcHM+KFxuICAoXG4gICAge1xuICAgICAgWydhcmlhLWxhYmVsJ106IGFyaWFMYWJlbCxcbiAgICAgIGNsYXNzTmFtZSxcbiAgICAgIGNvbG9yID0gJ2RlZmF1bHQnLFxuICAgICAgY29sb3JTdWdnZXN0aW9ucyxcbiAgICAgIGRpc2FibGVkLFxuICAgICAgZXJyb3JNZXNzYWdlLFxuICAgICAgZnVsbFdpZHRoLFxuICAgICAgaGFzRXJyb3IsXG4gICAgICBoZWxwTWVzc2FnZSxcbiAgICAgIGljb246IEljb24sXG4gICAgICBpZCxcbiAgICAgIGludmFsaWRDb2xvclRleHQgPSAnSW52YWxpZCBDb2xvcicsXG4gICAgICBsYWJlbCxcbiAgICAgIG5hbWUsXG4gICAgICBvbkNoYW5nZSxcbiAgICAgIHJlYWRPbmx5LFxuICAgICAgc2Vjb25kYXJ5TGFiZWwsXG4gICAgICB0b29sdGlwTWVzc2FnZSxcbiAgICAgIHZhbHVlID0gJycsXG4gICAgICB2YXJpYW50ID0gJ3NxdWFyZScsXG4gICAgICAuLi5yb290UHJvcHNcbiAgICB9LFxuICAgIHJlZlxuICApID0+IHtcbiAgICBjb25zdCBbY29sb3JWYWx1ZSwgc2V0Q29sb3JWYWx1ZV0gPSBSZWFjdC51c2VTdGF0ZTxzdHJpbmc+KHZhbHVlKTtcblxuICAgIGNvbnN0IGNsYXNzZXMgPSB1c2VTdHlsZXMoe30pO1xuICAgIGNvbnN0IHsgcGFsZXR0ZSB9ID0gdXNlVGhlbWUoKTtcblxuICAgIGNvbnN0IGNvbG9ycyA9IGNvbG9yU3VnZ2VzdGlvbnM/Lmxlbmd0aFxuICAgICAgPyBjb2xvclN1Z2dlc3Rpb25zXG4gICAgICA6IChbXG4gICAgICAgICAgcGFsZXR0ZS5yZWQubWFpbixcbiAgICAgICAgICBwYWxldHRlLnJlZC5saWdodCxcbiAgICAgICAgICBwYWxldHRlLm9yYW5nZS5tYWluLFxuICAgICAgICAgIHBhbGV0dGUub3JhbmdlLmxpZ2h0LFxuICAgICAgICAgIHBhbGV0dGUueWVsbG93Lm1haW4sXG4gICAgICAgICAgcGFsZXR0ZS55ZWxsb3cubGlnaHQsXG4gICAgICAgICAgcGFsZXR0ZS5ncmVlbi5tYWluLFxuICAgICAgICAgIHBhbGV0dGUuZ3JlZW4ubGlnaHQsXG4gICAgICAgICAgcGFsZXR0ZS5ibHVlLm1haW4sXG4gICAgICAgICAgcGFsZXR0ZS5ibHVlLmxpZ2h0LFxuICAgICAgICAgIHBhbGV0dGUucHVycGxlLm1haW4sXG4gICAgICAgICAgcGFsZXR0ZS5wdXJwbGUubGlnaHQsXG4gICAgICAgICAgcGFsZXR0ZS5ibGFjay5tYWluLFxuICAgICAgICAgIHBhbGV0dGUuYmxhY2subGlnaHQsXG4gICAgICAgICAgcGFsZXR0ZS5jb21tb24ud2hpdGUsXG4gICAgICAgIF0gYXMgQXJyYXk8c3RyaW5nPik7XG5cbiAgICBjb25zdCBpc1ZhbGlkQ29sb3IgPSBpc1ZhbGlkSGV4Q29sb3IoY29sb3JWYWx1ZSk7XG5cbiAgICBjb25zdCBbdW5pcXVlSWRdID0gUmVhY3QudXNlU3RhdGU8c3RyaW5nPihcbiAgICAgICgpID0+IGlkIHx8IG5hbWUgfHwgZ2VuZXJhdGVVbmlxdWVJZCgnQ29sb3JQaWNrZXItJylcbiAgICApO1xuXG4gICAgLy8gaXN0YW5idWwgaWdub3JlIGlmIC0gbm90IHRlc3RpbmcgZGV2IGVycm9yc1xuICAgIGlmICghbGFiZWwgJiYgIWFyaWFMYWJlbCAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50Jykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAnSWYgYSBcImxhYmVsXCIgaXMgbm90IHByb3ZpZGVkIHRvIENvbG9yUGlja2VyLCBwbGVhc2UgcHJvdmlkZSBcImFyaWEtbGFiZWxcIi4nXG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IENvbG9yID0gKHtcbiAgICAgIGNsYXNzTmFtZSxcbiAgICAgIGNvbG9yLFxuICAgIH06IHtcbiAgICAgIGNsYXNzTmFtZT86IHN0cmluZztcbiAgICAgIGNvbG9yOiBzdHJpbmc7XG4gICAgfSkgPT4gKFxuICAgICAgPHNwYW5cbiAgICAgICAgY2xhc3NOYW1lPXtjbHN4KFxuICAgICAgICAgIGNsYXNzTmFtZSxcbiAgICAgICAgICBjbGFzc2VzLmNvbG9yLFxuICAgICAgICAgIHZhcmlhbnQgPT09ICdjaXJjbGUnICYmIGNsYXNzZXMuY29sb3JDaXJjbGUsXG4gICAgICAgICAgdmFyaWFudCA9PT0gJ3NxdWFyZScgJiYgY2xhc3Nlcy5jb2xvclNxdWFyZVxuICAgICAgICApfVxuICAgICAgICBzdHlsZT17e1xuICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogaXNWYWxpZEhleENvbG9yKGNvbG9yKSA/IGNvbG9yIDogJyMwMDAwMDAnLFxuICAgICAgICB9fVxuICAgICAgLz5cbiAgICApO1xuXG4gICAgY29uc3QgaGFuZGxlQ2hhbmdlID0gKGNvbG9yOiBzdHJpbmcpID0+IHtcbiAgICAgIHNldENvbG9yVmFsdWUoY29sb3IpO1xuICAgICAgLy8gaXN0YW5idWwgaWdub3JlIG5leHQgLSBub3QgYSBncmVhdCB3YXkgdG8gdGVzdCBub3QgY2FsbGluZyBvbkNoYW5nZVxuICAgICAgb25DaGFuZ2U/Lihjb2xvcik7XG4gICAgfTtcblxuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT17Y2xzeChjbGFzc2VzLnJvb3QsIGNsYXNzTmFtZSl9PlxuICAgICAgICB7bGFiZWwgJiYgKFxuICAgICAgICAgIDxsYWJlbFxuICAgICAgICAgICAgY2xhc3NOYW1lPXtjbHN4KFxuICAgICAgICAgICAgICBjbGFzc2VzLmxhYmVsLFxuICAgICAgICAgICAgICBjb2xvciA9PT0gJ2ludmVyc2UnICYmIGNsYXNzZXMubGFiZWxJbnZlcnNlXG4gICAgICAgICAgICApfVxuICAgICAgICAgICAgaHRtbEZvcj17dW5pcXVlSWR9XG4gICAgICAgICAgPlxuICAgICAgICAgICAge2xhYmVsfVxuICAgICAgICAgICAgeyEhSWNvbiAmJiB0b29sdGlwTWVzc2FnZSAmJiAoXG4gICAgICAgICAgICAgIDxUb29sdGlwIHRpdGxlPXt0b29sdGlwTWVzc2FnZX0+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPXtjbGFzc2VzLnRvb2x0aXBDb250YWluZXJ9PlxuICAgICAgICAgICAgICAgICAgPEljb25cbiAgICAgICAgICAgICAgICAgICAgYXJpYS1oaWRkZW5cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbHN4KFxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzZXMubGFiZWxJY29uLFxuICAgICAgICAgICAgICAgICAgICAgIGNvbG9yID09PSAnaW52ZXJzZScgJiYgY2xhc3Nlcy5sYWJlbEljb25JbnZlcnNlXG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIGhlaWdodD17MTZ9XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoPXsxNn1cbiAgICAgICAgICAgICAgICAgICAgcm9sZT1cImltZ1wiXG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIHtzZWNvbmRhcnlMYWJlbCAmJiAoXG4gICAgICAgICAgICAgIDxzcGFuXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbHN4KFxuICAgICAgICAgICAgICAgICAgY2xhc3Nlcy5sYWJlbFNlY29uZGFyeSxcbiAgICAgICAgICAgICAgICAgIGNvbG9yID09PSAnaW52ZXJzZScgJiYgY2xhc3Nlcy5sYWJlbEludmVyc2VcbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAge3NlY29uZGFyeUxhYmVsfVxuICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgICl9XG4gICAgICAgIDxkaXZcbiAgICAgICAgICBjbGFzc05hbWU9e2Nsc3goXG4gICAgICAgICAgICBjbGFzc2VzLmlucHV0Q29udGFpbmVyLFxuICAgICAgICAgICAgZnVsbFdpZHRoICYmIGNsYXNzZXMuaW5wdXRGdWxsV2lkdGhcbiAgICAgICAgICApfVxuICAgICAgICA+XG4gICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICBhcmlhLWRlc2NyaWJlZGJ5PXtidWlsZERlc2NyaWJlZEJ5KHtcbiAgICAgICAgICAgICAgaGFzRXJyb3IsXG4gICAgICAgICAgICAgIGhhc0hlbHBNZXNzYWdlOiAhIWhlbHBNZXNzYWdlLFxuICAgICAgICAgICAgICB1bmlxdWVJZCxcbiAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgYXJpYS1sYWJlbD17YXJpYUxhYmVsfVxuICAgICAgICAgICAgY2xhc3NOYW1lPXtjbHN4KFxuICAgICAgICAgICAgICBjbGFzc2VzLmlucHV0LFxuICAgICAgICAgICAgICBmdWxsV2lkdGggJiYgY2xhc3Nlcy5pbnB1dEZ1bGxXaWR0aCxcbiAgICAgICAgICAgICAgaGFzRXJyb3IgJiYgY2xhc3Nlcy5pbnB1dEVycm9yLFxuICAgICAgICAgICAgICBoYXNFcnJvciAmJiBjb2xvciA9PT0gJ2ludmVyc2UnICYmIGNsYXNzZXMuaW5wdXRFcnJvckludmVyc2UsXG4gICAgICAgICAgICAgIHsgW2NsYXNzZXMuaW5wdXRJbnZlcnNlXTogY29sb3IgPT09ICdpbnZlcnNlJyB9XG4gICAgICAgICAgICApfVxuICAgICAgICAgICAgZGlzYWJsZWQ9e2Rpc2FibGVkfVxuICAgICAgICAgICAgaWQ9e3VuaXF1ZUlkfVxuICAgICAgICAgICAgbmFtZT17bmFtZX1cbiAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gaGFuZGxlQ2hhbmdlKGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgIHJlYWRPbmx5PXtyZWFkT25seX1cbiAgICAgICAgICAgIHJlZj17cmVmfVxuICAgICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgICAgdmFsdWU9e2NvbG9yVmFsdWV9XG4gICAgICAgICAgICB7Li4ucm9vdFByb3BzfVxuICAgICAgICAgIC8+XG5cbiAgICAgICAgICA8UG9wb3ZlclxuICAgICAgICAgICAgYW5jaG9yRWxlbWVudD17XG4gICAgICAgICAgICAgIDxCdXR0b25VbnN0eWxlZFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y2xhc3Nlcy5zd2F0Y2hCdXR0b259XG4gICAgICAgICAgICAgICAgYXJpYS1sYWJlbD1cIlBpY2sgY29sb3JcIlxuICAgICAgICAgICAgICAgIGRpc2FibGVkPXtkaXNhYmxlZCB8fCByZWFkT25seX1cbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxDb2xvciBjb2xvcj17Y29sb3JWYWx1ZX0gLz5cbiAgICAgICAgICAgICAgPC9CdXR0b25VbnN0eWxlZD5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFyaWEtbGFiZWw9XCJDb2xvciBQaWNrZXJcIlxuICAgICAgICAgICAgY2xhc3NOYW1lPXtjbGFzc2VzLnBvcG92ZXJ9XG4gICAgICAgICAgPlxuICAgICAgICAgICAgeyh7IHBvcG92ZXIgfTogUG9wb3ZlclJlbmRlclByb3BzKSA9PiAoXG4gICAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbGFzc2VzLnZhbHVlRGlzcGxheX1cbiAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogaXNWYWxpZENvbG9yXG4gICAgICAgICAgICAgICAgICAgICAgPyB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgIDogcGFsZXR0ZS5jb21tb24uYmxhY2ssXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiBpc1ZhbGlkSGV4Q29sb3IodmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgPyBwYWxldHRlLmdldENvbnRyYXN0VGV4dCh2YWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgICA6IHBhbGV0dGUuY29tbW9uLndoaXRlLFxuICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICB7aXNWYWxpZENvbG9yID8gdmFsdWUgOiBpbnZhbGlkQ29sb3JUZXh0fVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgPFBvcG92ZXJMaXN0IGNsYXNzTmFtZT17Y2xhc3Nlcy5wb3BvdmVyTGlzdH0+XG4gICAgICAgICAgICAgICAgICB7Y29sb3JzLm1hcCgoY29sb3I6IHN0cmluZywgaW5kZXg6IG51bWJlcikgPT4gKFxuICAgICAgICAgICAgICAgICAgICA8UG9wb3Zlckl0ZW0gY2xhc3NOYW1lPXtjbGFzc2VzLnBvcG92ZXJJdGVtfSBrZXk9e2luZGV4fT5cbiAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uVW5zdHlsZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyaWEtbGFiZWw9e2BQaWNrICR7Y29sb3J9YH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y2xhc3Nlcy5jb2xvckJ1dHRvbn1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaXN0YW5idWwgaWdub3JlIG5leHQgLSBub3QgYSBncmVhdCB3YXkgdG8gdGVzdCBub3QgY2FsbGluZyBvbkNoYW5nZVxuICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVDaGFuZ2U/Lihjb2xvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHBvcG92ZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8Q29sb3IgY29sb3I9e2NvbG9yfSAvPlxuICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uVW5zdHlsZWQ+XG4gICAgICAgICAgICAgICAgICAgIDwvUG9wb3Zlckl0ZW0+XG4gICAgICAgICAgICAgICAgICApKX1cbiAgICAgICAgICAgICAgICA8L1BvcG92ZXJMaXN0PlxuICAgICAgICAgICAgICA8Lz5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgPC9Qb3BvdmVyPlxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICB7aGVscE1lc3NhZ2UgJiYgKFxuICAgICAgICAgIDxGb3JtSGVscE1lc3NhZ2VcbiAgICAgICAgICAgIGNvbG9yPXtjb2xvcn1cbiAgICAgICAgICAgIGNsYXNzTmFtZT17Y2xzeChcbiAgICAgICAgICAgICAgY2xhc3Nlcy50cmFpbGVyTWVzc2FnZSxcbiAgICAgICAgICAgICAgY2xhc3Nlcy5oZWxwTWVzc2FnZSxcbiAgICAgICAgICAgICAgY29sb3IgPT09ICdpbnZlcnNlJyAmJiBjbGFzc2VzLmhlbHBNZXNzYWdlSW52ZXJzZVxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIGRlc2NyaWJlZEJ5SWQ9e2hlbHBGb3IodW5pcXVlSWQpfVxuICAgICAgICAgICAgcm9vdEVsZW1lbnRJZD17dW5pcXVlSWR9XG4gICAgICAgICAgPlxuICAgICAgICAgICAge2hlbHBNZXNzYWdlfVxuICAgICAgICAgIDwvRm9ybUhlbHBNZXNzYWdlPlxuICAgICAgICApfVxuICAgICAgICB7aGFzRXJyb3IgJiYgZXJyb3JNZXNzYWdlICYmIChcbiAgICAgICAgICA8Rm9ybUVycm9yTWVzc2FnZVxuICAgICAgICAgICAgY2xhc3NOYW1lPXtjbHN4KGNsYXNzZXMudHJhaWxlck1lc3NhZ2UpfVxuICAgICAgICAgICAgY29sb3I9e2NvbG9yfVxuICAgICAgICAgICAgZGVzY3JpYmVkQnlJZD17ZXJyb3JGb3IodW5pcXVlSWQpfVxuICAgICAgICAgICAgcm9vdEVsZW1lbnRJZD17dW5pcXVlSWR9XG4gICAgICAgICAgPlxuICAgICAgICAgICAge2Vycm9yTWVzc2FnZX1cbiAgICAgICAgICA8L0Zvcm1FcnJvck1lc3NhZ2U+XG4gICAgICAgICl9XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG4pO1xuIl19