var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};
import clsx from 'clsx';
import * as React from 'react';
import { makeStyles } from '../../styles';
import { AvatarSizeContext } from './AvatarSizeContext';
export var AvatarStylesKey = 'ChromaAvatar';
export var useStyles = makeStyles(function (theme) { return ({
    root: {
        alignItems: 'center',
        backgroundColor: theme.palette.primary.main,
        border: "".concat(theme.pxToRem(1), " solid ").concat(theme.palette.black[100]),
        borderRadius: 9999,
        color: theme.palette.common.white,
        display: 'inline-flex',
        flexShrink: 0,
        justifyContent: 'center',
        outline: 'none',
        position: 'relative',
        transition: 'opacity 0.25s ease, border 0.25s ease',
        userSelect: 'none',
        '&:focus': {
            opacity: 0.85,
            border: "".concat(theme.pxToRem(2), " solid ").concat(theme.palette.black[700]),
        },
    },
    size0: {
        fontSize: theme.typography.caption.fontSize,
        fontWeight: theme.typography.fontWeightBold,
        width: theme.pxToRem(22),
        height: theme.pxToRem(22),
    },
    size1: {
        fontSize: theme.typography.body1.fontSize,
        width: theme.pxToRem(32),
        height: theme.pxToRem(32),
    },
    size2: {
        fontSize: theme.typography.h5.fontSize,
        width: theme.pxToRem(42),
        height: theme.pxToRem(42),
    },
    img: {
        width: '100%',
        height: '100%',
        objectFit: 'cover',
        maxWidth: '100%',
        verticalAlign: 'middle',
        borderRadius: 9999,
    },
    defaultSrc: {
        fill: theme.palette.common.white,
    },
    clickable: {
        cursor: 'pointer',
        '&:hover': {
            opacity: 0.85,
            border: "".concat(theme.pxToRem(1), " solid ").concat(theme.palette.black[700]),
        },
    },
}); }, { name: AvatarStylesKey });
var getInitials = function (name) {
    var _a;
    if (!name) {
        return '';
    }
    var firstName = name.split(' ')[0];
    return (_a = firstName === null || firstName === void 0 ? void 0 : firstName.charAt(0)) === null || _a === void 0 ? void 0 : _a.toUpperCase();
};
export var Avatar = React.forwardRef(function (_a, ref) {
    var _b;
    var className = _a.className, children = _a.children, _c = _a.name, name = _c === void 0 ? '' : _c, onClick = _a.onClick, _d = _a.size, size = _d === void 0 ? 1 : _d, src = _a.src, _e = _a.useDefaultSrc, useDefaultSrc = _e === void 0 ? false : _e, bubbleError = _a.onError, rootProps = __rest(_a, ["className", "children", "name", "onClick", "size", "src", "useDefaultSrc", "onError"]);
    var classes = useStyles({});
    var _f = React.useState(false), error = _f[0], setError = _f[1];
    var onError = function (error) {
        setError(true);
        bubbleError && bubbleError(error);
    };
    React.useEffect(function () {
        setError(false);
    }, [src]);
    // We need to be *super* careful to not display any self identifying information
    // (name or image src) if "useDefaultSrc" is provided.  This will ensure
    // that our "masked mode" when dealing with healthcare information is respected
    return (
    // We conditionally add the role if `onClick` is provided
    // eslint-disable-next-line jsx-a11y/no-static-element-interactions
    React.createElement("div", __assign({ ref: ref, className: clsx(classes.root, (_b = {},
            _b[classes.size0] = size === 0,
            _b[classes.size1] = size === 1,
            _b[classes.size2] = size === 2,
            _b), onClick && classes.clickable, className), onClick: onClick, "aria-label": !src && name && !useDefaultSrc ? name : undefined, role: onClick ? 'button' : undefined, tabIndex: onClick ? 0 : undefined }, rootProps),
        (error || !src) && !useDefaultSrc ? getInitials(name) : null,
        src && !error && !useDefaultSrc && (React.createElement("img", { onError: onError, className: classes.img, src: src, alt: name })),
        useDefaultSrc && (React.createElement("svg", { className: clsx(classes.img, classes.defaultSrc), fill: "currentColor", viewBox: "0 0 128 128", role: "img" },
            React.createElement("g", null,
                React.createElement("path", { d: "M103,102.1388 C93.094,111.92 79.3504,118 64.1638,118 C48.8056,118 34.9294,111.768 25,101.7892 L25,95.2 C25,86.8096 31.981,80 40.6,80 L87.4,80 C96.019,80 103,86.8096 103,95.2 L103,102.1388 Z" }),
                React.createElement("path", { d: "M63.9961647,24 C51.2938136,24 41,34.2938136 41,46.9961647 C41,59.7061864 51.2938136,70 63.9961647,70 C76.6985159,70 87,59.7061864 87,46.9961647 C87,34.2938136 76.6985159,24 63.9961647,24" })))),
        children && (React.createElement(AvatarSizeContext.Provider, { value: { size: size } }, children))));
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXZhdGFyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvQXZhdGFyL0F2YXRhci50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLE9BQU8sSUFBSSxNQUFNLE1BQU0sQ0FBQztBQUN4QixPQUFPLEtBQUssS0FBSyxNQUFNLE9BQU8sQ0FBQztBQUMvQixPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBRTFDLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBRXhELE1BQU0sQ0FBQyxJQUFNLGVBQWUsR0FBRyxjQUFjLENBQUM7QUFFOUMsTUFBTSxDQUFDLElBQU0sU0FBUyxHQUFHLFVBQVUsQ0FDakMsVUFBQyxLQUFLLElBQUssT0FBQSxDQUFDO0lBQ1YsSUFBSSxFQUFFO1FBQ0osVUFBVSxFQUFFLFFBQVE7UUFDcEIsZUFBZSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUk7UUFDM0MsTUFBTSxFQUFFLFVBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsb0JBQVUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUU7UUFDL0QsWUFBWSxFQUFFLElBQUk7UUFDbEIsS0FBSyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUs7UUFDakMsT0FBTyxFQUFFLGFBQWE7UUFDdEIsVUFBVSxFQUFFLENBQUM7UUFDYixjQUFjLEVBQUUsUUFBUTtRQUN4QixPQUFPLEVBQUUsTUFBTTtRQUNmLFFBQVEsRUFBRSxVQUFVO1FBQ3BCLFVBQVUsRUFBRSx1Q0FBdUM7UUFDbkQsVUFBVSxFQUFFLE1BQU07UUFDbEIsU0FBUyxFQUFFO1lBQ1QsT0FBTyxFQUFFLElBQUk7WUFDYixNQUFNLEVBQUUsVUFBRyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMs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QUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLElBQUksR0FBSSxDQUN2RTtRQUNBLGFBQWEsSUFBSSxDQUNoQiw2QkFDRSxTQUFTLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsT0FBTyxDQUFDLFVBQVUsQ0FBQyxFQUNoRCxJQUFJLEVBQUMsY0FBYyxFQUNuQixPQUFPLEVBQUMsYUFBYSxFQUNyQixJQUFJLEVBQUMsS0FBSztZQUVWO2dCQUNFLDhCQUFNLENBQUMsRUFBQywrTEFBK0wsR0FBRztnQkFDMU0sOEJBQU0sQ0FBQyxFQUFDLDRMQUE0TCxHQUFHLENBQ3JNLENBQ0EsQ0FDUDtRQUNBLFFBQVEsSUFBSSxDQUNYLG9CQUFDLGlCQUFpQixDQUFDLFFBQVEsSUFBQyxLQUFLLEVBQUUsRUFBRSxJQUFJLE1BQUEsRUFBRSxJQUN4QyxRQUFRLENBQ2tCLENBQzlCLENBQ0csQ0FDUCxDQUFDO0FBQ0osQ0FBQyxDQUNGLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY2xzeCBmcm9tICdjbHN4JztcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IG1ha2VTdHlsZXMgfSBmcm9tICcuLi8uLi9zdHlsZXMnO1xuaW1wb3J0IHsgR2V0Q2xhc3NlcyB9IGZyb20gJy4uLy4uL3R5cGVVdGlscyc7XG5pbXBvcnQgeyBBdmF0YXJTaXplQ29udGV4dCB9IGZyb20gJy4vQXZhdGFyU2l6ZUNvbnRleHQnO1xuXG5leHBvcnQgY29uc3QgQXZhdGFyU3R5bGVzS2V5ID0gJ0Nocm9tYUF2YXRhcic7XG5cbmV4cG9ydCBjb25zdCB1c2VTdHlsZXMgPSBtYWtlU3R5bGVzKFxuICAodGhlbWUpID0+ICh7XG4gICAgcm9vdDoge1xuICAgICAgYWxpZ25JdGVtczogJ2NlbnRlcicsXG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHRoZW1lLnBhbGV0dGUucHJpbWFyeS5tYWluLFxuICAgICAgYm9yZGVyOiBgJHt0aGVtZS5weFRvUmVtKDEpfSBzb2xpZCAke3RoZW1lLnBhbGV0dGUuYmxhY2tbMTAwXX1gLFxuICAgICAgYm9yZGVyUmFkaXVzOiA5OTk5LFxuICAgICAgY29sb3I6IHRoZW1lLnBhbGV0dGUuY29tbW9uLndoaXRlLFxuICAgICAgZGlzcGxheTogJ2lubGluZS1mbGV4JyxcbiAgICAgIGZsZXhTaHJpbms6IDAsXG4gICAgICBqdXN0aWZ5Q29udGVudDogJ2NlbnRlcicsXG4gICAgICBvdXRsaW5lOiAnbm9uZScsXG4gICAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJyxcbiAgICAgIHRyYW5zaXRpb246ICdvcGFjaXR5IDAuMjVzIGVhc2UsIGJvcmRlciAwLjI1cyBlYXNlJyxcbiAgICAgIHVzZXJTZWxlY3Q6ICdub25lJyxcbiAgICAgICcmOmZvY3VzJzoge1xuICAgICAgICBvcGFjaXR5OiAwLjg1LFxuICAgICAgICBib3JkZXI6IGAke3RoZW1lLnB4VG9SZW0oMil9IHNvbGlkICR7dGhlbWUucGFsZXR0ZS5ibGFja1s3MDBdfWAsXG4gICAgICB9LFxuICAgIH0sXG4gICAgc2l6ZTA6IHtcbiAgICAgIGZvbnRTaXplOiB0aGVtZS50eXBvZ3JhcGh5LmNhcHRpb24uZm9udFNpemUsXG4gICAgICBmb250V2VpZ2h0OiB0aGVtZS50eXBvZ3JhcGh5LmZvbnRXZWlnaHRCb2xkLFxuICAgICAgd2lkdGg6IHRoZW1lLnB4VG9SZW0oMjIpLFxuICAgICAgaGVpZ2h0OiB0aGVtZS5weFRvUmVtKDIyKSxcbiAgICB9LFxuICAgIHNpemUxOiB7XG4gICAgICBmb250U2l6ZTogdGhlbWUudHlwb2dyYXBoeS5ib2R5MS5mb250U2l6ZSxcbiAgICAgIHdpZHRoOiB0aGVtZS5weFRvUmVtKDMyKSxcbiAgICAgIGhlaWdodDogdGhlbWUucHhUb1JlbSgzMiksXG4gICAgfSxcbiAgICBzaXplMjoge1xuICAgICAgZm9udFNpemU6IHRoZW1lLnR5cG9ncmFwaHkuaDUuZm9udFNpemUsXG4gICAgICB3aWR0aDogdGhlbWUucHhUb1JlbSg0MiksXG4gICAgICBoZWlnaHQ6IHRoZW1lLnB4VG9SZW0oNDIpLFxuICAgIH0sXG4gICAgaW1nOiB7XG4gICAgICB3aWR0aDogJzEwMCUnLFxuICAgICAgaGVpZ2h0OiAnMTAwJScsXG4gICAgICBvYmplY3RGaXQ6ICdjb3ZlcicsXG4gICAgICBtYXhXaWR0aDogJzEwMCUnLFxuICAgICAgdmVydGljYWxBbGlnbjogJ21pZGRsZScsXG4gICAgICBib3JkZXJSYWRpdXM6IDk5OTksXG4gICAgfSxcbiAgICBkZWZhdWx0U3JjOiB7XG4gICAgICBmaWxsOiB0aGVtZS5wYWxldHRlLmNvbW1vbi53aGl0ZSxcbiAgICB9LFxuICAgIGNsaWNrYWJsZToge1xuICAgICAgY3Vyc29yOiAncG9pbnRlcicsXG4gICAgICAnJjpob3Zlcic6IHtcbiAgICAgICAgb3BhY2l0eTogMC44NSxcbiAgICAgICAgYm9yZGVyOiBgJHt0aGVtZS5weFRvUmVtKDEpfSBzb2xpZCAke3RoZW1lLnBhbGV0dGUuYmxhY2tbNzAwXX1gLFxuICAgICAgfSxcbiAgICB9LFxuICB9KSxcbiAgeyBuYW1lOiBBdmF0YXJTdHlsZXNLZXkgfVxuKTtcblxuZXhwb3J0IHR5cGUgQXZhdGFyQ2xhc3NlcyA9IEdldENsYXNzZXM8dHlwZW9mIHVzZVN0eWxlcz47XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXZhdGFyUHJvcHMgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnRQcm9wc1dpdGhvdXRSZWY8J2Rpdic+IHtcbiAgY2hpbGRyZW4/OiBSZWFjdC5SZWFjdE5vZGU7XG4gIG5hbWU6IHN0cmluZztcbiAgc2l6ZT86IDAgfCAxIHwgMjtcbiAgc3JjPzogc3RyaW5nO1xuICB1c2VEZWZhdWx0U3JjPzogYm9vbGVhbjtcbiAgb25FcnJvcj86IFJlYWN0LlJlYWN0RXZlbnRIYW5kbGVyPEhUTUxJbWFnZUVsZW1lbnQ+O1xufVxuXG5jb25zdCBnZXRJbml0aWFscyA9IChuYW1lOiBzdHJpbmcpID0+IHtcbiAgaWYgKCFuYW1lKSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG5cbiAgY29uc3QgW2ZpcnN0TmFtZV0gPSBuYW1lLnNwbGl0KCcgJyk7XG5cbiAgcmV0dXJuIGZpcnN0TmFtZT8uY2hhckF0KDApPy50b1VwcGVyQ2FzZSgpO1xufTtcblxuZXhwb3J0IGNvbnN0IEF2YXRhciA9IFJlYWN0LmZvcndhcmRSZWY8SFRNTERpdkVsZW1lbnQsIEF2YXRhclByb3BzPihcbiAgKFxuICAgIHtcbiAgICAgIGNsYXNzTmFtZSxcbiAgICAgIGNoaWxkcmVuLFxuICAgICAgbmFtZSA9ICcnLFxuICAgICAgb25DbGljayxcbiAgICAgIHNpemUgPSAxLFxuICAgICAgc3JjLFxuICAgICAgdXNlRGVmYXVsdFNyYyA9IGZhbHNlLFxuICAgICAgb25FcnJvcjogYnViYmxlRXJyb3IsXG4gICAgICAuLi5yb290UHJvcHNcbiAgICB9LFxuICAgIHJlZlxuICApID0+IHtcbiAgICBjb25zdCBjbGFzc2VzID0gdXNlU3R5bGVzKHt9KTtcblxuICAgIGNvbnN0IFtlcnJvciwgc2V0RXJyb3JdID0gUmVhY3QudXNlU3RhdGUoZmFsc2UpO1xuXG4gICAgY29uc3Qgb25FcnJvcjogUmVhY3QuUmVhY3RFdmVudEhhbmRsZXI8SFRNTEltYWdlRWxlbWVudD4gPSAoZXJyb3IpID0+IHtcbiAgICAgIHNldEVycm9yKHRydWUpO1xuICAgICAgYnViYmxlRXJyb3IgJiYgYnViYmxlRXJyb3IoZXJyb3IpO1xuICAgIH07XG5cbiAgICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgc2V0RXJyb3IoZmFsc2UpO1xuICAgIH0sIFtzcmNdKTtcblxuICAgIC8vIFdlIG5lZWQgdG8gYmUgKnN1cGVyKiBjYXJlZnVsIHRvIG5vdCBkaXNwbGF5IGFueSBzZWxmIGlkZW50aWZ5aW5nIGluZm9ybWF0aW9uXG4gICAgLy8gKG5hbWUgb3IgaW1hZ2Ugc3JjKSBpZiBcInVzZURlZmF1bHRTcmNcIiBpcyBwcm92aWRlZC4gIFRoaXMgd2lsbCBlbnN1cmVcbiAgICAvLyB0aGF0IG91ciBcIm1hc2tlZCBtb2RlXCIgd2hlbiBkZWFsaW5nIHdpdGggaGVhbHRoY2FyZSBpbmZvcm1hdGlvbiBpcyByZXNwZWN0ZWRcbiAgICByZXR1cm4gKFxuICAgICAgLy8gV2UgY29uZGl0aW9uYWxseSBhZGQgdGhlIHJvbGUgaWYgYG9uQ2xpY2tgIGlzIHByb3ZpZGVkXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUganN4LWExMXkvbm8tc3RhdGljLWVsZW1lbnQtaW50ZXJhY3Rpb25zXG4gICAgICA8ZGl2XG4gICAgICAgIHJlZj17cmVmfVxuICAgICAgICBjbGFzc05hbWU9e2Nsc3goXG4gICAgICAgICAgY2xhc3Nlcy5yb290LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIFtjbGFzc2VzLnNpemUwXTogc2l6ZSA9PT0gMCxcbiAgICAgICAgICAgIFtjbGFzc2VzLnNpemUxXTogc2l6ZSA9PT0gMSxcbiAgICAgICAgICAgIFtjbGFzc2VzLnNpemUyXTogc2l6ZSA9PT0gMixcbiAgICAgICAgICB9LFxuICAgICAgICAgIG9uQ2xpY2sgJiYgY2xhc3Nlcy5jbGlja2FibGUsXG4gICAgICAgICAgY2xhc3NOYW1lXG4gICAgICAgICl9XG4gICAgICAgIG9uQ2xpY2s9e29uQ2xpY2t9XG4gICAgICAgIGFyaWEtbGFiZWw9eyFzcmMgJiYgbmFtZSAmJiAhdXNlRGVmYXVsdFNyYyA/IG5hbWUgOiB1bmRlZmluZWR9XG4gICAgICAgIHJvbGU9e29uQ2xpY2sgPyAnYnV0dG9uJyA6IHVuZGVmaW5lZH1cbiAgICAgICAgdGFiSW5kZXg9e29uQ2xpY2sgPyAwIDogdW5kZWZpbmVkfVxuICAgICAgICB7Li4ucm9vdFByb3BzfVxuICAgICAgPlxuICAgICAgICB7KGVycm9yIHx8ICFzcmMpICYmICF1c2VEZWZhdWx0U3JjID8gZ2V0SW5pdGlhbHMobmFtZSkgOiBudWxsfVxuICAgICAgICB7c3JjICYmICFlcnJvciAmJiAhdXNlRGVmYXVsdFNyYyAmJiAoXG4gICAgICAgICAgPGltZyBvbkVycm9yPXtvbkVycm9yfSBjbGFzc05hbWU9e2NsYXNzZXMuaW1nfSBzcmM9e3NyY30gYWx0PXtuYW1lfSAvPlxuICAgICAgICApfVxuICAgICAgICB7dXNlRGVmYXVsdFNyYyAmJiAoXG4gICAgICAgICAgPHN2Z1xuICAgICAgICAgICAgY2xhc3NOYW1lPXtjbHN4KGNsYXNzZXMuaW1nLCBjbGFzc2VzLmRlZmF1bHRTcmMpfVxuICAgICAgICAgICAgZmlsbD1cImN1cnJlbnRDb2xvclwiXG4gICAgICAgICAgICB2aWV3Qm94PVwiMCAwIDEyOCAxMjhcIlxuICAgICAgICAgICAgcm9sZT1cImltZ1wiXG4gICAgICAgICAgPlxuICAgICAgICAgICAgPGc+XG4gICAgICAgICAgICAgIDxwYXRoIGQ9XCJNMTAzLDEwMi4xMzg4IEM5My4wOTQsMTExLjkyIDc5LjM1MDQsMTE4IDY0LjE2MzgsMTE4IEM0OC44MDU2LDExOCAzNC45Mjk0LDExMS43NjggMjUsMTAxLjc4OTIgTDI1LDk1LjIgQzI1LDg2LjgwOTYgMzEuOTgxLDgwIDQwLjYsODAgTDg3LjQsODAgQzk2LjAxOSw4MCAxMDMsODYuODA5NiAxMDMsOTUuMiBMMTAzLDEwMi4xMzg4IFpcIiAvPlxuICAgICAgICAgICAgICA8cGF0aCBkPVwiTTYzLjk5NjE2NDcsMjQgQzUxLjI5MzgxMzYsMjQgNDEsMzQuMjkzODEzNiA0MSw0Ni45OTYxNjQ3IEM0MSw1OS43MDYxODY0IDUxLjI5MzgxMzYsNzAgNjMuOTk2MTY0Nyw3MCBDNzYuNjk4NTE1OSw3MCA4Nyw1OS43MDYxODY0IDg3LDQ2Ljk5NjE2NDcgQzg3LDM0LjI5MzgxMzYgNzYuNjk4NTE1OSwyNCA2My45OTYxNjQ3LDI0XCIgLz5cbiAgICAgICAgICAgIDwvZz5cbiAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgKX1cbiAgICAgICAge2NoaWxkcmVuICYmIChcbiAgICAgICAgICA8QXZhdGFyU2l6ZUNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e3sgc2l6ZSB9fT5cbiAgICAgICAgICAgIHtjaGlsZHJlbn1cbiAgICAgICAgICA8L0F2YXRhclNpemVDb250ZXh0LlByb3ZpZGVyPlxuICAgICAgICApfVxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxuKTtcbiJdfQ==