var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};
import { makeStyles } from '../../styles';
import { motion, AnimatePresence, useReducedMotion } from 'framer-motion';
import { Text } from '../Text';
import clsx from 'clsx';
import * as React from 'react';
import { IconButton } from '../IconButton';
import { X } from '@lifeomic/chromicons';
export var SnackbarStylesKey = 'ChromaSnackbar';
export var useStyles = makeStyles(function (theme) { return ({
    root: {
        color: theme.palette.text.secondary,
        paddingTop: theme.spacing(1),
        paddingBottom: theme.spacing(1),
        paddingLeft: theme.spacing(2),
        paddingRight: theme.spacing(2),
        backgroundColor: theme.palette.common.white,
        borderRadius: 'unset',
        position: 'fixed',
        display: 'flex',
        alignItems: 'center',
        boxShadow: theme.boxShadows.tooltip,
        top: 0,
        right: 0,
        zIndex: 1500,
        pointerEvents: 'auto',
        '@media screen and (max-width: 480px)': {
            top: 'unset',
            bottom: 0,
            width: '100%',
        },
    },
    infoModifier: {
        borderLeft: "10px solid ".concat(theme.palette.blue.main),
    },
    errorModifier: {
        borderLeft: "10px solid ".concat(theme.palette.red.main),
    },
    warningModifier: {
        borderLeft: "10px solid ".concat(theme.palette.yellow.main),
    },
    successModifier: {
        borderLeft: "10px solid ".concat(theme.palette.green.main),
    },
    icon: {
        width: theme.pxToRem(16),
        height: theme.pxToRem(16),
        marginRight: theme.spacing(1),
    },
    title: {
        color: theme.palette.black[600],
    },
    closeButton: {
        marginLeft: theme.spacing(2),
        borderLeft: "1px solid ".concat(theme.palette.divider),
    },
}); }, { name: SnackbarStylesKey });
export var Snackbar = React.forwardRef(function (_a, ref) {
    var _b;
    var className = _a.className, _c = _a.duration, duration = _c === void 0 ? 6000 : _c, Icon = _a.icon, _d = _a.isOpen, isOpen = _d === void 0 ? false : _d, _e = _a.allowDismiss, allowDismiss = _e === void 0 ? false : _e, onClose = _a.onClose, _f = _a.role, role = _f === void 0 ? 'status' : _f, _g = _a.statusType, statusType = _g === void 0 ? 'info' : _g, title = _a.title, children = _a.children, rootProps = __rest(_a, ["className", "duration", "icon", "isOpen", "allowDismiss", "onClose", "role", "statusType", "title", "children"]);
    var classes = useStyles({});
    var shouldReduceMotion = useReducedMotion();
    var _h = React.useState(duration), snackbarTimeout = _h[0], setSnackbarTimeout = _h[1];
    // Event handlers
    var onMouseEnter = function () { return setSnackbarTimeout(null); };
    var onMouseLeave = function () { return setSnackbarTimeout(duration); };
    var closeSnackbar = React.useCallback(function () {
        onClose && onClose();
    }, [onClose]);
    // Use a ref to close our Snackbar after the timeout
    var callbackRef = React.useRef();
    React.useEffect(function () {
        if (!callbackRef.current) {
            callbackRef.current = closeSnackbar;
        }
    }, [closeSnackbar]);
    React.useEffect(function () {
        // Ignore setting up a timer for the Snackbar
        // if one is not isOpen.
        if (!isOpen) {
            return;
        }
        var tick = function () {
            if (callbackRef.current) {
                callbackRef.current();
            }
        };
        if (snackbarTimeout) {
            var id_1 = setTimeout(tick, snackbarTimeout);
            return function () { return clearTimeout(id_1); };
        }
    }, [snackbarTimeout, isOpen]);
    return (React.createElement(AnimatePresence, { initial: false }, isOpen ? (React.createElement(motion.div, __assign({ ref: ref, className: clsx(classes.root, (_b = {},
            _b[classes.infoModifier] = statusType === 'info',
            _b[classes.errorModifier] = statusType === 'error',
            _b[classes.warningModifier] = statusType === 'warning',
            _b[classes.successModifier] = statusType === 'success',
            _b), className), "aria-live": role === 'alert' ? 'assertive' : 'polite', role: role, onMouseEnter: onMouseEnter, onMouseLeave: onMouseLeave, positionTransition: true, initial: shouldReduceMotion ? { opacity: 0 } : { opacity: 0, y: -40 }, animate: shouldReduceMotion
            ? { opacity: 1 }
            : {
                opacity: 1,
                y: 0,
            }, exit: shouldReduceMotion
            ? { opacity: 0 }
            : {
                opacity: 0,
                y: 60,
                transition: { duration: 0.25, ease: 'easeIn' },
            } }, rootProps),
        !!Icon && React.createElement(Icon, { role: "img", "aria-hidden": true, className: classes.icon }),
        children ? (children) : (React.createElement(Text, { className: classes.title }, title)),
        allowDismiss && (React.createElement(React.Fragment, null,
            React.createElement(IconButton, { className: classes.closeButton, "aria-label": "Close Notification", size: 0, paddingTop: 0, paddingBottom: 0, paddingRight: 0, icon: X, onClick: closeSnackbar }))))) : null));
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU25hY2tiYXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy9TbmFja2Jhci9TbmFja2Jhci50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUNBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxjQUFjLENBQUM7QUFDMUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxlQUFlLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDMUUsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUMvQixPQUFPLElBQUksTUFBTSxNQUFNLENBQUM7QUFDeEIsT0FBTyxLQUFLLEtBQUssTUFBTSxPQUFPLENBQUM7QUFDL0IsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMzQyxPQUFPLEVBQUUsQ0FBQyxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFHekMsTUFBTSxDQUFDLElBQU0saUJBQWlCLEdBQUcsZ0JBQWdCLENBQUM7QUFFbEQsTUFBTSxDQUFDLElBQU0sU0FBUyxHQUFHLFVBQVUsQ0FDakMsVUFBQyxLQUFLLElBQUssT0FBQSxDQUFDO0lBQ1YsSUFBSSxFQUFFO1FBQ0osS0FBSyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFNBQVM7UUFDbkMsVUFBVSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1FBQzVCLGFBQWEsRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztRQUMvQixXQUFXLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFDN0IsWUFBWSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1FBQzlCLGVBQWUsRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxLQUFLO1FBQzNDLFlBQVksRUFBRSxPQUFPO1FBQ3JCLFFBQVEsRUFBRSxPQUFPO1FBQ2pCLE9BQU8sRUFBRSxNQUFNO1FBQ2YsVUFBVSxFQUFFLFFBQVE7UUFDcEIsU0FBUyxFQUFFLEtBQUssQ0FBQyxVQUFVLENBQUMsT0FBTztRQUNuQyxHQUFHLEVBQUUsQ0FBQztRQUNOLEtBQUssRUFBRSxDQUFDO1FBQ1IsTUFBTSxFQUFFLElBQUk7UUFDWixhQUFhLEVBQUUsTUFBTTtRQUNyQixzQ0FBc0MsRUFBRTtZQUN0QyxHQUFHLEVBQUUsT0FBTztZQUNaLE1BQU0sRUFBRSxDQUFDO1lBQ1QsS0FBSyxFQUFFLE1BQU07U0FDZDtLQUNGO0lBQ0QsWUFBWSxFQUFFO1FBQ1osVUFBVSxFQUFFLHFCQUFjLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBRTtLQUNwRDtJQUNELGFBQWEsRUFBRTtRQUNiLFVBQVUsRUFBRSxxQkFBYyxLQUFLLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUU7S0FDbkQ7SUFDRCxlQUFlLEVBQUU7UUFDZixVQUFVLEVBQUUscUJBQWMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFFO0tBQ3REO0lBQ0QsZUFBZSxFQUFFO1FBQ2YsVUFBVSxFQUFFLHFCQUFjLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBRTtLQUNyRDtJQUNELElBQUksRUFBRTtRQUNKLEtBQUssRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQztRQUN4QixNQUFNLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUM7UUFDekIsV0FBVyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO0tBQzlCO0lBQ0QsS0FBSyxFQUFFO1FBQ0wsS0FBSyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQztLQUNoQztJQUNELFdBQVcsRUFBRTtRQUNYLFVBQVUsRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztRQUM1QixVQUFVLEVBQUUsb0JBQWEsS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUU7S0FDakQ7Q0FDRixDQUFDLEVBL0NTLENBK0NULEVBQ0YsRUFBRSxJQUFJLEVBQUUsaUJBQWlCLEVBQUUsQ0FDNUIsQ0FBQztBQWlCRixNQUFNLENBQUMsSUFBTSxRQUFRLEdBQTRCLEtBQUssQ0FBQyxVQUFVLENBSS9ELFVBQ0UsRUFZQyxFQUNELEdBQUc7O0lBWkQsSUFBQSxTQUFTLGVBQUEsRUFDVCxnQkFBZSxFQUFmLFFBQVEsbUJBQUcsSUFBSSxLQUFBLEVBQ1QsSUFBSSxVQUFBLEVBQ1YsY0FBYyxFQUFkLE1BQU0sbUJBQUcsS0FBSyxLQUFBLEVBQ2Qsb0JBQW9CLEVBQXBCLFlBQVksbUJBQUcsS0FBSyxLQUFBLEVBQ3BCLE9BQU8sYUFBQSxFQUNQLFlBQWUsRUFBZixJQUFJLG1CQUFHLFFBQVEsS0FBQSxFQUNmLGtCQUFtQixFQUFuQixVQUFVLG1CQUFHLE1BQU0sS0FBQSxFQUNuQixLQUFLLFdBQUEsRUFDTCxRQUFRLGNBQUEsRUFDTCxTQUFTLGNBWGQsaUhBWUMsQ0FEYTtJQUlkLElBQU0sT0FBTyxHQUFHLFNBQVMsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUU5QixJQUFNLGtCQUFrQixHQUFHLGdCQUFnQixFQUFFLENBQUM7SUFFeEMsSUFBQSxLQUF3QyxLQUFLLENBQUMsUUFBUSxDQUMxRCxRQUFRLENBQ1QsRUFGTSxlQUFlLFFBQUEsRUFBRSxrQkFBa0IsUUFFekMsQ0FBQztJQUVGLGlCQUFpQjtJQUNqQixJQUFNLFlBQVksR0FBRyxjQUFNLE9BQUEsa0JBQWtCLENBQUMsSUFBSSxDQUFDLEVBQXhCLENBQXdCLENBQUM7SUFDcEQsSUFBTSxZQUFZLEdBQUcsY0FBTSxPQUFBLGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxFQUE1QixDQUE0QixDQUFDO0lBQ3hELElBQU0sYUFBYSxHQUFHLEtBQUssQ0FBQyxXQUFXLENBQUM7UUFDdEMsT0FBTyxJQUFJLE9BQU8sRUFBRSxDQUFDO0lBQ3ZCLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7SUFFZCxvREFBb0Q7SUFDcEQsSUFBTSxXQUFXLEdBQUcsS0FBSyxDQUFDLE1BQU0sRUFBcUIsQ0FBQztJQUV0RCxLQUFLLENBQUMsU0FBUyxDQUFDO1FBQ2QsSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUU7WUFDeEIsV0FBVyxDQUFDLE9BQU8sR0FBRyxhQUFhLENBQUM7U0FDckM7SUFDSCxDQUFDLEVBQUUsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDO0lBRXBCLEtBQUssQ0FBQyxTQUFTLENBQUM7UUFDZCw2Q0FBNkM7UUFDN0Msd0JBQXdCO1FBQ3hCLElBQUksQ0FBQyxNQUFNLEVBQUU7WUFDWCxPQUFPO1NBQ1I7UUFFRCxJQUFNLElBQUksR0FBRztZQUNYLElBQUksV0FBVyxDQUFDLE9BQU8sRUFBRTtnQkFDdkIsV0FBVyxDQUFDLE9BQU8sRUFBRSxDQUFDO2FBQ3ZCO1FBQ0gsQ0FBQyxDQUFDO1FBRUYsSUFBSSxlQUFlLEVBQUU7WUFDbkIsSUFBTSxJQUFFLEdBQUcsVUFBVSxDQUFDLElBQUksRUFBRSxlQUFlLENBQUMsQ0FBQztZQUM3QyxPQUFPLGNBQU0sT0FBQSxZQUFZLENBQUMsSUFBRSxDQUFDLEVBQWhCLENBQWdCLENBQUM7U0FDL0I7SUFDSCxDQUFDLEVBQUUsQ0FBQyxlQUFlLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUU5QixPQUFPLENBQ0wsb0JBQUMsZUFBZSxJQUFDLE9BQU8sRUFBRSxLQUFLLElBQzVCLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FDUixvQkFBQyxNQUFNLENBQUMsR0FBRyxhQUNULEdBQUcsRUFBRSxHQUFHLEVBQ1IsU0FBUyxFQUFFLElBQUksQ0FDYixPQUFPLENBQUMsSUFBSTtZQUVWLEdBQUMsT0FBTyxDQUFDLFlBQVksSUFBRyxVQUFVLEtBQUssTUFBTTtZQUM3QyxHQUFDLE9BQU8sQ0FBQyxhQUFhLElBQUcsVUFBVSxLQUFLLE9BQU87WUFDL0MsR0FBQyxPQUFPLENBQUMsZUFBZSxJQUFHLFVBQVUsS0FBSyxTQUFTO1lBQ25ELEdBQUMsT0FBTyxDQUFDLGVBQWUsSUFBRyxVQUFVLEtBQUssU0FBUztpQkFFckQsU0FBUyxDQUNWLGVBQ1UsSUFBSSxLQUFLLE9BQU8sQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQ3BELElBQUksRUFBRSxJQUFJLEVBQ1YsWUFBWSxFQUFFLFlBQVksRUFDMUIsWUFBWSxFQUFFLFlBQVksRUFDMUIsa0JBQWtCLFFBQ2xCLE9BQU8sRUFDTCxrQkFBa0IsQ0FBQyxDQUFDLENBQUMsRUFBRSxPQUFPLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsT0FBTyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFFOUQsT0FBTyxFQUNMLGtCQUFrQjtZQUNoQixDQUFDLENBQUMsRUFBRSxPQUFPLEVBQUUsQ0FBQyxFQUFFO1lBQ2hCLENBQUMsQ0FBQztnQkFDRSxPQUFPLEVBQUUsQ0FBQztnQkFDVixDQUFDLEVBQUUsQ0FBQzthQUNMLEVBRVAsSUFBSSxFQUNGLGtCQUFrQjtZQUNoQixDQUFDLENBQUMsRUFBRSxPQUFPLEVBQUUsQ0FBQyxFQUFFO1lBQ2hCLENBQUMsQ0FBQztnQkFDRSxPQUFPLEVBQUUsQ0FBQztnQkFDVixDQUFDLEVBQUUsRUFBRTtnQkFDTCxVQUFVLEVBQUUsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUU7YUFDL0MsSUFFSCxTQUFTO1FBRVosQ0FBQyxDQUFDLElBQUksSUFBSSxvQkFBQyxJQUFJLElBQUMsSUFBSSxFQUFDLEtBQUssdUJBQWEsU0FBUyxFQUFFLE9BQU8sQ0FBQyxJQUFJLEdBQUk7UUFDbEUsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUNWLFFBQVEsQ0FDVCxDQUFDLENBQUMsQ0FBQyxDQUNGLG9CQUFDLElBQUksSUFBQyxTQUFTLEVBQUUsT0FBTyxDQUFDLEtBQUssSUFBRyxLQUFLLENBQVEsQ0FDL0M7UUFDQSxZQUFZLElBQUksQ0FDZjtZQUNFLG9CQUFDLFVBQVUsSUFDVCxTQUFTLEVBQUUsT0FBTyxDQUFDLFdBQVcsZ0JBQ25CLG9CQUFvQixFQUMvQixJQUFJLEVBQUUsQ0FBQyxFQUNQLFVBQVUsRUFBRSxDQUFDLEVBQ2IsYUFBYSxFQUFFLENBQUMsRUFDaEIsWUFBWSxFQUFFLENBQUMsRUFDZixJQUFJLEVBQUUsQ0FBQyxFQUNQLE9BQU8sRUFBRSxhQUFhLEdBQ3RCLENBQ0QsQ0FDSixDQUNVLENBQ2QsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUNRLENBQ25CLENBQUM7QUFDSixDQUFDLENBQ0YsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEdldENsYXNzZXMgfSBmcm9tICcuLi8uLi90eXBlVXRpbHMnO1xuaW1wb3J0IHsgbWFrZVN0eWxlcyB9IGZyb20gJy4uLy4uL3N0eWxlcyc7XG5pbXBvcnQgeyBtb3Rpb24sIEFuaW1hdGVQcmVzZW5jZSwgdXNlUmVkdWNlZE1vdGlvbiB9IGZyb20gJ2ZyYW1lci1tb3Rpb24nO1xuaW1wb3J0IHsgVGV4dCB9IGZyb20gJy4uL1RleHQnO1xuaW1wb3J0IGNsc3ggZnJvbSAnY2xzeCc7XG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBJY29uQnV0dG9uIH0gZnJvbSAnLi4vSWNvbkJ1dHRvbic7XG5pbXBvcnQgeyBYIH0gZnJvbSAnQGxpZmVvbWljL2Nocm9taWNvbnMnO1xuaW1wb3J0IHsgTm90aWZpY2F0aW9uU3RhdHVzVHlwZSB9IGZyb20gJy4uL19wcml2YXRlL25vdGlmaWNhdGlvblR5cGVzJztcblxuZXhwb3J0IGNvbnN0IFNuYWNrYmFyU3R5bGVzS2V5ID0gJ0Nocm9tYVNuYWNrYmFyJztcblxuZXhwb3J0IGNvbnN0IHVzZVN0eWxlcyA9IG1ha2VTdHlsZXMoXG4gICh0aGVtZSkgPT4gKHtcbiAgICByb290OiB7XG4gICAgICBjb2xvcjogdGhlbWUucGFsZXR0ZS50ZXh0LnNlY29uZGFyeSxcbiAgICAgIHBhZGRpbmdUb3A6IHRoZW1lLnNwYWNpbmcoMSksXG4gICAgICBwYWRkaW5nQm90dG9tOiB0aGVtZS5zcGFjaW5nKDEpLFxuICAgICAgcGFkZGluZ0xlZnQ6IHRoZW1lLnNwYWNpbmcoMiksXG4gICAgICBwYWRkaW5nUmlnaHQ6IHRoZW1lLnNwYWNpbmcoMiksXG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IHRoZW1lLnBhbGV0dGUuY29tbW9uLndoaXRlLFxuICAgICAgYm9yZGVyUmFkaXVzOiAndW5zZXQnLFxuICAgICAgcG9zaXRpb246ICdmaXhlZCcsXG4gICAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgICBhbGlnbkl0ZW1zOiAnY2VudGVyJyxcbiAgICAgIGJveFNoYWRvdzogdGhlbWUuYm94U2hhZG93cy50b29sdGlwLFxuICAgICAgdG9wOiAwLFxuICAgICAgcmlnaHQ6IDAsXG4gICAgICB6SW5kZXg6IDE1MDAsXG4gICAgICBwb2ludGVyRXZlbnRzOiAnYXV0bycsXG4gICAgICAnQG1lZGlhIHNjcmVlbiBhbmQgKG1heC13aWR0aDogNDgwcHgpJzoge1xuICAgICAgICB0b3A6ICd1bnNldCcsXG4gICAgICAgIGJvdHRvbTogMCxcbiAgICAgICAgd2lkdGg6ICcxMDAlJyxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBpbmZvTW9kaWZpZXI6IHtcbiAgICAgIGJvcmRlckxlZnQ6IGAxMHB4IHNvbGlkICR7dGhlbWUucGFsZXR0ZS5ibHVlLm1haW59YCxcbiAgICB9LFxuICAgIGVycm9yTW9kaWZpZXI6IHtcbiAgICAgIGJvcmRlckxlZnQ6IGAxMHB4IHNvbGlkICR7dGhlbWUucGFsZXR0ZS5yZWQubWFpbn1gLFxuICAgIH0sXG4gICAgd2FybmluZ01vZGlmaWVyOiB7XG4gICAgICBib3JkZXJMZWZ0OiBgMTBweCBzb2xpZCAke3RoZW1lLnBhbGV0dGUueWVsbG93Lm1haW59YCxcbiAgICB9LFxuICAgIHN1Y2Nlc3NNb2RpZmllcjoge1xuICAgICAgYm9yZGVyTGVmdDogYDEwcHggc29saWQgJHt0aGVtZS5wYWxldHRlLmdyZWVuLm1haW59YCxcbiAgICB9LFxuICAgIGljb246IHtcbiAgICAgIHdpZHRoOiB0aGVtZS5weFRvUmVtKDE2KSxcbiAgICAgIGhlaWdodDogdGhlbWUucHhUb1JlbSgxNiksXG4gICAgICBtYXJnaW5SaWdodDogdGhlbWUuc3BhY2luZygxKSxcbiAgICB9LFxuICAgIHRpdGxlOiB7XG4gICAgICBjb2xvcjogdGhlbWUucGFsZXR0ZS5ibGFja1s2MDBdLFxuICAgIH0sXG4gICAgY2xvc2VCdXR0b246IHtcbiAgICAgIG1hcmdpbkxlZnQ6IHRoZW1lLnNwYWNpbmcoMiksXG4gICAgICBib3JkZXJMZWZ0OiBgMXB4IHNvbGlkICR7dGhlbWUucGFsZXR0ZS5kaXZpZGVyfWAsXG4gICAgfSxcbiAgfSksXG4gIHsgbmFtZTogU25hY2tiYXJTdHlsZXNLZXkgfVxuKTtcblxuZXhwb3J0IHR5cGUgU25hY2tiYXJDbGFzc2VzID0gR2V0Q2xhc3Nlczx0eXBlb2YgdXNlU3R5bGVzPjtcblxuZXhwb3J0IGludGVyZmFjZSBTbmFja2JhclByb3BzIHtcbiAgZHVyYXRpb24/OiBudW1iZXI7XG4gIGNoaWxkcmVuPzogUmVhY3QuUmVhY3ROb2RlO1xuICBjbGFzc05hbWU/OiBzdHJpbmc7XG4gIGljb24/OiBSZWFjdC5Db21wb25lbnRUeXBlPFJlYWN0LlNWR1Byb3BzPFNWR1NWR0VsZW1lbnQ+PjtcbiAgaXNPcGVuPzogYm9vbGVhbjtcbiAgYWxsb3dEaXNtaXNzPzogYm9vbGVhbjtcbiAgb25DbG9zZT86ICgpID0+IHZvaWQ7XG4gIHJvbGU/OiAnYWxlcnQnIHwgJ3N0YXR1cyc7XG4gIHN0YXR1c1R5cGU/OiBOb3RpZmljYXRpb25TdGF0dXNUeXBlO1xuICB0aXRsZT86IHN0cmluZztcbn1cblxuZXhwb3J0IGNvbnN0IFNuYWNrYmFyOiBSZWFjdC5GQzxTbmFja2JhclByb3BzPiA9IFJlYWN0LmZvcndhcmRSZWY8XG4gIEhUTUxEaXZFbGVtZW50LFxuICBTbmFja2JhclByb3BzXG4+KFxuICAoXG4gICAge1xuICAgICAgY2xhc3NOYW1lLFxuICAgICAgZHVyYXRpb24gPSA2MDAwLFxuICAgICAgaWNvbjogSWNvbixcbiAgICAgIGlzT3BlbiA9IGZhbHNlLFxuICAgICAgYWxsb3dEaXNtaXNzID0gZmFsc2UsXG4gICAgICBvbkNsb3NlLFxuICAgICAgcm9sZSA9ICdzdGF0dXMnLFxuICAgICAgc3RhdHVzVHlwZSA9ICdpbmZvJyxcbiAgICAgIHRpdGxlLFxuICAgICAgY2hpbGRyZW4sXG4gICAgICAuLi5yb290UHJvcHNcbiAgICB9LFxuICAgIHJlZlxuICApID0+IHtcbiAgICBjb25zdCBjbGFzc2VzID0gdXNlU3R5bGVzKHt9KTtcblxuICAgIGNvbnN0IHNob3VsZFJlZHVjZU1vdGlvbiA9IHVzZVJlZHVjZWRNb3Rpb24oKTtcblxuICAgIGNvbnN0IFtzbmFja2JhclRpbWVvdXQsIHNldFNuYWNrYmFyVGltZW91dF0gPSBSZWFjdC51c2VTdGF0ZTxudW1iZXIgfCBudWxsPihcbiAgICAgIGR1cmF0aW9uXG4gICAgKTtcblxuICAgIC8vIEV2ZW50IGhhbmRsZXJzXG4gICAgY29uc3Qgb25Nb3VzZUVudGVyID0gKCkgPT4gc2V0U25hY2tiYXJUaW1lb3V0KG51bGwpO1xuICAgIGNvbnN0IG9uTW91c2VMZWF2ZSA9ICgpID0+IHNldFNuYWNrYmFyVGltZW91dChkdXJhdGlvbik7XG4gICAgY29uc3QgY2xvc2VTbmFja2JhciA9IFJlYWN0LnVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAgIG9uQ2xvc2UgJiYgb25DbG9zZSgpO1xuICAgIH0sIFtvbkNsb3NlXSk7XG5cbiAgICAvLyBVc2UgYSByZWYgdG8gY2xvc2Ugb3VyIFNuYWNrYmFyIGFmdGVyIHRoZSB0aW1lb3V0XG4gICAgY29uc3QgY2FsbGJhY2tSZWYgPSBSZWFjdC51c2VSZWY8KCkgPT4gdm9pZCB8IG51bGw+KCk7XG5cbiAgICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgaWYgKCFjYWxsYmFja1JlZi5jdXJyZW50KSB7XG4gICAgICAgIGNhbGxiYWNrUmVmLmN1cnJlbnQgPSBjbG9zZVNuYWNrYmFyO1xuICAgICAgfVxuICAgIH0sIFtjbG9zZVNuYWNrYmFyXSk7XG5cbiAgICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgLy8gSWdub3JlIHNldHRpbmcgdXAgYSB0aW1lciBmb3IgdGhlIFNuYWNrYmFyXG4gICAgICAvLyBpZiBvbmUgaXMgbm90IGlzT3Blbi5cbiAgICAgIGlmICghaXNPcGVuKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdGljayA9ICgpID0+IHtcbiAgICAgICAgaWYgKGNhbGxiYWNrUmVmLmN1cnJlbnQpIHtcbiAgICAgICAgICBjYWxsYmFja1JlZi5jdXJyZW50KCk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGlmIChzbmFja2JhclRpbWVvdXQpIHtcbiAgICAgICAgY29uc3QgaWQgPSBzZXRUaW1lb3V0KHRpY2ssIHNuYWNrYmFyVGltZW91dCk7XG4gICAgICAgIHJldHVybiAoKSA9PiBjbGVhclRpbWVvdXQoaWQpO1xuICAgICAgfVxuICAgIH0sIFtzbmFja2JhclRpbWVvdXQsIGlzT3Blbl0pO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxBbmltYXRlUHJlc2VuY2UgaW5pdGlhbD17ZmFsc2V9PlxuICAgICAgICB7aXNPcGVuID8gKFxuICAgICAgICAgIDxtb3Rpb24uZGl2XG4gICAgICAgICAgICByZWY9e3JlZn1cbiAgICAgICAgICAgIGNsYXNzTmFtZT17Y2xzeChcbiAgICAgICAgICAgICAgY2xhc3Nlcy5yb290LFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgW2NsYXNzZXMuaW5mb01vZGlmaWVyXTogc3RhdHVzVHlwZSA9PT0gJ2luZm8nLFxuICAgICAgICAgICAgICAgIFtjbGFzc2VzLmVycm9yTW9kaWZpZXJdOiBzdGF0dXNUeXBlID09PSAnZXJyb3InLFxuICAgICAgICAgICAgICAgIFtjbGFzc2VzLndhcm5pbmdNb2RpZmllcl06IHN0YXR1c1R5cGUgPT09ICd3YXJuaW5nJyxcbiAgICAgICAgICAgICAgICBbY2xhc3Nlcy5zdWNjZXNzTW9kaWZpZXJdOiBzdGF0dXNUeXBlID09PSAnc3VjY2VzcycsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGNsYXNzTmFtZVxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIGFyaWEtbGl2ZT17cm9sZSA9PT0gJ2FsZXJ0JyA/ICdhc3NlcnRpdmUnIDogJ3BvbGl0ZSd9XG4gICAgICAgICAgICByb2xlPXtyb2xlfVxuICAgICAgICAgICAgb25Nb3VzZUVudGVyPXtvbk1vdXNlRW50ZXJ9XG4gICAgICAgICAgICBvbk1vdXNlTGVhdmU9e29uTW91c2VMZWF2ZX1cbiAgICAgICAgICAgIHBvc2l0aW9uVHJhbnNpdGlvblxuICAgICAgICAgICAgaW5pdGlhbD17XG4gICAgICAgICAgICAgIHNob3VsZFJlZHVjZU1vdGlvbiA/IHsgb3BhY2l0eTogMCB9IDogeyBvcGFjaXR5OiAwLCB5OiAtNDAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYW5pbWF0ZT17XG4gICAgICAgICAgICAgIHNob3VsZFJlZHVjZU1vdGlvblxuICAgICAgICAgICAgICAgID8geyBvcGFjaXR5OiAxIH1cbiAgICAgICAgICAgICAgICA6IHtcbiAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgICAgICAgICAgeTogMCxcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGV4aXQ9e1xuICAgICAgICAgICAgICBzaG91bGRSZWR1Y2VNb3Rpb25cbiAgICAgICAgICAgICAgICA/IHsgb3BhY2l0eTogMCB9XG4gICAgICAgICAgICAgICAgOiB7XG4gICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDAsXG4gICAgICAgICAgICAgICAgICAgIHk6IDYwLFxuICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uOiB7IGR1cmF0aW9uOiAwLjI1LCBlYXNlOiAnZWFzZUluJyB9LFxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgey4uLnJvb3RQcm9wc31cbiAgICAgICAgICA+XG4gICAgICAgICAgICB7ISFJY29uICYmIDxJY29uIHJvbGU9XCJpbWdcIiBhcmlhLWhpZGRlbiBjbGFzc05hbWU9e2NsYXNzZXMuaWNvbn0gLz59XG4gICAgICAgICAgICB7Y2hpbGRyZW4gPyAoXG4gICAgICAgICAgICAgIGNoaWxkcmVuXG4gICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICA8VGV4dCBjbGFzc05hbWU9e2NsYXNzZXMudGl0bGV9Pnt0aXRsZX08L1RleHQ+XG4gICAgICAgICAgICApfVxuICAgICAgICAgICAge2FsbG93RGlzbWlzcyAmJiAoXG4gICAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgICAgPEljb25CdXR0b25cbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y2xhc3Nlcy5jbG9zZUJ1dHRvbn1cbiAgICAgICAgICAgICAgICAgIGFyaWEtbGFiZWw9XCJDbG9zZSBOb3RpZmljYXRpb25cIlxuICAgICAgICAgICAgICAgICAgc2l6ZT17MH1cbiAgICAgICAgICAgICAgICAgIHBhZGRpbmdUb3A9ezB9XG4gICAgICAgICAgICAgICAgICBwYWRkaW5nQm90dG9tPXswfVxuICAgICAgICAgICAgICAgICAgcGFkZGluZ1JpZ2h0PXswfVxuICAgICAgICAgICAgICAgICAgaWNvbj17WH1cbiAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2Nsb3NlU25hY2tiYXJ9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPC8+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvbW90aW9uLmRpdj5cbiAgICAgICAgKSA6IG51bGx9XG4gICAgICA8L0FuaW1hdGVQcmVzZW5jZT5cbiAgICApO1xuICB9XG4pO1xuIl19