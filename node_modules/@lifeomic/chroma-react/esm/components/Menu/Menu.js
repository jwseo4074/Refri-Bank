var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};
import { ConditionalWrapper } from '../_private/ConditionalWrapper';
import { makeStyles } from '../../styles';
import { motion, useReducedMotion } from 'framer-motion';
import { Portal } from 'reakit/Portal';
import { Text } from '../Text';
import { Menu as ReakitMenu, MenuButton, MenuItem as ReakitMenuItem, useMenuState, } from 'reakit/Menu';
import clsx from 'clsx';
import * as React from 'react';
import 'focus-visible';
export var MenuStylesKey = 'ChromaMenu';
export var useStyles = makeStyles(function (theme) { return ({
    root: {
        backgroundColor: theme.palette.common.white,
        borderRadius: theme.pxToRem(10),
        boxShadow: theme.boxShadows.popover,
        maxHeight: theme.pxToRem(432),
        minWidth: theme.pxToRem(224),
        overflowY: 'auto',
        paddingBottom: theme.spacing(2),
        paddingTop: theme.spacing(2),
        zIndex: 40,
        '&:focus': {
            outline: 'none',
        },
        '&:focus.focus-visible': {
            boxShadow: theme.boxShadows.focusVisible,
        },
    },
    title: {
        paddingBottom: theme.spacing(2),
        paddingLeft: theme.spacing(2.5),
        paddingRight: theme.spacing(2.5),
    },
}); }, { name: MenuStylesKey });
export var Menu = function (_a) {
    var ariaLabel = _a["aria-label"], anchorElement = _a.anchorElement, children = _a.children, className = _a.className, gutter = _a.gutter, items = _a.items, _b = _a.placement, placement = _b === void 0 ? 'bottom' : _b, title = _a.title, _c = _a.usePortal, usePortal = _c === void 0 ? false : _c, rootProps = __rest(_a, ['aria-label', "anchorElement", "children", "className", "gutter", "items", "placement", "title", "usePortal"]);
    var classes = useStyles({});
    var shouldReduceMotion = useReducedMotion();
    var menu = useMenuState({ placement: placement, gutter: gutter });
    var handleStopPropagation = function (e) {
        return e.stopPropagation();
    };
    return (React.createElement(React.Fragment, null,
        React.createElement(MenuButton, __assign({}, menu, anchorElement.props, { onClick: handleStopPropagation }), function (disclosureProps) {
            return React.cloneElement(React.Children.only(anchorElement), disclosureProps);
        }),
        React.createElement(ConditionalWrapper, { condition: usePortal, wrapper: function (children) { return React.createElement(Portal, null, children); } },
            React.createElement(ReakitMenu, __assign({}, menu, { as: motion.div, "aria-label": ariaLabel, className: clsx(classes.root, className), animate: menu.visible
                    ? shouldReduceMotion
                        ? { opacity: 1 }
                        : {
                            opacity: 1,
                            transition: { duration: 0.3 },
                        }
                    : shouldReduceMotion
                        ? { opacity: 0 }
                        : {
                            opacity: 0,
                            transition: { duration: 0.1 },
                        } }, rootProps),
                !!title && (React.createElement(Text, { className: classes.title, weight: "bold", size: "subbody" }, title)),
                items &&
                    items.map(function (item, i) { return (React.createElement(ReakitMenuItem, __assign({}, menu, item.props, { key: i, onClick: function (e) {
                            menu.hide();
                            item.props.onClick && item.props.onClick(e);
                        } }), function (itemProps) {
                        return React.cloneElement(React.Children.only(item), itemProps);
                    })); })))));
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTWVudS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL01lbnUvTWVudS50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBRXBFLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxjQUFjLENBQUM7QUFFMUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN6RCxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3ZDLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxTQUFTLENBQUM7QUFDL0IsT0FBTyxFQUNMLElBQUksSUFBSSxVQUFVLEVBQ2xCLFVBQVUsRUFDVixRQUFRLElBQUksY0FBYyxFQUUxQixZQUFZLEdBQ2IsTUFBTSxhQUFhLENBQUM7QUFDckIsT0FBTyxJQUFJLE1BQU0sTUFBTSxDQUFDO0FBQ3hCLE9BQU8sS0FBSyxLQUFLLE1BQU0sT0FBTyxDQUFDO0FBQy9CLE9BQU8sZUFBZSxDQUFDO0FBRXZCLE1BQU0sQ0FBQyxJQUFNLGFBQWEsR0FBRyxZQUFZLENBQUM7QUFFMUMsTUFBTSxDQUFDLElBQU0sU0FBUyxHQUFHLFVBQVUsQ0FDakMsVUFBQyxLQUFLLElBQUssT0FBQSxDQUFDO0lBQ1YsSUFBSSxFQUFFO1FBQ0osZUFBZSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUs7UUFDM0MsWUFBWSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDO1FBQy9CLFNBQVMsRUFBRSxLQUFLLENBQUMsVUFBVSxDQUFDLE9BQU87UUFDbkMsU0FBUyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDO1FBQzdCLFFBQVEsRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQztR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QUFLLENBQ0QsQ0FDUjtnQkFDQSxLQUFLO29CQUNKLEtBQUssQ0FBQyxHQUFHLENBQUMsVUFBQyxJQUFJLEVBQUUsQ0FBQyxJQUFLLE9BQUEsQ0FDckIsb0JBQUMsY0FBYyxlQUNULElBQUksRUFDSixJQUFJLENBQUMsS0FBSyxJQUNkLEdBQUcsRUFBRSxDQUFDLEVBQ04sT0FBTyxFQUFFLFVBQUMsQ0FBTTs0QkFDZCxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7NEJBQ1osSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7d0JBQzlDLENBQUMsS0FFQSxVQUFDLFNBQVM7d0JBQ1QsT0FBQSxLQUFLLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLFNBQVMsQ0FBQztvQkFBeEQsQ0FBd0QsQ0FFM0MsQ0FDbEIsRUFkc0IsQ0FjdEIsQ0FBQyxDQUNPLENBQ00sQ0FDcEIsQ0FDSixDQUFDO0FBQ0osQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29uZGl0aW9uYWxXcmFwcGVyIH0gZnJvbSAnLi4vX3ByaXZhdGUvQ29uZGl0aW9uYWxXcmFwcGVyJztcbmltcG9ydCB7IEdldENsYXNzZXMgfSBmcm9tICcuLi8uLi90eXBlVXRpbHMnO1xuaW1wb3J0IHsgbWFrZVN0eWxlcyB9IGZyb20gJy4uLy4uL3N0eWxlcyc7XG5pbXBvcnQgeyBNZW51SXRlbVByb3BzIH0gZnJvbSAnLi9NZW51SXRlbSc7XG5pbXBvcnQgeyBtb3Rpb24sIHVzZVJlZHVjZWRNb3Rpb24gfSBmcm9tICdmcmFtZXItbW90aW9uJztcbmltcG9ydCB7IFBvcnRhbCB9IGZyb20gJ3JlYWtpdC9Qb3J0YWwnO1xuaW1wb3J0IHsgVGV4dCB9IGZyb20gJy4uL1RleHQnO1xuaW1wb3J0IHtcbiAgTWVudSBhcyBSZWFraXRNZW51LFxuICBNZW51QnV0dG9uLFxuICBNZW51SXRlbSBhcyBSZWFraXRNZW51SXRlbSxcbiAgTWVudUluaXRpYWxTdGF0ZSxcbiAgdXNlTWVudVN0YXRlLFxufSBmcm9tICdyZWFraXQvTWVudSc7XG5pbXBvcnQgY2xzeCBmcm9tICdjbHN4JztcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCAnZm9jdXMtdmlzaWJsZSc7XG5cbmV4cG9ydCBjb25zdCBNZW51U3R5bGVzS2V5ID0gJ0Nocm9tYU1lbnUnO1xuXG5leHBvcnQgY29uc3QgdXNlU3R5bGVzID0gbWFrZVN0eWxlcyhcbiAgKHRoZW1lKSA9PiAoe1xuICAgIHJvb3Q6IHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogdGhlbWUucGFsZXR0ZS5jb21tb24ud2hpdGUsXG4gICAgICBib3JkZXJSYWRpdXM6IHRoZW1lLnB4VG9SZW0oMTApLFxuICAgICAgYm94U2hhZG93OiB0aGVtZS5ib3hTaGFkb3dzLnBvcG92ZXIsXG4gICAgICBtYXhIZWlnaHQ6IHRoZW1lLnB4VG9SZW0oNDMyKSxcbiAgICAgIG1pbldpZHRoOiB0aGVtZS5weFRvUmVtKDIyNCksXG4gICAgICBvdmVyZmxvd1k6ICdhdXRvJyxcbiAgICAgIHBhZGRpbmdCb3R0b206IHRoZW1lLnNwYWNpbmcoMiksXG4gICAgICBwYWRkaW5nVG9wOiB0aGVtZS5zcGFjaW5nKDIpLFxuICAgICAgekluZGV4OiA0MCxcbiAgICAgICcmOmZvY3VzJzoge1xuICAgICAgICBvdXRsaW5lOiAnbm9uZScsXG4gICAgICB9LFxuICAgICAgJyY6Zm9jdXMuZm9jdXMtdmlzaWJsZSc6IHtcbiAgICAgICAgYm94U2hhZG93OiB0aGVtZS5ib3hTaGFkb3dzLmZvY3VzVmlzaWJsZSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICB0aXRsZToge1xuICAgICAgcGFkZGluZ0JvdHRvbTogdGhlbWUuc3BhY2luZygyKSxcbiAgICAgIHBhZGRpbmdMZWZ0OiB0aGVtZS5zcGFjaW5nKDIuNSksXG4gICAgICBwYWRkaW5nUmlnaHQ6IHRoZW1lLnNwYWNpbmcoMi41KSxcbiAgICB9LFxuICB9KSxcbiAgeyBuYW1lOiBNZW51U3R5bGVzS2V5IH1cbik7XG5cbmV4cG9ydCB0eXBlIE1lbnVDbGFzc2VzID0gR2V0Q2xhc3Nlczx0eXBlb2YgdXNlU3R5bGVzPjtcblxuZXhwb3J0IGludGVyZmFjZSBNZW51UHJvcHNcbiAgZXh0ZW5kcyBQaWNrPE1lbnVJbml0aWFsU3RhdGUsICdwbGFjZW1lbnQnIHwgJ2d1dHRlcic+IHtcbiAgWydhcmlhLWxhYmVsJ106IHN0cmluZztcbiAgYW5jaG9yRWxlbWVudD86IGFueTtcbiAgY2hpbGRyZW4/OiBSZWFjdC5SZWFjdE5vZGU7XG4gIGNsYXNzTmFtZT86IHN0cmluZztcbiAgaXRlbXM/OiBBcnJheTxSZWFjdC5SZWFjdEVsZW1lbnQ8TWVudUl0ZW1Qcm9wcz4+O1xuICB0aXRsZT86IHN0cmluZztcbiAgdXNlUG9ydGFsPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNvbnN0IE1lbnU6IFJlYWN0LkZDPE1lbnVQcm9wcz4gPSAoe1xuICAnYXJpYS1sYWJlbCc6IGFyaWFMYWJlbCxcbiAgYW5jaG9yRWxlbWVudCxcbiAgY2hpbGRyZW4sXG4gIGNsYXNzTmFtZSxcbiAgZ3V0dGVyLFxuICBpdGVtcyxcbiAgcGxhY2VtZW50ID0gJ2JvdHRvbScsXG4gIHRpdGxlLFxuICB1c2VQb3J0YWwgPSBmYWxzZSxcbiAgLi4ucm9vdFByb3BzXG59KSA9PiB7XG4gIGNvbnN0IGNsYXNzZXMgPSB1c2VTdHlsZXMoe30pO1xuXG4gIGNvbnN0IHNob3VsZFJlZHVjZU1vdGlvbiA9IHVzZVJlZHVjZWRNb3Rpb24oKTtcblxuICBjb25zdCBtZW51ID0gdXNlTWVudVN0YXRlKHsgcGxhY2VtZW50LCBndXR0ZXIgfSk7XG5cbiAgY29uc3QgaGFuZGxlU3RvcFByb3BhZ2F0aW9uID0gKGU6IFJlYWN0LlN5bnRoZXRpY0V2ZW50KSA9PlxuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgcmV0dXJuIChcbiAgICA8PlxuICAgICAgPE1lbnVCdXR0b25cbiAgICAgICAgey4uLm1lbnV9XG4gICAgICAgIHsuLi5hbmNob3JFbGVtZW50LnByb3BzfVxuICAgICAgICBvbkNsaWNrPXtoYW5kbGVTdG9wUHJvcGFnYXRpb259XG4gICAgICA+XG4gICAgICAgIHsoZGlzY2xvc3VyZVByb3BzKSA9PlxuICAgICAgICAgIFJlYWN0LmNsb25lRWxlbWVudChcbiAgICAgICAgICAgIFJlYWN0LkNoaWxkcmVuLm9ubHkoYW5jaG9yRWxlbWVudCksXG4gICAgICAgICAgICBkaXNjbG9zdXJlUHJvcHNcbiAgICAgICAgICApXG4gICAgICAgIH1cbiAgICAgIDwvTWVudUJ1dHRvbj5cbiAgICAgIDxDb25kaXRpb25hbFdyYXBwZXJcbiAgICAgICAgY29uZGl0aW9uPXt1c2VQb3J0YWx9XG4gICAgICAgIHdyYXBwZXI9eyhjaGlsZHJlbjogUmVhY3QuUmVhY3ROb2RlKSA9PiA8UG9ydGFsPntjaGlsZHJlbn08L1BvcnRhbD59XG4gICAgICA+XG4gICAgICAgIDxSZWFraXRNZW51XG4gICAgICAgICAgey4uLm1lbnV9XG4gICAgICAgICAgYXM9e21vdGlvbi5kaXZ9XG4gICAgICAgICAgYXJpYS1sYWJlbD17YXJpYUxhYmVsfVxuICAgICAgICAgIGNsYXNzTmFtZT17Y2xzeChjbGFzc2VzLnJvb3QsIGNsYXNzTmFtZSl9XG4gICAgICAgICAgYW5pbWF0ZT17XG4gICAgICAgICAgICBtZW51LnZpc2libGVcbiAgICAgICAgICAgICAgPyBzaG91bGRSZWR1Y2VNb3Rpb25cbiAgICAgICAgICAgICAgICA/IHsgb3BhY2l0eTogMSB9XG4gICAgICAgICAgICAgICAgOiB7XG4gICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zaXRpb246IHsgZHVyYXRpb246IDAuMyB9LFxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICA6IHNob3VsZFJlZHVjZU1vdGlvblxuICAgICAgICAgICAgICA/IHsgb3BhY2l0eTogMCB9XG4gICAgICAgICAgICAgIDoge1xuICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMCxcbiAgICAgICAgICAgICAgICAgIHRyYW5zaXRpb246IHsgZHVyYXRpb246IDAuMSB9LFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgey4uLnJvb3RQcm9wc31cbiAgICAgICAgPlxuICAgICAgICAgIHshIXRpdGxlICYmIChcbiAgICAgICAgICAgIDxUZXh0IGNsYXNzTmFtZT17Y2xhc3Nlcy50aXRsZX0gd2VpZ2h0PVwiYm9sZFwiIHNpemU9XCJzdWJib2R5XCI+XG4gICAgICAgICAgICAgIHt0aXRsZX1cbiAgICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgICApfVxuICAgICAgICAgIHtpdGVtcyAmJlxuICAgICAgICAgICAgaXRlbXMubWFwKChpdGVtLCBpKSA9PiAoXG4gICAgICAgICAgICAgIDxSZWFraXRNZW51SXRlbVxuICAgICAgICAgICAgICAgIHsuLi5tZW51fVxuICAgICAgICAgICAgICAgIHsuLi5pdGVtLnByb3BzfVxuICAgICAgICAgICAgICAgIGtleT17aX1cbiAgICAgICAgICAgICAgICBvbkNsaWNrPXsoZTogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgICBtZW51LmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgIGl0ZW0ucHJvcHMub25DbGljayAmJiBpdGVtLnByb3BzLm9uQ2xpY2soZSk7XG4gICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHsoaXRlbVByb3BzKSA9PlxuICAgICAgICAgICAgICAgICAgUmVhY3QuY2xvbmVFbGVtZW50KFJlYWN0LkNoaWxkcmVuLm9ubHkoaXRlbSksIGl0ZW1Qcm9wcylcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIDwvUmVha2l0TWVudUl0ZW0+XG4gICAgICAgICAgICApKX1cbiAgICAgICAgPC9SZWFraXRNZW51PlxuICAgICAgPC9Db25kaXRpb25hbFdyYXBwZXI+XG4gICAgPC8+XG4gICk7XG59O1xuIl19