var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};
import clsx from 'clsx';
import * as React from 'react';
import { makeStyles } from '../../styles';
import { buildDescribedBy, FormHelpMessage, helpFor, } from '../_private/forms';
import { generateUniqueId } from '../_private/UniqueId';
import { Text } from '../Text';
import { useRadioGroup } from './useRadioGroup';
import mergeRefs from 'react-merge-refs';
import { Tooltip } from '../Tooltip';
export var RadioStylesKey = 'ChromaRadio';
export var useStyles = makeStyles(function (theme) { return ({
    root: {
        cursor: 'pointer',
        display: 'flex',
        '& > input[type="radio"]::after': {
            opacity: 0,
            transition: 'transform .3s cubic-bezier(.2, .85, .32, 1.2), opacity .2s',
        },
        '& > input[type="radio"]:checked::after': {
            opacity: 1,
        },
    },
    input: {
        background: 'rgba(132, 137, 166, 0.15)',
        border: '1px solid transparent',
        borderRadius: '50%',
        cursor: 'pointer',
        display: 'inline-block',
        height: theme.pxToRem(21),
        margin: 0,
        MozAppearance: 'none',
        outline: 'none',
        position: 'relative',
        transition: 'background .3s, border-color .3s, box-shadow .2s',
        verticalAlign: 'top',
        WebkitAppearance: 'none',
        width: theme.pxToRem(21),
        '&:after': {
            background: theme.palette.common.white,
            borderRadius: '50%',
            content: '" "',
            display: 'block',
            position: 'absolute',
            top: 0,
            left: 0,
            transform: 'scale(0.5)',
            height: theme.pxToRem(19),
            width: theme.pxToRem(19),
        },
        '&:checked': {
            background: theme.palette.primary.main,
        },
        '&:disabled': {
            cursor: 'not-allowed',
            opacity: 0.625,
            // Ensure the label sibling cannot be clicked as well
            '& + label': {
                cursor: 'not-allowed',
            },
        },
        '&:focus': {
            boxShadow: '0 0 0 2px rgba(0, 150, 225, .3)',
        },
        '&:hover:not(:disabled):not(:checked)': {
            border: "1px solid ".concat(theme.palette.primary[700]),
        },
    },
    inputInverse: {
        backgroundColor: 'rgba(230, 231, 237, 0.1)',
        '&:checked': {
            backgroundColor: 'rgba(230, 231, 237, 0.1)',
            border: "1px solid rgba(230, 231, 237, 0.55)",
        },
        '&:focus': {
            boxShadow: '0 0 0 2px rgba(255, 255, 255, .3)',
        },
        '&:hover:not(:disabled):not(:checked)': {
            border: "1px solid ".concat(theme.palette.common.white),
        },
    },
    labelContainer: {
        flex: 1,
        marginLeft: theme.spacing(1),
    },
    label: {
        cursor: 'pointer',
        display: 'inline-block',
        marginBottom: 0,
        marginTop: theme.spacing(0.25),
        verticalAlign: 'top',
        '& p': {
            lineHeight: 1.25,
        },
    },
    labelInverse: {
        color: theme.palette.common.white,
    },
    icon: {
        height: theme.pxToRem(16),
        width: theme.pxToRem(16),
    },
    iconWithLabel: {
        marginRight: theme.spacing(0.5),
    },
    tooltipContainer: {
        display: 'flex',
        outline: 'none',
    },
    tooltipContent: {
        display: 'flex',
        height: theme.pxToRem(16),
    },
}); }, { name: RadioStylesKey });
export var Radio = React.forwardRef(function (_a, ref) {
    var _b;
    var ariaLabel = _a["aria-label"], className = _a.className, children = _a.children, _c = _a.checked, checked = _c === void 0 ? false : _c, color = _a.color, helpMessage = _a.helpMessage, Icon = _a.icon, id = _a.id, label = _a.label, value = _a.value, rootProps = __rest(_a, ['aria-label', "className", "children", "checked", "color", "helpMessage", "icon", "id", "label", "value"]);
    var inputRef = React.useRef(null);
    var classes = useStyles({});
    var uniqueId = React.useState(function () { return id || generateUniqueId('radio-'); })[0];
    var _d = useRadioGroup(), colorFromContext = _d.color, nameFromContext = _d.name, valueFromContext = _d.value, onChangeFromContext = _d.onChange;
    var handleChange = function (e) {
        onChangeFromContext && onChangeFromContext(e);
    };
    var renderIcon = function () {
        return Icon && (React.createElement(Icon, { className: clsx(classes.icon, label && classes.iconWithLabel, color === 'inverse' || colorFromContext === 'inverse'
                ? classes.labelInverse
                : undefined) }));
    };
    return (
    // eslint-disable-next-line jsx-a11y/no-static-element-interactions
    React.createElement("div", { className: clsx(classes.root, className), onClick: function () { var _a; return (_a = inputRef === null || inputRef === void 0 ? void 0 : inputRef.current) === null || _a === void 0 ? void 0 : _a.click(); } },
        React.createElement("input", __assign({ "aria-describedby": buildDescribedBy({
                hasHelpMessage: !!helpMessage,
                uniqueId: uniqueId,
            }), "aria-label": ariaLabel, className: clsx(classes.input, (_b = {},
                _b[classes.inputInverse] = color === 'inverse' || colorFromContext === 'inverse',
                _b)), ref: mergeRefs([inputRef, ref]), role: "radio", type: "radio", id: uniqueId, tabIndex: 0, name: nameFromContext, value: value, onChange: handleChange, checked: checked || valueFromContext
                ? valueFromContext === value || checked
                : undefined }, rootProps)),
        React.createElement("div", { className: classes.labelContainer },
            Icon && (React.createElement(React.Fragment, null, label ? (renderIcon()) : (React.createElement(Tooltip, { className: classes.tooltipContainer, title: ariaLabel },
                React.createElement("span", { className: classes.tooltipContent }, renderIcon()))))),
            React.createElement("label", { className: classes.label, htmlFor: uniqueId },
                React.createElement(Text, { size: "subbody", className: color === 'inverse' || colorFromContext === 'inverse'
                        ? classes.labelInverse
                        : undefined }, label)),
            helpMessage && (React.createElement(FormHelpMessage, { color: color || colorFromContext, rootElementId: uniqueId, describedById: helpFor(uniqueId) }, helpMessage))),
        children));
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmFkaW8uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy9SYWRpby9SYWRpby50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLE9BQU8sSUFBSSxNQUFNLE1BQU0sQ0FBQztBQUN4QixPQUFPLEtBQUssS0FBSyxNQUFNLE9BQU8sQ0FBQztBQUMvQixPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBRTFDLE9BQU8sRUFFTCxnQkFBZ0IsRUFDaEIsZUFBZSxFQUNmLE9BQU8sR0FDUixNQUFNLG1CQUFtQixDQUFDO0FBQzNCLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3hELE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxTQUFTLENBQUM7QUFDL0IsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ2hELE9BQU8sU0FBUyxNQUFNLGtCQUFrQixDQUFDO0FBQ3pDLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFFckMsTUFBTSxDQUFDLElBQU0sY0FBYyxHQUFHLGFBQWEsQ0FBQztBQUU1QyxNQUFNLENBQUMsSUFBTSxTQUFTLEdBQUcsVUFBVSxDQUNqQyxVQUFDLEtBQUssSUFBSyxPQUFBLENBQUM7SUFDVixJQUFJLEVBQUU7UUFDSixNQUFNLEVBQUUsU0FBUztRQUNqQixPQUFPLEVBQUUsTUFBTTtRQUNmLGdDQUFnQyxFQUFFO1lBQ2hDLE9BQU8sRUFBRSxDQUFDO1lBQ1YsVUFBVSxFQUNSLDREQUE0RDtTQUMvRDtRQUNELHdDQUF3QyxFQUFFO1lBQ3hDLE9BQU8sRUFBRSxDQUFDO1NBQ1g7S0FDRjtJQUNELEtBQUssRUFBRTtRQUNMLFVBQVUsRUFBRSwyQkFBMkI7UUFDdkMsTUFBTSxFQUFFLHVCQUF1QjtRQUMvQixZQUFZLEVBQUUsS0FBSztRQUNuQixNQUFNLEVBQUUs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LFVBQVUsRUFBRSxDQUNiLENBQUMsQ0FBQyxDQUFDLENBQ0Ysb0JBQUMsT0FBTyxJQUFDLFNBQVMsRUFBRSxPQUFPLENBQUMsZ0JBQWdCLEVBQUUsS0FBSyxFQUFFLFNBQVM7Z0JBQzVELDhCQUFNLFNBQVMsRUFBRSxPQUFPLENBQUMsY0FBYyxJQUFHLFVBQVUsRUFBRSxDQUFRLENBQ3RELENBQ1gsQ0FDQSxDQUNKO1lBRUQsK0JBQU8sU0FBUyxFQUFFLE9BQU8sQ0FBQyxLQUFLLEVBQUUsT0FBTyxFQUFFLFFBQVE7Z0JBQ2hELG9CQUFDLElBQUksSUFDSCxJQUFJLEVBQUMsU0FBUyxFQUNkLFNBQVMsRUFDUCxLQUFLLEtBQUssU0FBUyxJQUFJLGdCQUFnQixLQUFLLFNBQVM7d0JBQ25ELENBQUMsQ0FBQyxPQUFPLENBQUMsWUFBWTt3QkFDdEIsQ0FBQyxDQUFDLFNBQVMsSUFHZCxLQUFLLENBQ0QsQ0FDRDtZQUNQLFdBQVcsSUFBSSxDQUNkLG9CQUFDLGVBQWUsSUFDZCxLQUFLLEVBQUUsS0FBSyxJQUFJLGdCQUFnQixFQUNoQyxhQUFhLEVBQUUsUUFBUSxFQUN2QixhQUFhLEVBQUUsT0FBTyxDQUFDLFFBQVEsQ0FBQyxJQUUvQixXQUFXLENBQ0ksQ0FDbkIsQ0FDRztRQUNMLFFBQVEsQ0FDTCxDQUNQLENBQUM7QUFDSixDQUFDLENBQ0YsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjbHN4IGZyb20gJ2Nsc3gnO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgbWFrZVN0eWxlcyB9IGZyb20gJy4uLy4uL3N0eWxlcyc7XG5pbXBvcnQgeyBHZXRDbGFzc2VzIH0gZnJvbSAnLi4vLi4vdHlwZVV0aWxzJztcbmltcG9ydCB7XG4gIEJhc2VGb3JtRWxlbWVudCxcbiAgYnVpbGREZXNjcmliZWRCeSxcbiAgRm9ybUhlbHBNZXNzYWdlLFxuICBoZWxwRm9yLFxufSBmcm9tICcuLi9fcHJpdmF0ZS9mb3Jtcyc7XG5pbXBvcnQgeyBnZW5lcmF0ZVVuaXF1ZUlkIH0gZnJvbSAnLi4vX3ByaXZhdGUvVW5pcXVlSWQnO1xuaW1wb3J0IHsgVGV4dCB9IGZyb20gJy4uL1RleHQnO1xuaW1wb3J0IHsgdXNlUmFkaW9Hcm91cCB9IGZyb20gJy4vdXNlUmFkaW9Hcm91cCc7XG5pbXBvcnQgbWVyZ2VSZWZzIGZyb20gJ3JlYWN0LW1lcmdlLXJlZnMnO1xuaW1wb3J0IHsgVG9vbHRpcCB9IGZyb20gJy4uL1Rvb2x0aXAnO1xuXG5leHBvcnQgY29uc3QgUmFkaW9TdHlsZXNLZXkgPSAnQ2hyb21hUmFkaW8nO1xuXG5leHBvcnQgY29uc3QgdXNlU3R5bGVzID0gbWFrZVN0eWxlcyhcbiAgKHRoZW1lKSA9PiAoe1xuICAgIHJvb3Q6IHtcbiAgICAgIGN1cnNvcjogJ3BvaW50ZXInLFxuICAgICAgZGlzcGxheTogJ2ZsZXgnLFxuICAgICAgJyYgPiBpbnB1dFt0eXBlPVwicmFkaW9cIl06OmFmdGVyJzoge1xuICAgICAgICBvcGFjaXR5OiAwLFxuICAgICAgICB0cmFuc2l0aW9uOlxuICAgICAgICAgICd0cmFuc2Zvcm0gLjNzIGN1YmljLWJlemllciguMiwgLjg1LCAuMzIsIDEuMiksIG9wYWNpdHkgLjJzJyxcbiAgICAgIH0sXG4gICAgICAnJiA+IGlucHV0W3R5cGU9XCJyYWRpb1wiXTpjaGVja2VkOjphZnRlcic6IHtcbiAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBpbnB1dDoge1xuICAgICAgYmFja2dyb3VuZDogJ3JnYmEoMTMyLCAxMzcsIDE2NiwgMC4xNSknLFxuICAgICAgYm9yZGVyOiAnMXB4IHNvbGlkIHRyYW5zcGFyZW50JyxcbiAgICAgIGJvcmRlclJhZGl1czogJzUwJScsXG4gICAgICBjdXJzb3I6ICdwb2ludGVyJyxcbiAgICAgIGRpc3BsYXk6ICdpbmxpbmUtYmxvY2snLFxuICAgICAgaGVpZ2h0OiB0aGVtZS5weFRvUmVtKDIxKSxcbiAgICAgIG1hcmdpbjogMCxcbiAgICAgIE1vekFwcGVhcmFuY2U6ICdub25lJyxcbiAgICAgIG91dGxpbmU6ICdub25lJyxcbiAgICAgIHBvc2l0aW9uOiAncmVsYXRpdmUnLFxuICAgICAgdHJhbnNpdGlvbjogJ2JhY2tncm91bmQgLjNzLCBib3JkZXItY29sb3IgLjNzLCBib3gtc2hhZG93IC4ycycsXG4gICAgICB2ZXJ0aWNhbEFsaWduOiAndG9wJyxcbiAgICAgIFdlYmtpdEFwcGVhcmFuY2U6ICdub25lJyxcbiAgICAgIHdpZHRoOiB0aGVtZS5weFRvUmVtKDIxKSxcbiAgICAgICcmOmFmdGVyJzoge1xuICAgICAgICBiYWNrZ3JvdW5kOiB0aGVtZS5wYWxldHRlLmNvbW1vbi53aGl0ZSxcbiAgICAgICAgYm9yZGVyUmFkaXVzOiAnNTAlJyxcbiAgICAgICAgY29udGVudDogJ1wiIFwiJyxcbiAgICAgICAgZGlzcGxheTogJ2Jsb2NrJyxcbiAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgICAgIHRvcDogMCxcbiAgICAgICAgbGVmdDogMCxcbiAgICAgICAgdHJhbnNmb3JtOiAnc2NhbGUoMC41KScsXG4gICAgICAgIGhlaWdodDogdGhlbWUucHhUb1JlbSgxOSksXG4gICAgICAgIHdpZHRoOiB0aGVtZS5weFRvUmVtKDE5KSxcbiAgICAgIH0sXG4gICAgICAnJjpjaGVja2VkJzoge1xuICAgICAgICBiYWNrZ3JvdW5kOiB0aGVtZS5wYWxldHRlLnByaW1hcnkubWFpbixcbiAgICAgIH0sXG4gICAgICAnJjpkaXNhYmxlZCc6IHtcbiAgICAgICAgY3Vyc29yOiAnbm90LWFsbG93ZWQnLFxuICAgICAgICBvcGFjaXR5OiAwLjYyNSxcbiAgICAgICAgLy8gRW5zdXJlIHRoZSBsYWJlbCBzaWJsaW5nIGNhbm5vdCBiZSBjbGlja2VkIGFzIHdlbGxcbiAgICAgICAgJyYgKyBsYWJlbCc6IHtcbiAgICAgICAgICBjdXJzb3I6ICdub3QtYWxsb3dlZCcsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgJyY6Zm9jdXMnOiB7XG4gICAgICAgIGJveFNoYWRvdzogJzAgMCAwIDJweCByZ2JhKDAsIDE1MCwgMjI1LCAuMyknLFxuICAgICAgfSxcbiAgICAgICcmOmhvdmVyOm5vdCg6ZGlzYWJsZWQpOm5vdCg6Y2hlY2tlZCknOiB7XG4gICAgICAgIGJvcmRlcjogYDFweCBzb2xpZCAke3RoZW1lLnBhbGV0dGUucHJpbWFyeVs3MDBdfWAsXG4gICAgICB9LFxuICAgIH0sXG4gICAgaW5wdXRJbnZlcnNlOiB7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6ICdyZ2JhKDIzMCwgMjMxLCAyMzcsIDAuMSknLFxuICAgICAgJyY6Y2hlY2tlZCc6IHtcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiAncmdiYSgyMzAsIDIzMSwgMjM3LCAwLjEpJyxcbiAgICAgICAgYm9yZGVyOiBgMXB4IHNvbGlkIHJnYmEoMjMwLCAyMzEsIDIzNywgMC41NSlgLFxuICAgICAgfSxcbiAgICAgICcmOmZvY3VzJzoge1xuICAgICAgICBib3hTaGFkb3c6ICcwIDAgMCAycHggcmdiYSgyNTUsIDI1NSwgMjU1LCAuMyknLFxuICAgICAgfSxcbiAgICAgICcmOmhvdmVyOm5vdCg6ZGlzYWJsZWQpOm5vdCg6Y2hlY2tlZCknOiB7XG4gICAgICAgIGJvcmRlcjogYDFweCBzb2xpZCAke3RoZW1lLnBhbGV0dGUuY29tbW9uLndoaXRlfWAsXG4gICAgICB9LFxuICAgIH0sXG4gICAgbGFiZWxDb250YWluZXI6IHtcbiAgICAgIGZsZXg6IDEsXG4gICAgICBtYXJnaW5MZWZ0OiB0aGVtZS5zcGFjaW5nKDEpLFxuICAgIH0sXG4gICAgbGFiZWw6IHtcbiAgICAgIGN1cnNvcjogJ3BvaW50ZXInLFxuICAgICAgZGlzcGxheTogJ2lubGluZS1ibG9jaycsXG4gICAgICBtYXJnaW5Cb3R0b206IDAsXG4gICAgICBtYXJnaW5Ub3A6IHRoZW1lLnNwYWNpbmcoMC4yNSksXG4gICAgICB2ZXJ0aWNhbEFsaWduOiAndG9wJyxcbiAgICAgICcmIHAnOiB7XG4gICAgICAgIGxpbmVIZWlnaHQ6IDEuMjUsXG4gICAgICB9LFxuICAgIH0sXG4gICAgbGFiZWxJbnZlcnNlOiB7XG4gICAgICBjb2xvcjogdGhlbWUucGFsZXR0ZS5jb21tb24ud2hpdGUsXG4gICAgfSxcbiAgICBpY29uOiB7XG4gICAgICBoZWlnaHQ6IHRoZW1lLnB4VG9SZW0oMTYpLFxuICAgICAgd2lkdGg6IHRoZW1lLnB4VG9SZW0oMTYpLFxuICAgIH0sXG4gICAgaWNvbldpdGhMYWJlbDoge1xuICAgICAgbWFyZ2luUmlnaHQ6IHRoZW1lLnNwYWNpbmcoMC41KSxcbiAgICB9LFxuICAgIHRvb2x0aXBDb250YWluZXI6IHtcbiAgICAgIGRpc3BsYXk6ICdmbGV4JyxcbiAgICAgIG91dGxpbmU6ICdub25lJyxcbiAgICB9LFxuICAgIHRvb2x0aXBDb250ZW50OiB7XG4gICAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgICBoZWlnaHQ6IHRoZW1lLnB4VG9SZW0oMTYpLFxuICAgIH0sXG4gIH0pLFxuICB7IG5hbWU6IFJhZGlvU3R5bGVzS2V5IH1cbik7XG5cbmV4cG9ydCB0eXBlIFJhZGlvQ2xhc3NlcyA9IEdldENsYXNzZXM8dHlwZW9mIHVzZVN0eWxlcz47XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmFkaW9Qcm9wcyBleHRlbmRzIEJhc2VGb3JtRWxlbWVudCB7XG4gIGNoaWxkcmVuPzogUmVhY3QuUmVhY3ROb2RlO1xuICBpY29uPzogUmVhY3QuQ29tcG9uZW50VHlwZTxSZWFjdC5TVkdQcm9wczxTVkdTVkdFbGVtZW50Pj47XG59XG5cbmV4cG9ydCBjb25zdCBSYWRpbyA9IFJlYWN0LmZvcndhcmRSZWY8SFRNTElucHV0RWxlbWVudCwgUmFkaW9Qcm9wcz4oXG4gIChcbiAgICB7XG4gICAgICBbJ2FyaWEtbGFiZWwnXTogYXJpYUxhYmVsLFxuICAgICAgY2xhc3NOYW1lLFxuICAgICAgY2hpbGRyZW4sXG4gICAgICBjaGVja2VkID0gZmFsc2UsXG4gICAgICBjb2xvcixcbiAgICAgIGhlbHBNZXNzYWdlLFxuICAgICAgaWNvbjogSWNvbixcbiAgICAgIGlkLFxuICAgICAgbGFiZWwsXG4gICAgICB2YWx1ZSxcbiAgICAgIC4uLnJvb3RQcm9wc1xuICAgIH0sXG4gICAgcmVmXG4gICkgPT4ge1xuICAgIGNvbnN0IGlucHV0UmVmID0gUmVhY3QudXNlUmVmPEhUTUxJbnB1dEVsZW1lbnQ+KG51bGwpO1xuICAgIGNvbnN0IGNsYXNzZXMgPSB1c2VTdHlsZXMoe30pO1xuXG4gICAgY29uc3QgW3VuaXF1ZUlkXSA9IFJlYWN0LnVzZVN0YXRlPHN0cmluZz4oXG4gICAgICAoKSA9PiBpZCB8fCBnZW5lcmF0ZVVuaXF1ZUlkKCdyYWRpby0nKVxuICAgICk7XG5cbiAgICBjb25zdCB7XG4gICAgICBjb2xvcjogY29sb3JGcm9tQ29udGV4dCxcbiAgICAgIG5hbWU6IG5hbWVGcm9tQ29udGV4dCxcbiAgICAgIHZhbHVlOiB2YWx1ZUZyb21Db250ZXh0LFxuICAgICAgb25DaGFuZ2U6IG9uQ2hhbmdlRnJvbUNvbnRleHQsXG4gICAgfSA9IHVzZVJhZGlvR3JvdXAoKTtcblxuICAgIGNvbnN0IGhhbmRsZUNoYW5nZSA9IChlOiBSZWFjdC5DaGFuZ2VFdmVudDxIVE1MSW5wdXRFbGVtZW50PikgPT4ge1xuICAgICAgb25DaGFuZ2VGcm9tQ29udGV4dCAmJiBvbkNoYW5nZUZyb21Db250ZXh0KGUpO1xuICAgIH07XG5cbiAgICBjb25zdCByZW5kZXJJY29uID0gKCkgPT5cbiAgICAgIEljb24gJiYgKFxuICAgICAgICA8SWNvblxuICAgICAgICAgIGNsYXNzTmFtZT17Y2xzeChcbiAgICAgICAgICAgIGNsYXNzZXMuaWNvbixcbiAgICAgICAgICAgIGxhYmVsICYmIGNsYXNzZXMuaWNvbldpdGhMYWJlbCxcbiAgICAgICAgICAgIGNvbG9yID09PSAnaW52ZXJzZScgfHwgY29sb3JGcm9tQ29udGV4dCA9PT0gJ2ludmVyc2UnXG4gICAgICAgICAgICAgID8gY2xhc3Nlcy5sYWJlbEludmVyc2VcbiAgICAgICAgICAgICAgOiB1bmRlZmluZWRcbiAgICAgICAgICApfVxuICAgICAgICAvPlxuICAgICAgKTtcblxuICAgIHJldHVybiAoXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUganN4LWExMXkvbm8tc3RhdGljLWVsZW1lbnQtaW50ZXJhY3Rpb25zXG4gICAgICA8ZGl2XG4gICAgICAgIGNsYXNzTmFtZT17Y2xzeChjbGFzc2VzLnJvb3QsIGNsYXNzTmFtZSl9XG4gICAgICAgIG9uQ2xpY2s9eygpID0+IGlucHV0UmVmPy5jdXJyZW50Py5jbGljaygpfVxuICAgICAgPlxuICAgICAgICA8aW5wdXRcbiAgICAgICAgICBhcmlhLWRlc2NyaWJlZGJ5PXtidWlsZERlc2NyaWJlZEJ5KHtcbiAgICAgICAgICAgIGhhc0hlbHBNZXNzYWdlOiAhIWhlbHBNZXNzYWdlLFxuICAgICAgICAgICAgdW5pcXVlSWQsXG4gICAgICAgICAgfSl9XG4gICAgICAgICAgYXJpYS1sYWJlbD17YXJpYUxhYmVsfVxuICAgICAgICAgIGNsYXNzTmFtZT17Y2xzeChjbGFzc2VzLmlucHV0LCB7XG4gICAgICAgICAgICBbY2xhc3Nlcy5pbnB1dEludmVyc2VdOlxuICAgICAgICAgICAgICBjb2xvciA9PT0gJ2ludmVyc2UnIHx8IGNvbG9yRnJvbUNvbnRleHQgPT09ICdpbnZlcnNlJyxcbiAgICAgICAgICB9KX1cbiAgICAgICAgICByZWY9e21lcmdlUmVmcyhbaW5wdXRSZWYsIHJlZl0pfVxuICAgICAgICAgIHJvbGU9XCJyYWRpb1wiXG4gICAgICAgICAgdHlwZT1cInJhZGlvXCJcbiAgICAgICAgICBpZD17dW5pcXVlSWR9XG4gICAgICAgICAgdGFiSW5kZXg9ezB9XG4gICAgICAgICAgbmFtZT17bmFtZUZyb21Db250ZXh0fVxuICAgICAgICAgIHZhbHVlPXt2YWx1ZX1cbiAgICAgICAgICBvbkNoYW5nZT17aGFuZGxlQ2hhbmdlfVxuICAgICAgICAgIGNoZWNrZWQ9e1xuICAgICAgICAgICAgY2hlY2tlZCB8fCB2YWx1ZUZyb21Db250ZXh0XG4gICAgICAgICAgICAgID8gdmFsdWVGcm9tQ29udGV4dCA9PT0gdmFsdWUgfHwgY2hlY2tlZFxuICAgICAgICAgICAgICA6IHVuZGVmaW5lZFxuICAgICAgICAgIH1cbiAgICAgICAgICB7Li4ucm9vdFByb3BzfVxuICAgICAgICAvPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT17Y2xhc3Nlcy5sYWJlbENvbnRhaW5lcn0+XG4gICAgICAgICAge0ljb24gJiYgKFxuICAgICAgICAgICAgPD5cbiAgICAgICAgICAgICAge2xhYmVsID8gKFxuICAgICAgICAgICAgICAgIHJlbmRlckljb24oKVxuICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgIDxUb29sdGlwIGNsYXNzTmFtZT17Y2xhc3Nlcy50b29sdGlwQ29udGFpbmVyfSB0aXRsZT17YXJpYUxhYmVsfT5cbiAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT17Y2xhc3Nlcy50b29sdGlwQ29udGVudH0+e3JlbmRlckljb24oKX08L3NwYW4+XG4gICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC8+XG4gICAgICAgICAgKX1cblxuICAgICAgICAgIDxsYWJlbCBjbGFzc05hbWU9e2NsYXNzZXMubGFiZWx9IGh0bWxGb3I9e3VuaXF1ZUlkfT5cbiAgICAgICAgICAgIDxUZXh0XG4gICAgICAgICAgICAgIHNpemU9XCJzdWJib2R5XCJcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPXtcbiAgICAgICAgICAgICAgICBjb2xvciA9PT0gJ2ludmVyc2UnIHx8IGNvbG9yRnJvbUNvbnRleHQgPT09ICdpbnZlcnNlJ1xuICAgICAgICAgICAgICAgICAgPyBjbGFzc2VzLmxhYmVsSW52ZXJzZVxuICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7bGFiZWx9XG4gICAgICAgICAgICA8L1RleHQ+XG4gICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgICB7aGVscE1lc3NhZ2UgJiYgKFxuICAgICAgICAgICAgPEZvcm1IZWxwTWVzc2FnZVxuICAgICAgICAgICAgICBjb2xvcj17Y29sb3IgfHwgY29sb3JGcm9tQ29udGV4dH1cbiAgICAgICAgICAgICAgcm9vdEVsZW1lbnRJZD17dW5pcXVlSWR9XG4gICAgICAgICAgICAgIGRlc2NyaWJlZEJ5SWQ9e2hlbHBGb3IodW5pcXVlSWQpfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7aGVscE1lc3NhZ2V9XG4gICAgICAgICAgICA8L0Zvcm1IZWxwTWVzc2FnZT5cbiAgICAgICAgICApfVxuICAgICAgICA8L2Rpdj5cbiAgICAgICAge2NoaWxkcmVufVxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxuKTtcbiJdfQ==