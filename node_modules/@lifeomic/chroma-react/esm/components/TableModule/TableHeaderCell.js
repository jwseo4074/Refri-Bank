var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};
import clsx from 'clsx';
import * as React from 'react';
import { ChevronDown } from '@lifeomic/chromicons';
import { makeStyles } from '../../styles/index';
export var TableHeaderCellStylesKey = 'ChromaTableHeaderCell';
export var useStyles = makeStyles(function (theme) { return ({
    root: {
        transition: 'color 0.25s ease',
        background: theme.palette.common.white,
        borderCollapse: 'collapse',
        borderSpacing: 0,
        fontSize: theme.typography.caption.fontSize,
        fontWeight: theme.typography.fontWeightBold,
        lineHeight: theme.pxToRem(22),
        paddingBottom: theme.spacing(1.75),
        paddingLeft: theme.spacing(2),
        // Intentional additional padding-right to account for the
        // sort chevron
        paddingRight: theme.spacing(2.5),
        paddingTop: theme.spacing(1.75),
        position: 'sticky',
        textAlign: 'left',
        top: 0,
        whiteSpace: 'nowrap',
        zIndex: 3,
        '&::after': {
            content: "''",
            position: 'absolute',
            left: 0,
            width: '100%',
            bottom: 0,
            borderBottom: "4px solid ".concat(theme.palette.primary.main),
        },
        // First and last headers have additional spacing intentionally
        '&:first-child': {
            paddingLeft: theme.spacing(4),
        },
        '&:last-child': {
            paddingRight: theme.spacing(4),
        },
    },
    rootAlignRight: {
        textAlign: 'right',
    },
    rootPeekIconHover: {
        '&:hover': {
            '& > svg': {
                display: 'inline',
            },
        },
    },
    clickable: {
        cursor: 'pointer',
        userSelect: 'none',
        '&:hover': {
            color: theme.palette.black[500],
            '& > *': {
                color: theme.palette.black[500],
            },
        },
    },
    icon: {
        transition: 'color 0.25s ease, opacity 0.25s ease, transform 0.25s ease',
        margin: theme.spacing(0.375, 0, 0, 0.5),
        color: theme.palette.black.main,
        position: 'absolute',
        top: '25%',
    },
    peekIcon: {
        // we rely on hovering of the root element to set this to
        // visible (see rootPeekIconHover)
        display: 'none',
        opacity: 0.5,
    },
    rotatedIcon: {
        transform: 'rotate(180deg)',
    },
}); }, { name: TableHeaderCellStylesKey });
export var TableHeaderCell = function (_a) {
    var header = _a.header, _b = _a.isSorting, isSorting = _b === void 0 ? false : _b, sortDirection = _a.sortDirection, onClick = _a.onClick, index = _a.index, headingsCount = _a.headingsCount, rootProps = __rest(_a, ["header", "isSorting", "sortDirection", "onClick", "index", "headingsCount"]);
    var classes = useStyles({});
    var handleClick = function () {
        onClick === null || onClick === void 0 ? void 0 : onClick({ index: index, sortDirection: sortDirection, header: header });
    };
    var canSort = onClick && header.onSort;
    var Tag = !(header === null || header === void 0 ? void 0 : header.content) && !header.label ? 'td' : 'th';
    return (React.createElement(Tag, __assign({ className: clsx(classes.root, header.onSort && classes.clickable, canSort && classes.rootPeekIconHover, 
        // Rules of alignment:
        // - `header.align` wins over default behavior
        // - If this is the first header and there is only one column for the table
        //   then it is left-aligned
        // - If this is the last header and there is more than one column, then
        //   it is right-aligned
        // - Allow for left alignment override on last header
        // - Fallback behavior is left aligned (specified by root class)
        ((!header.align && headingsCount > 1 && index === headingsCount - 1) ||
            (header === null || header === void 0 ? void 0 : header.align) === 'right') &&
            classes.rootAlignRight, header.className), onClick: canSort ? handleClick : undefined, role: "columnheader", "aria-sort": !isSorting || !sortDirection
            ? 'none'
            : sortDirection === 'asc'
                ? 'ascending'
                : 'descending' }, rootProps),
        header.content ? header.content(header) : header.label,
        (!sortDirection || !isSorting) && canSort && (React.createElement(ChevronDown, { className: clsx(classes.icon, classes.peekIcon, classes.rotatedIcon), role: "img", "aria-hidden": true, width: 18, height: 18 })),
        isSorting && sortDirection && (React.createElement(ChevronDown, { className: clsx(classes.icon, sortDirection === 'asc' && classes.rotatedIcon), role: "img", "aria-hidden": true, width: 18, height: 18 }))));
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGFibGVIZWFkZXJDZWxsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvVGFibGVNb2R1bGUvVGFibGVIZWFkZXJDZWxsLnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsT0FBTyxJQUFJLE1BQU0sTUFBTSxDQUFDO0FBQ3hCLE9BQU8sS0FBSyxLQUFLLE1BQU0sT0FBTyxDQUFDO0FBQy9CLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNuRCxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFJaEQsTUFBTSxDQUFDLElBQU0sd0JBQXdCLEdBQUcsdUJBQXVCLENBQUM7QUFFaEUsTUFBTSxDQUFDLElBQU0sU0FBUyxHQUFHLFVBQVUsQ0FDakMsVUFBQyxLQUFLLElBQUssT0FBQSxDQUFDO0lBQ1YsSUFBSSxFQUFFO1FBQ0osVUFBVSxFQUFFLGtCQUFrQjtRQUM5QixVQUFVLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSztRQUN0QyxjQUFjLEVBQUUsVUFBVTtRQUMxQixhQUFhLEVBQUUsQ0FBQztRQUNoQixRQUFRLEVBQUUsS0FBSyxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsUUFBUTtRQUMzQyxVQUFVLEVBQUUsS0FBSyxDQUFDLFVBQVUsQ0FBQyxjQUFjO1FBQzNDLFVBQVUsRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQztRQUM3QixhQUFhLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUM7UUFDbEMsV0FBVyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1FBQzdCLDBEQUEwRDtRQUMxRCxlQUFlO1FBQ2YsWUFBWSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDO1FBQ2hDLFVBQVUsRUFBRSxLQUFLLENBQUMsT0FBTyxD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LEtBQUssRUFBRSxFQUFFLEVBQ1QsTUFBTSxFQUFFLEVBQUUsR0FDVixDQUNIO1FBRUEsU0FBUyxJQUFJLGFBQWEsSUFBSSxDQUM3QixvQkFBQyxXQUFXLElBQ1YsU0FBUyxFQUFFLElBQUksQ0FDYixPQUFPLENBQUMsSUFBSSxFQUNaLGFBQWEsS0FBSyxLQUFLLElBQUksT0FBTyxDQUFDLFdBQVcsQ0FDL0MsRUFDRCxJQUFJLEVBQUMsS0FBSyx1QkFFVixLQUFLLEVBQUUsRUFBRSxFQUNULE1BQU0sRUFBRSxFQUFFLEdBQ1YsQ0FDSCxDQUNHLENBQ1AsQ0FBQztBQUNKLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjbHN4IGZyb20gJ2Nsc3gnO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgQ2hldnJvbkRvd24gfSBmcm9tICdAbGlmZW9taWMvY2hyb21pY29ucyc7XG5pbXBvcnQgeyBtYWtlU3R5bGVzIH0gZnJvbSAnLi4vLi4vc3R5bGVzL2luZGV4JztcbmltcG9ydCB7IEdldENsYXNzZXMgfSBmcm9tICcuLi8uLi90eXBlVXRpbHMnO1xuaW1wb3J0IHsgVGFibGVTb3J0RGlyZWN0aW9uLCBUYWJsZUhlYWRlciwgVGFibGVTb3J0Q2xpY2tQcm9wcyB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgY29uc3QgVGFibGVIZWFkZXJDZWxsU3R5bGVzS2V5ID0gJ0Nocm9tYVRhYmxlSGVhZGVyQ2VsbCc7XG5cbmV4cG9ydCBjb25zdCB1c2VTdHlsZXMgPSBtYWtlU3R5bGVzKFxuICAodGhlbWUpID0+ICh7XG4gICAgcm9vdDoge1xuICAgICAgdHJhbnNpdGlvbjogJ2NvbG9yIDAuMjVzIGVhc2UnLFxuICAgICAgYmFja2dyb3VuZDogdGhlbWUucGFsZXR0ZS5jb21tb24ud2hpdGUsXG4gICAgICBib3JkZXJDb2xsYXBzZTogJ2NvbGxhcHNlJyxcbiAgICAgIGJvcmRlclNwYWNpbmc6IDAsXG4gICAgICBmb250U2l6ZTogdGhlbWUudHlwb2dyYXBoeS5jYXB0aW9uLmZvbnRTaXplLFxuICAgICAgZm9udFdlaWdodDogdGhlbWUudHlwb2dyYXBoeS5mb250V2VpZ2h0Qm9sZCxcbiAgICAgIGxpbmVIZWlnaHQ6IHRoZW1lLnB4VG9SZW0oMjIpLFxuICAgICAgcGFkZGluZ0JvdHRvbTogdGhlbWUuc3BhY2luZygxLjc1KSxcbiAgICAgIHBhZGRpbmdMZWZ0OiB0aGVtZS5zcGFjaW5nKDIpLFxuICAgICAgLy8gSW50ZW50aW9uYWwgYWRkaXRpb25hbCBwYWRkaW5nLXJpZ2h0IHRvIGFjY291bnQgZm9yIHRoZVxuICAgICAgLy8gc29ydCBjaGV2cm9uXG4gICAgICBwYWRkaW5nUmlnaHQ6IHRoZW1lLnNwYWNpbmcoMi41KSxcbiAgICAgIHBhZGRpbmdUb3A6IHRoZW1lLnNwYWNpbmcoMS43NSksXG4gICAgICBwb3NpdGlvbjogJ3N0aWNreScsXG4gICAgICB0ZXh0QWxpZ246ICdsZWZ0JyxcbiAgICAgIHRvcDogMCxcbiAgICAgIHdoaXRlU3BhY2U6ICdub3dyYXAnLFxuICAgICAgekluZGV4OiAzLFxuICAgICAgJyY6OmFmdGVyJzoge1xuICAgICAgICBjb250ZW50OiBgJydgLFxuICAgICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICAgICAgbGVmdDogMCxcbiAgICAgICAgd2lkdGg6ICcxMDAlJyxcbiAgICAgICAgYm90dG9tOiAwLFxuICAgICAgICBib3JkZXJCb3R0b206IGA0cHggc29saWQgJHt0aGVtZS5wYWxldHRlLnByaW1hcnkubWFpbn1gLFxuICAgICAgfSxcbiAgICAgIC8vIEZpcnN0IGFuZCBsYXN0IGhlYWRlcnMgaGF2ZSBhZGRpdGlvbmFsIHNwYWNpbmcgaW50ZW50aW9uYWxseVxuICAgICAgJyY6Zmlyc3QtY2hpbGQnOiB7XG4gICAgICAgIHBhZGRpbmdMZWZ0OiB0aGVtZS5zcGFjaW5nKDQpLFxuICAgICAgfSxcbiAgICAgICcmOmxhc3QtY2hpbGQnOiB7XG4gICAgICAgIHBhZGRpbmdSaWdodDogdGhlbWUuc3BhY2luZyg0KSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICByb290QWxpZ25SaWdodDoge1xuICAgICAgdGV4dEFsaWduOiAncmlnaHQnLFxuICAgIH0sXG4gICAgcm9vdFBlZWtJY29uSG92ZXI6IHtcbiAgICAgICcmOmhvdmVyJzoge1xuICAgICAgICAnJiA+IHN2Zyc6IHtcbiAgICAgICAgICBkaXNwbGF5OiAnaW5saW5lJyxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBjbGlja2FibGU6IHtcbiAgICAgIGN1cnNvcjogJ3BvaW50ZXInLFxuICAgICAgdXNlclNlbGVjdDogJ25vbmUnLFxuICAgICAgJyY6aG92ZXInOiB7XG4gICAgICAgIGNvbG9yOiB0aGVtZS5wYWxldHRlLmJsYWNrWzUwMF0sXG4gICAgICAgICcmID4gKic6IHtcbiAgICAgICAgICBjb2xvcjogdGhlbWUucGFsZXR0ZS5ibGFja1s1MDBdLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9LFxuICAgIGljb246IHtcbiAgICAgIHRyYW5zaXRpb246ICdjb2xvciAwLjI1cyBlYXNlLCBvcGFjaXR5IDAuMjVzIGVhc2UsIHRyYW5zZm9ybSAwLjI1cyBlYXNlJyxcbiAgICAgIG1hcmdpbjogdGhlbWUuc3BhY2luZygwLjM3NSwgMCwgMCwgMC41KSxcbiAgICAgIGNvbG9yOiB0aGVtZS5wYWxldHRlLmJsYWNrLm1haW4sXG4gICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICAgIHRvcDogJzI1JScsXG4gICAgfSxcbiAgICBwZWVrSWNvbjoge1xuICAgICAgLy8gd2UgcmVseSBvbiBob3ZlcmluZyBvZiB0aGUgcm9vdCBlbGVtZW50IHRvIHNldCB0aGlzIHRvXG4gICAgICAvLyB2aXNpYmxlIChzZWUgcm9vdFBlZWtJY29uSG92ZXIpXG4gICAgICBkaXNwbGF5OiAnbm9uZScsXG4gICAgICBvcGFjaXR5OiAwLjUsXG4gICAgfSxcbiAgICByb3RhdGVkSWNvbjoge1xuICAgICAgdHJhbnNmb3JtOiAncm90YXRlKDE4MGRlZyknLFxuICAgIH0sXG4gIH0pLFxuICB7IG5hbWU6IFRhYmxlSGVhZGVyQ2VsbFN0eWxlc0tleSB9XG4pO1xuXG5leHBvcnQgdHlwZSBUYWJsZUhlYWRlckNlbGxDbGFzc2VzID0gR2V0Q2xhc3Nlczx0eXBlb2YgdXNlU3R5bGVzPjtcblxuZXhwb3J0IGludGVyZmFjZSBUYWJsZUhlYWRlckNlbGxQcm9wcyBleHRlbmRzIFRhYmxlU29ydERpcmVjdGlvbiB7XG4gIGlzU29ydGluZz86IGJvb2xlYW47XG4gIGhlYWRlcjogVGFibGVIZWFkZXI7XG4gIG9uQ2xpY2s/OiAoaGVhZGVyOiBUYWJsZVNvcnRDbGlja1Byb3BzKSA9PiBhbnk7XG4gIGluZGV4OiBudW1iZXI7XG4gIGhlYWRpbmdzQ291bnQ6IG51bWJlcjtcbn1cblxuZXhwb3J0IGNvbnN0IFRhYmxlSGVhZGVyQ2VsbDogUmVhY3QuRkM8VGFibGVIZWFkZXJDZWxsUHJvcHM+ID0gKHtcbiAgaGVhZGVyLFxuICBpc1NvcnRpbmcgPSBmYWxzZSxcbiAgc29ydERpcmVjdGlvbixcbiAgb25DbGljayxcbiAgaW5kZXgsXG4gIGhlYWRpbmdzQ291bnQsXG4gIC4uLnJvb3RQcm9wc1xufSkgPT4ge1xuICBjb25zdCBjbGFzc2VzID0gdXNlU3R5bGVzKHt9KTtcblxuICBjb25zdCBoYW5kbGVDbGljayA9ICgpID0+IHtcbiAgICBvbkNsaWNrPy4oeyBpbmRleCwgc29ydERpcmVjdGlvbiwgaGVhZGVyIH0pO1xuICB9O1xuXG4gIGNvbnN0IGNhblNvcnQgPSBvbkNsaWNrICYmIGhlYWRlci5vblNvcnQ7XG5cbiAgY29uc3QgVGFnID0gIWhlYWRlcj8uY29udGVudCAmJiAhaGVhZGVyLmxhYmVsID8gJ3RkJyA6ICd0aCc7XG5cbiAgcmV0dXJuIChcbiAgICA8VGFnXG4gICAgICBjbGFzc05hbWU9e2Nsc3goXG4gICAgICAgIGNsYXNzZXMucm9vdCxcbiAgICAgICAgaGVhZGVyLm9uU29ydCAmJiBjbGFzc2VzLmNsaWNrYWJsZSxcbiAgICAgICAgY2FuU29ydCAmJiBjbGFzc2VzLnJvb3RQZWVrSWNvbkhvdmVyLFxuICAgICAgICAvLyBSdWxlcyBvZiBhbGlnbm1lbnQ6XG4gICAgICAgIC8vIC0gYGhlYWRlci5hbGlnbmAgd2lucyBvdmVyIGRlZmF1bHQgYmVoYXZpb3JcbiAgICAgICAgLy8gLSBJZiB0aGlzIGlzIHRoZSBmaXJzdCBoZWFkZXIgYW5kIHRoZXJlIGlzIG9ubHkgb25lIGNvbHVtbiBmb3IgdGhlIHRhYmxlXG4gICAgICAgIC8vICAgdGhlbiBpdCBpcyBsZWZ0LWFsaWduZWRcbiAgICAgICAgLy8gLSBJZiB0aGlzIGlzIHRoZSBsYXN0IGhlYWRlciBhbmQgdGhlcmUgaXMgbW9yZSB0aGFuIG9uZSBjb2x1bW4sIHRoZW5cbiAgICAgICAgLy8gICBpdCBpcyByaWdodC1hbGlnbmVkXG4gICAgICAgIC8vIC0gQWxsb3cgZm9yIGxlZnQgYWxpZ25tZW50IG92ZXJyaWRlIG9uIGxhc3QgaGVhZGVyXG4gICAgICAgIC8vIC0gRmFsbGJhY2sgYmVoYXZpb3IgaXMgbGVmdCBhbGlnbmVkIChzcGVjaWZpZWQgYnkgcm9vdCBjbGFzcylcbiAgICAgICAgKCghaGVhZGVyLmFsaWduICYmIGhlYWRpbmdzQ291bnQgPiAxICYmIGluZGV4ID09PSBoZWFkaW5nc0NvdW50IC0gMSkgfHxcbiAgICAgICAgICBoZWFkZXI/LmFsaWduID09PSAncmlnaHQnKSAmJlxuICAgICAgICAgIGNsYXNzZXMucm9vdEFsaWduUmlnaHQsXG4gICAgICAgIGhlYWRlci5jbGFzc05hbWVcbiAgICAgICl9XG4gICAgICBvbkNsaWNrPXtjYW5Tb3J0ID8gaGFuZGxlQ2xpY2sgOiB1bmRlZmluZWR9XG4gICAgICByb2xlPVwiY29sdW1uaGVhZGVyXCJcbiAgICAgIGFyaWEtc29ydD17XG4gICAgICAgICFpc1NvcnRpbmcgfHwgIXNvcnREaXJlY3Rpb25cbiAgICAgICAgICA/ICdub25lJ1xuICAgICAgICAgIDogc29ydERpcmVjdGlvbiA9PT0gJ2FzYydcbiAgICAgICAgICA/ICdhc2NlbmRpbmcnXG4gICAgICAgICAgOiAnZGVzY2VuZGluZydcbiAgICAgIH1cbiAgICAgIHsuLi5yb290UHJvcHN9XG4gICAgPlxuICAgICAge2hlYWRlci5jb250ZW50ID8gaGVhZGVyLmNvbnRlbnQoaGVhZGVyKSA6IGhlYWRlci5sYWJlbH1cbiAgICAgIHsvKiBXZSBhcmVuJ3QgYWN0aXZlbHkgc29ydGluZyB0aGlzIGNvbHVtbiwgYnV0IHdlIHdhbnQgdG8gZGlzcGxheSBhIFwicGVla1wiIGljb24gc28gdGhleSBrbm93IHRoZXkgY2FuIHNvcnQgaXQgKi99XG4gICAgICB7KCFzb3J0RGlyZWN0aW9uIHx8ICFpc1NvcnRpbmcpICYmIGNhblNvcnQgJiYgKFxuICAgICAgICA8Q2hldnJvbkRvd25cbiAgICAgICAgICBjbGFzc05hbWU9e2Nsc3goY2xhc3Nlcy5pY29uLCBjbGFzc2VzLnBlZWtJY29uLCBjbGFzc2VzLnJvdGF0ZWRJY29uKX1cbiAgICAgICAgICByb2xlPVwiaW1nXCJcbiAgICAgICAgICBhcmlhLWhpZGRlblxuICAgICAgICAgIHdpZHRoPXsxOH1cbiAgICAgICAgICBoZWlnaHQ9ezE4fVxuICAgICAgICAvPlxuICAgICAgKX1cbiAgICAgIHsvKiBXZSBoYXZlIGEgc29ydCBhY3RpdmUgKi99XG4gICAgICB7aXNTb3J0aW5nICYmIHNvcnREaXJlY3Rpb24gJiYgKFxuICAgICAgICA8Q2hldnJvbkRvd25cbiAgICAgICAgICBjbGFzc05hbWU9e2Nsc3goXG4gICAgICAgICAgICBjbGFzc2VzLmljb24sXG4gICAgICAgICAgICBzb3J0RGlyZWN0aW9uID09PSAnYXNjJyAmJiBjbGFzc2VzLnJvdGF0ZWRJY29uXG4gICAgICAgICAgKX1cbiAgICAgICAgICByb2xlPVwiaW1nXCJcbiAgICAgICAgICBhcmlhLWhpZGRlblxuICAgICAgICAgIHdpZHRoPXsxOH1cbiAgICAgICAgICBoZWlnaHQ9ezE4fVxuICAgICAgICAvPlxuICAgICAgKX1cbiAgICA8L1RhZz5cbiAgKTtcbn07XG4iXX0=