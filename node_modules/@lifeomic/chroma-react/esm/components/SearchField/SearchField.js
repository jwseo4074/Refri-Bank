var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};
import clsx from 'clsx';
import * as React from 'react';
import { makeStyles } from '../../styles';
import { buildDescribedBy, FormHelpMessage, helpFor, } from '../_private/forms';
import { generateUniqueId } from '../_private/UniqueId';
import { clearClipPath, defaultClipPath } from './clipPaths';
export var SearchFieldStylesKey = 'ChromaSearchField';
export var useStyles = makeStyles(function (theme) { return ({
    root: {
        position: 'relative',
    },
    input: {
        backgroundColor: 'rgba(132, 137, 166, 0.15)',
        border: "1px solid transparent",
        borderRadius: theme.pxToRem(4),
        color: theme.palette.text.primary,
        fontFamily: theme.typography.fontFamily,
        fontSize: theme.pxToRem(14),
        lineHeight: 1.25,
        paddingLeft: theme.spacing(1.25),
        // Requires more paddingRight so we give the search icon enough
        // room when the text inside the search field is long.
        paddingRight: theme.spacing(3.75),
        transition: 'border 0.25s ease',
        maxWidth: theme.pxToRem(173),
        '&:focus': {
            outline: 'none',
            backgroundColor: 'rgba(255, 255, 255, 0.5)',
            border: "1px solid rgba(132, 137, 166, 0.45)",
        },
        '&:disabled': {
            cursor: 'not-allowed',
            opacity: 0.625,
            '& + $button': {
                cursor: 'not-allowed',
                opacity: 0.625,
            },
        },
        '&::-webkit-input-placeholder': {
            color: theme.palette.black[400],
        },
        '&::-moz-placeholder': {
            color: theme.palette.black[400],
        },
        '&:-ms-input-placeholder': {
            color: theme.palette.black[400],
        },
        '&:-moz-placeholder': {
            color: theme.palette.black[400],
        },
        // Hide the webkit clear (x) button
        '&::-webkit-search-decoration,&::-webkit-search-cancel-button,&::-webkit-search-results-button,&::-webkit-search-results-decoration': {
            display: 'none',
        },
    },
    inputInverse: {
        backgroundColor: 'rgba(230, 231, 237, 0.1)',
        color: theme.palette.common.white,
        '&:focus': {
            backgroundColor: 'rgba(230, 231, 237, 0.1)',
            border: "1px solid rgba(230, 231, 237, 0.55)",
        },
        '&::-webkit-input-placeholder': {
            color: 'rgba(255, 255, 255, 0.8)',
        },
        '&::-moz-placeholder': {
            color: 'rgba(255, 255, 255, 0.8)',
        },
        '&:-ms-input-placeholder': {
            color: 'rgba(255, 255, 255, 0.8)',
        },
        '&:-moz-placeholder': {
            color: 'rgba(255, 255, 255, 0.8)',
        },
    },
    inputHeight0: {
        paddingBottom: theme.spacing(0.5),
        paddingTop: theme.spacing(0.5),
    },
    inputHeight1: {
        paddingBottom: theme.spacing(1),
        paddingTop: theme.spacing(1),
    },
    fullWidth: {
        '& $input': {
            maxWidth: 'none',
            width: '100%',
        },
        '& $button': {
            left: 'auto',
            right: theme.pxToRem(5),
        },
    },
    button: {
        position: 'absolute',
        left: theme.pxToRem(144),
        alignItems: 'center',
        backgroundColor: 'transparent',
        border: 0,
        color: theme.palette.black[500],
        cursor: 'pointer',
        display: 'inline-flex',
        flex: '0 0 auto',
        justifyContent: 'center',
        margin: 0,
        outline: 'none',
        padding: 0,
        transition: 'color 0.25s ease, opacity 0.25s ease',
        userSelect: 'none',
    },
    buttonHeight0: {
        top: theme.pxToRem(0.25),
    },
    buttonHeight1: {
        top: theme.pxToRem(4),
    },
    buttonSvg: {
        width: theme.pxToRem(24),
        height: theme.pxToRem(24),
        // Glass
        '& > circle': {
            fill: 'transparent',
            stroke: theme.palette.black[500],
            strokeWidth: 6,
            strokeLinecap: 'round',
        },
        // Magnifying glass pole part
        '& > path': {
            fill: 'none',
            stroke: theme.palette.black[500],
            strokeDasharray: '10 50',
            strokeDashoffset: 20,
            strokeLinecap: 'round',
            strokeWidth: 7,
            transition: 'stroke-dasharray 200ms, stroke-dashoffset 200ms, stroke 200ms',
            '@media (prefers-reduced-motion: reduce)': {
                transition: 'none',
            },
        },
        // Background circle for glass and X clear
        '& > rect': {
            clipPath: defaultClipPath,
            WebkitClipPath: defaultClipPath,
            fill: 'transparent',
            transition: 'clip-path 100ms 100ms',
            '@media (prefers-reduced-motion: reduce)': {
                transition: 'none',
            },
        },
    },
    buttonSvgInverse: {
        '& > circle': {
            stroke: theme.palette.common.white,
        },
        '& > path': {
            stroke: theme.palette.common.white,
        },
    },
    buttonSvgClear: {
        marginTop: theme.spacing(0.125),
        '& > circle': {
            fill: theme.palette.black[500],
        },
        '& > path': {
            strokeDasharray: '24 50',
            strokeDashoffset: 74,
            stroke: theme.palette.common.white,
        },
        '& > rect': {
            clipPath: clearClipPath,
            WebkitClipPath: clearClipPath,
            fill: theme.palette.common.white,
            transition: 'clip-path 100ms',
            '@media (prefers-reduced-motion: reduce)': {
                transition: 'none',
            },
        },
    },
    buttonSvgClearInverse: {
        '& > circle': {
            fill: theme.palette.common.white,
            stroke: theme.palette.common.white,
        },
        '& > path': {
            stroke: theme.palette.blue[700],
        },
        '& > rect': {
            fill: theme.palette.blue[700],
        },
    },
    helpMessage: {
        marginTop: theme.spacing(1),
        marginLeft: 0,
    },
}); }, { name: SearchFieldStylesKey });
export var SearchField = React.forwardRef(function (_a, ref) {
    var _b, _c, _d;
    var className = _a.className, _e = _a.color, color = _e === void 0 ? 'default' : _e, _f = _a.disableClearOnSearch, disableClearOnSearch = _f === void 0 ? false : _f, fullWidth = _a.fullWidth, _g = _a.height, height = _g === void 0 ? 1 : _g, id = _a.id, name = _a.name, helpMessage = _a.helpMessage, onChange = _a.onChange, onSearch = _a.onSearch, onClear = _a.onClear, value = _a.value, rootProps = __rest(_a, ["className", "color", "disableClearOnSearch", "fullWidth", "height", "id", "name", "helpMessage", "onChange", "onSearch", "onClear", "value"]);
    var classes = useStyles({});
    var uniqueId = React.useState(function () { return id || name || generateUniqueId('searchField-'); })[0];
    var _h = React.useState(false), showClear = _h[0], setShowClear = _h[1];
    var _j = React.useState(''), searchText = _j[0], setSearchText = _j[1];
    var handleFocus = function (e) {
        if (e.target.value.length > 0) {
            setShowClear(true);
        }
    };
    var handleBlur = function () {
        if (searchText.length === 0) {
            setShowClear(false);
        }
    };
    var handleChange = function (e) {
        setSearchText(e.target.value);
        if (showClear && e.target.value.length === 0) {
            setShowClear(false);
        }
        if (!showClear && e.target.value.length > 0) {
            setShowClear(true);
        }
        onChange === null || onChange === void 0 ? void 0 : onChange(e);
    };
    var handleKeyPress = function (e) {
        if (e.key === 'Enter' && !disableClearOnSearch) {
            setShowClear(false);
            onSearch && onSearch(searchText);
            setSearchText('');
        }
        if (e.key === 'Enter' && disableClearOnSearch) {
            onSearch && onSearch(searchText);
        }
    };
    var handleClearButtonClick = function () {
        setSearchText('');
        setShowClear(false);
        onClear === null || onClear === void 0 ? void 0 : onClear();
        var input = document.getElementById(uniqueId);
        var event = new Event('change');
        input.value = '';
        input.dispatchEvent(event);
        onChange === null || onChange === void 0 ? void 0 : onChange(event);
    };
    return (React.createElement("div", { className: clsx(classes.root, fullWidth && classes.fullWidth, className) },
        React.createElement("input", __assign({ "aria-describedby": buildDescribedBy({
                hasHelpMessage: !!helpMessage,
                uniqueId: uniqueId,
            }), className: clsx(classes.input, (_b = {},
                _b[classes.inputInverse] = color === 'inverse',
                _b), (_c = {},
                _c[classes.inputHeight0] = height === 0,
                _c[classes.inputHeight1] = height === 1,
                _c)), id: uniqueId, name: name, ref: ref, type: "search", onChange: handleChange, onKeyPress: handleKeyPress, onFocus: handleFocus, onBlur: handleBlur, value: searchText }, rootProps)),
        React.createElement("button", { "aria-label": showClear ? 'Clear input' : 'Search', className: clsx(classes.button, (_d = {},
                _d[classes.buttonHeight0] = height === 0,
                _d[classes.buttonHeight1] = height === 1,
                _d)), tabIndex: -1, onClick: handleClearButtonClick },
            React.createElement("svg", { className: clsx(classes.buttonSvg, color === 'inverse' && classes.buttonSvgInverse, showClear && classes.buttonSvgClear, color === 'inverse' && showClear && classes.buttonSvgClearInverse), viewBox: "0 0 100 100", role: "img", "aria-hidden": true },
                React.createElement("circle", { r: "24.5", cy: "54.200001", cx: "45.700001" }),
                React.createElement("path", { d: "M 37.240349,46.733243 72.551185,82.414382" }),
                React.createElement("rect", { x: "0", y: "0", width: "100", height: "100" }))),
        helpMessage && (React.createElement(FormHelpMessage, { className: classes.helpMessage, color: color, rootElementId: uniqueId, describedById: helpFor(uniqueId) }, helpMessage))));
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU2VhcmNoRmllbGQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy9TZWFyY2hGaWVsZC9TZWFyY2hGaWVsZC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLE9BQU8sSUFBSSxNQUFNLE1BQU0sQ0FBQztBQUN4QixPQUFPLEtBQUssS0FBSyxNQUFNLE9BQU8sQ0FBQztBQUMvQixPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBRTFDLE9BQU8sRUFFTCxnQkFBZ0IsRUFDaEIsZUFBZSxFQUNmLE9BQU8sR0FDUixNQUFNLG1CQUFtQixDQUFDO0FBQzNCLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3hELE9BQU8sRUFBRSxhQUFhLEVBQUUsZUFBZSxFQUFFLE1BQU0sYUFBYSxDQUFDO0FBRTdELE1BQU0sQ0FBQyxJQUFNLG9CQUFvQixHQUFHLG1CQUFtQixDQUFDO0FBRXhELE1BQU0sQ0FBQyxJQUFNLFNBQVMsR0FBRyxVQUFVLENBQ2pDLFVBQUMsS0FBSyxJQUFLLE9BQUEsQ0FBQztJQUNWLElBQUksRUFBRTtRQUNKLFFBQVEsRUFBRSxVQUFVO0tBQ3JCO0lBQ0QsS0FBSyxFQUFFO1FBQ0wsZUFBZSxFQUFFLDJCQUEyQjtRQUM1QyxNQUFNLEVBQUUsdUJBQXVCO1FBQy9CLFlBQVksRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztRQUM5QixLQUFLLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTztRQUNqQyxVQUFVLEVBQUUsS0FBSyxDQUFDLFVBQVUsQ0FBQyxVQUFVO1FBQ3ZDLFFBQVEsRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQztRQUMzQixVQUFVLEVBQUUsSUFBSTtRQUNoQixXQUFXLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUM7UUFDaEMsK0RBQStEO1FBQy9ELHNEQUFzRDtRQUN0RCxZQUFZLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUM7UUFDakMsVUFBVSxFQUFFLG1CQUFtQjtRQUMvQixRQUFRLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUM7UUFDNUIsU0FBUyxFQUFFO1lBQ1QsT0FBTyxFQUFFLE1BQU07WUFDZixlQUFlLEVBQUUsMEJBQTBCO1lBQzNDLE1BQU0sRUFBRSxxQ0FBcUM7U0FDOUM7UUFDRCxZQUFZLEVBQUU7WUFDWixNQUFNLEVBQUUsYUFBYTtZQUNyQixPQUFPLEVBQUUsS0FBSztZQUNkLGFBQWEsRUFBRTtnQkFDYixNQUFNLEVBQUUsYUFBYTtnQkFDckIsT0FBTyxFQUFFLEtBQUs7YUFDZjtTQUNGO1FBQ0QsOEJBQThCLEVBQUU7WUFDOUIsS0FBSyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQztTQUNoQztRQUNELHFCQUFxQixFQUFFO1lBQ3JCLEtBQUssRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUM7U0FDaEM7UUFDRCx5QkFBeUIsRUFBRTtZQUN6QixLQUFLLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDO1NBQ2hDO1FBQ0Qsb0JBQW9CLEVBQUU7WUFDcEIsS0FBSyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQztTQUNoQztRQUNELG1DQUFtQztRQUNuQyxvSUFBb0ksRUFBRTtZQUNwSSxPQUFPLEVBQUUsTUFBTTtTQUNoQjtLQUNGO0lBQ0QsWUFBWSxFQUFFO1FBQ1osZUFBZSxFQUFFLDBCQUEwQjtRQUMzQyxLQUFLLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSztRQUNqQyxTQUFTLEVBQUU7WUFDVCxlQUFlLEVBQUUsMEJBQTBCO1lBQzNDLE1BQU0sRUFBRSxxQ0FBcUM7U0FDOUM7UUFDRCw4QkFBOEIsRUFBRTtZQUM5QixLQUFLLEVBQUUsMEJBQTBCO1NBQ2xDO1FBQ0QscUJBQXFCLEVBQUU7WUFDckIsS0FBSyxFQUFFLDBCQUEwQjtTQUNsQztRQUNELHlCQUF5QixFQUFFO1lBQ3pCLEtBQUssRUFBRSwwQkFBMEI7U0FDbEM7UUFDRCxvQkFBb0IsRUFBRTtZQUNwQixLQUFLLEVBQUUsMEJBQTBCO1NBQ2xDO0tBQ0Y7SUFDRCxZQUFZLEVBQUU7UUFDWixhQUFhLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUM7UUFDakMsVUFBVSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDO0tBQy9CO0lBQ0QsWUFBWSxFQUFFO1FBQ1osYUFBYSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1FBQy9CLFVBQVUsRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztLQUM3QjtJQUNELFNBQVMsRUFBRTtRQUNULFVBQVUsRUFBRTtZQUNWLFFBQVEsRUFBRSxNQUFNO1lBQ2hCLEtBQUssRUFBRSxNQUFNO1NBQ2Q7UUFDRCxXQUFXLEVBQUU7WUFDWCxJQUFJLEVBQUUsTUFBTTtZQUNaLEtBQUssRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztTQUN4QjtLQUNGO0lBQ0QsTUFBTSxFQUFFO1FBQ04sUUFBUSxFQUFFLFVBQVU7UUFDcEIsSUFBSSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDO1FBQ3hCLFVBQVUsRUFBRSxRQUFRO1FBQ3BCLGVBQWUsRUFBRSxhQUFhO1FBQzlCLE1BQU0sRUFBRSxDQUFDO1FBQ1QsS0FBSyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQztRQUMvQixNQUFNLEVBQUUsU0FBUztRQUNqQixPQUFPLEVBQUUsYUFBYTtRQUN0QixJQUFJLEVBQUUsVUFBVTtRQUNoQixjQUFjLEVBQUUsUUFBUTtRQUN4QixNQUFNLEVBQUUsQ0FBQztRQUNULE9BQU8sRUFBRSxNQUFNO1FBQ2YsT0FBTyxFQUFFLENBQUM7UUFDVixVQUFVLEVBQUUsc0NBQXNDO1FBQ2xELFVBQVUsRUFBRSxNQUFNO0tBQ25CO0lBQ0QsYUFBYSxFQUFFO1FBQ2IsR0FBRyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDO0tBQ3pCO0lBQ0QsYUFBYSxFQUFFO1FBQ2IsR0FBRyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO0tBQ3RCO0lBQ0QsU0FBUyxFQUFFO1FBQ1QsS0FBSyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDO1FBQ3hCLE1BQU0sRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQztRQUN6QixRQUFRO1FBQ1IsWUFBWSxFQUFFO1lBQ1osSUFBSSxFQUFFLGFBQWE7WUFDbkIsTUFBTSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQztZQUNoQyxXQUFXLEVBQUUsQ0FBQztZQUNkLGFBQWEsRUFBRSxPQUFPO1NBQ3ZCO1FBQ0QsNkJBQTZCO1FBQzdCLFVBQVUsRUFBRTtZQUNWLElBQUksRUFBRSxNQUFNO1lBQ1osTUFBTSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQztZQUNoQyxlQUFlLEVBQUUsT0FBTztZQUN4QixnQkFBZ0IsRUFBRSxFQUFFO1lBQ3BCLGFBQWEsRUFBRSxPQUFPO1lBQ3RCLFdBQVcsRUFBRSxDQUFDO1lBQ2QsVUFBVSxFQUNSLCtEQUErRDtZQUNqRSx5Q0FBeUMsRUFBRTtnQkFDekMsVUFBVSxFQUFFLE1BQU07YUFDbkI7U0FDRjtRQUNELDBDQUEwQztRQUMxQyxVQUFVLEVBQUU7WUFDVixRQUFRLEVBQUUsZUFBZTtZQUN6QixjQUFjLEVBQUUsZUFBZTtZQUMvQixJQUFJLEVBQUUsYUFBYTtZQUNuQixVQUFVLEVBQUUsdUJBQXVCO1lBQ25DLHlDQUF5QyxFQUFFO2dCQUN6QyxVQUFVLEVBQUUsTUFBTTthQUNuQjtTQUNGO0tBQ0Y7SUFDRCxnQkFBZ0IsRUFBRTtRQUNoQixZQUFZLEVBQUU7WUFDWixNQUFNLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSztTQUNuQztRQUNELFVBQVUsRUFBRTtZQUNWLE1BQU0sRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxLQUFLO1NBQ25DO0tBQ0Y7SUFDRCxjQUFjLEVBQUU7UUFDZCxTQUFTLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUM7UUFDL0IsWUFBWSxFQUFFO1lBQ1osSUFBSSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQztTQUMvQjtRQUNELFVBQVUsRUFBRTtZQUNWLGVBQWUsRUFBRSxPQUFPO1lBQ3hCLGdCQUFnQixFQUFFLEVBQUU7WUFDcEIsTUFBTSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUs7U0FDbkM7UUFDRCxVQUFVLEVBQUU7WUFDVixRQUFRLEVBQUUsYUFBYTtZQUN2QixjQUFjLEVBQUUsYUFBYTtZQUM3QixJQUFJLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSztZQUNoQyxVQUFVLEVBQUUsaUJBQWlCO1lBQzdCLHlDQUF5QyxFQUFFO2dCQUN6QyxVQUFVLEVBQUUsTUFBTTthQUNuQjtTQUNGO0tBQ0Y7SUFDRCxxQkFBcUIsRUFBRTtRQUNyQixZQUFZLEVBQUU7WUFDWixJQUFJLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSztZQUNoQyxNQUFNLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSztTQUNuQztRQUNELFVBQVUsRUFBRTtZQUNWLE1BQU0sRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUM7U0FDaEM7UUFDRCxVQUFVLEVBQUU7WUFDVixJQUFJLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDO1NBQzlCO0tBQ0Y7SUFDRCxXQUFXLEVBQUU7UUFDWCxTQUFTLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFDM0IsVUFBVSxFQUFFLENBQUM7S0FDZDtDQUNGLENBQUMsRUE1TFMsQ0E0TFQsRUFDRixFQUFFLElBQUksRUFBRSxvQkFBb0IsRUFBRSxDQUMvQixDQUFDO0FBZ0JGLE1BQU0sQ0FBQyxJQUFNLFdBQVcsR0FBRyxLQUFLLENBQUMsVUFBVSxDQUN6QyxVQUNFLEVBY0MsRUFDRCxHQUFHOztJQWRELElBQUEsd0JBQVMsRUFDVCxhQUFpQixFQUFqQixzQ0FBaUIsRUFDakIsNEJBQTRCLEVBQTVCLGlEQUE0QixFQUM1Qix3QkFBUyxFQUNULGNBQVUsRUFBViwrQkFBVSxFQUNWLFVBQUUsRUFDRixjQUFJLEVBQ0osNEJBQVcsRUFDWCxzQkFBUSxFQUNSLHNCQUFRLEVBQ1Isb0JBQU8sRUFDUCxnQkFBSyxFQUNMLHNLQUFZO0lBSWQsSUFBTSxPQUFPLEdBQUcsU0FBUyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBRXZCLElBQUEsb0dBQVEsQ0FFYjtJQUVJLElBQUEsMEJBQTBELEVBQXpELGlCQUFTLEVBQUUsb0JBQThDLENBQUM7SUFDM0QsSUFBQSx1QkFBd0QsRUFBdkQsa0JBQVUsRUFBRSxxQkFBMkMsQ0FBQztJQUUvRCxJQUFNLFdBQVcsR0FBRyxVQUFDLENBQXFDO1FBQ3hELElBQUksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUM3QixZQUFZLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDcEI7SUFDSCxDQUFDLENBQUM7SUFFRixJQUFNLFVBQVUsR0FBRztRQUNqQixJQUFJLFVBQVUsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO1lBQzNCLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUNyQjtJQUNILENBQUMsQ0FBQztJQUVGLElBQU0sWUFBWSxHQUFHLFVBQUMsQ0FBc0M7UUFDMUQsYUFBYSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7UUFFOUIsSUFBSSxTQUFTLElBQUksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRTtZQUM1QyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUM7U0FDckI7UUFFRCxJQUFJLENBQUMsU0FBUyxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7WUFDM0MsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ3BCO1FBRUQsUUFBUSxhQUFSLFFBQVEsdUJBQVIsUUFBUSxDQUFHLENBQUMsRUFBRTtJQUNoQixDQUFDLENBQUM7SUFFRixJQUFNLGNBQWMsR0FBRyxVQUFDLENBQXdDO1FBQzlELElBQUksQ0FBQyxDQUFDLEdBQUcsS0FBSyxPQUFPLElBQUksQ0FBQyxvQkFBb0IsRUFBRTtZQUM5QyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDcEIsUUFBUSxJQUFJLFFBQVEsQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUNqQyxhQUFhLENBQUMsRUFBRSxDQUFDLENBQUM7U0FDbkI7UUFFRCxJQUFJLENBQUMsQ0FBQyxHQUFHLEtBQUssT0FBTyxJQUFJLG9CQUFvQixFQUFFO1lBQzdDLFFBQVEsSUFBSSxRQUFRLENBQUMsVUFBVSxDQUFDLENBQUM7U0FDbEM7SUFDSCxDQUFDLENBQUM7SUFFRixJQUFNLHNCQUFzQixHQUFHO1FBQzdCLGFBQWEsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNsQixZQUFZLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDcEIsT0FBTyxhQUFQLE9BQU8sdUJBQVAsT0FBTyxHQUFLO1FBQ1osSUFBTSxLQUFLLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQXFCLENBQUM7UUFDcEUsSUFBTSxLQUFLLEdBQUcsSUFBSSxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDbEMsS0FBSyxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUM7UUFDakIsS0FBSyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUMzQixRQUFRLGFBQVIsUUFBUSx1QkFBUixRQUFRLENBQUksS0FBd0QsRUFBRTtJQUN4RSxDQUFDLENBQUM7SUFFRixPQUFPLENBQ0wsNkJBQ0UsU0FBUyxFQUFFLElBQUksQ0FDYixPQUFPLENBQUMsSUFBSSxFQUNaLFNBQVMsSUFBSSxPQUFPLENBQUMsU0FBUyxFQUM5QixTQUFTLENBQ1Y7UUFFRCw0REFDb0IsZ0JBQWdCLENBQUM7Z0JBQ2pDLGNBQWMsRUFBRSxDQUFDLENBQUMsV0FBVztnQkFDN0IsUUFBUSxVQUFBO2FBQ1QsQ0FBQyxFQUNGLFNBQVMsRUFBRSxJQUFJLENBQ2IsT0FBTyxDQUFDLEtBQUs7Z0JBRVgsR0FBQyxPQUFPLENBQUMsWUFBWSxJQUFHLEtBQUssS0FBSyxTQUFTOztnQkFHM0MsR0FBQyxPQUFPLENBQUMsWUFBWSxJQUFHLE1BQU0sS0FBSyxDQUFDO2dCQUNwQyxHQUFDLE9BQU8sQ0FBQyxZQUFZLElBQUcsTUFBTSxLQUFLLENBQUM7b0JBRXZDLEVBQ0QsRUFBRSxFQUFFLFFBQVEsRUFDWixJQUFJLEVBQUUsSUFBSSxFQUNWLEdBQUcsRUFBRSxHQUFHLEVBQ1IsSUFBSSxFQUFDLFFBQVEsRUFDYixRQUFRLEVBQUUsWUFBWSxFQUN0QixVQUFVLEVBQUUsY0FBYyxFQUMxQixPQUFPLEVBQUUsV0FBVyxFQUNwQixNQUFNLEVBQUUsVUFBVSxFQUNsQixLQUFLLEVBQUUsVUFBVSxJQUNiLFNBQVMsRUFDYjtRQUNGLDhDQUNjLFNBQVMsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQ2hELFNBQVMsRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU07Z0JBQzVCLEdBQUMsT0FBTyxDQUFDLGFBQWEsSUFBRyxNQUFNLEtBQUssQ0FBQztnQkFDckMsR0FBQyxPQUFPLENBQUMsYUFBYSxJQUFHLE1BQU0sS0FBSyxDQUFDO29CQUNyQyxFQUNGLFFBQVEsRUFBRSxDQUFDLENBQUMsRUFDWixPQUFPLEVBQUUsc0JBQXNCO1lBRS9CLDZCQUNFLFNBQVMsRUFBRSxJQUFJLENBQ2IsT0FBTyxDQUFDLFNBQVMsRUFDakIsS0FBSyxLQUFLLFNBQVMsSUFBSSxPQUFPLENBQUMsZ0JBQWdCLEVBQy9DLFNBQVMsSUFBSSxPQUFPLENBQUMsY0FBYyxFQUNuQyxLQUFLLEtBQUssU0FBUyxJQUFJLFNBQVMsSUFBSSxPQUFPLENBQUMscUJBQXFCLENBQ2xFLEVBQ0QsT0FBTyxFQUFDLGFBQWEsRUFDckIsSUFBSSxFQUFDLEtBQUs7Z0JBR1YsZ0NBQVEsQ0FBQyxFQUFDLE1BQU0sRUFBQyxFQUFFLEVBQUMsV0FBVyxFQUFDLEVBQUUsRUFBQyxXQUFXLEdBQUc7Z0JBQ2pELDhCQUFNLENBQUMsRUFBQywyQ0FBMkMsR0FBRztnQkFFdEQsOEJBQU0sQ0FBQyxFQUFDLEdBQUcsRUFBQyxDQUFDLEVBQUMsR0FBRyxFQUFDLEtBQUssRUFBQyxLQUFLLEVBQUMsTUFBTSxFQUFDLEtBQUssR0FBRyxDQUN6QyxDQUNDO1FBQ1IsV0FBVyxJQUFJLENBQ2Qsb0JBQUMsZUFBZSxJQUNkLFNBQVMsRUFBRSxPQUFPLENBQUMsV0FBVyxFQUM5QixLQUFLLEVBQUUsS0FBSyxFQUNaLGFBQWEsRUFBRSxRQUFRLEVBQ3ZCLGFBQWEsRUFBRSxPQUFPLENBQUMsUUFBUSxDQUFDLElBRS9CLFdBQVcsQ0FDSSxDQUNuQixDQUNHLENBQ1AsQ0FBQztBQUNKLENBQUMsQ0FDRixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNsc3ggZnJvbSAnY2xzeCc7XG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBtYWtlU3R5bGVzIH0gZnJvbSAnLi4vLi4vc3R5bGVzJztcbmltcG9ydCB7IEdldENsYXNzZXMgfSBmcm9tICcuLi8uLi90eXBlVXRpbHMnO1xuaW1wb3J0IHtcbiAgQmFzZUZvcm1FbGVtZW50LFxuICBidWlsZERlc2NyaWJlZEJ5LFxuICBGb3JtSGVscE1lc3NhZ2UsXG4gIGhlbHBGb3IsXG59IGZyb20gJy4uL19wcml2YXRlL2Zvcm1zJztcbmltcG9ydCB7IGdlbmVyYXRlVW5pcXVlSWQgfSBmcm9tICcuLi9fcHJpdmF0ZS9VbmlxdWVJZCc7XG5pbXBvcnQgeyBjbGVhckNsaXBQYXRoLCBkZWZhdWx0Q2xpcFBhdGggfSBmcm9tICcuL2NsaXBQYXRocyc7XG5cbmV4cG9ydCBjb25zdCBTZWFyY2hGaWVsZFN0eWxlc0tleSA9ICdDaHJvbWFTZWFyY2hGaWVsZCc7XG5cbmV4cG9ydCBjb25zdCB1c2VTdHlsZXMgPSBtYWtlU3R5bGVzKFxuICAodGhlbWUpID0+ICh7XG4gICAgcm9vdDoge1xuICAgICAgcG9zaXRpb246ICdyZWxhdGl2ZScsXG4gICAgfSxcbiAgICBpbnB1dDoge1xuICAgICAgYmFja2dyb3VuZENvbG9yOiAncmdiYSgxMzIsIDEzNywgMTY2LCAwLjE1KScsXG4gICAgICBib3JkZXI6IGAxcHggc29saWQgdHJhbnNwYXJlbnRgLFxuICAgICAgYm9yZGVyUmFkaXVzOiB0aGVtZS5weFRvUmVtKDQpLFxuICAgICAgY29sb3I6IHRoZW1lLnBhbGV0dGUudGV4dC5wcmltYXJ5LFxuICAgICAgZm9udEZhbWlseTogdGhlbWUudHlwb2dyYXBoeS5mb250RmFtaWx5LFxuICAgICAgZm9udFNpemU6IHRoZW1lLnB4VG9SZW0oMTQpLFxuICAgICAgbGluZUhlaWdodDogMS4yNSxcbiAgICAgIHBhZGRpbmdMZWZ0OiB0aGVtZS5zcGFjaW5nKDEuMjUpLFxuICAgICAgLy8gUmVxdWlyZXMgbW9yZSBwYWRkaW5nUmlnaHQgc28gd2UgZ2l2ZSB0aGUgc2VhcmNoIGljb24gZW5vdWdoXG4gICAgICAvLyByb29tIHdoZW4gdGhlIHRleHQgaW5zaWRlIHRoZSBzZWFyY2ggZmllbGQgaXMgbG9uZy5cbiAgICAgIHBhZGRpbmdSaWdodDogdGhlbWUuc3BhY2luZygzLjc1KSxcbiAgICAgIHRyYW5zaXRpb246ICdib3JkZXIgMC4yNXMgZWFzZScsXG4gICAgICBtYXhXaWR0aDogdGhlbWUucHhUb1JlbSgxNzMpLFxuICAgICAgJyY6Zm9jdXMnOiB7XG4gICAgICAgIG91dGxpbmU6ICdub25lJyxcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjUpJyxcbiAgICAgICAgYm9yZGVyOiBgMXB4IHNvbGlkIHJnYmEoMTMyLCAxMzcsIDE2NiwgMC40NSlgLFxuICAgICAgfSxcbiAgICAgICcmOmRpc2FibGVkJzoge1xuICAgICAgICBjdXJzb3I6ICdub3QtYWxsb3dlZCcsXG4gICAgICAgIG9wYWNpdHk6IDAuNjI1LFxuICAgICAgICAnJiArICRidXR0b24nOiB7XG4gICAgICAgICAgY3Vyc29yOiAnbm90LWFsbG93ZWQnLFxuICAgICAgICAgIG9wYWNpdHk6IDAuNjI1LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgICcmOjotd2Via2l0LWlucHV0LXBsYWNlaG9sZGVyJzoge1xuICAgICAgICBjb2xvcjogdGhlbWUucGFsZXR0ZS5ibGFja1s0MDBdLFxuICAgICAgfSxcbiAgICAgICcmOjotbW96LXBsYWNlaG9sZGVyJzoge1xuICAgICAgICBjb2xvcjogdGhlbWUucGFsZXR0ZS5ibGFja1s0MDBdLFxuICAgICAgfSxcbiAgICAgICcmOi1tcy1pbnB1dC1wbGFjZWhvbGRlcic6IHtcbiAgICAgICAgY29sb3I6IHRoZW1lLnBhbGV0dGUuYmxhY2tbNDAwXSxcbiAgICAgIH0sXG4gICAgICAnJjotbW96LXBsYWNlaG9sZGVyJzoge1xuICAgICAgICBjb2xvcjogdGhlbWUucGFsZXR0ZS5ibGFja1s0MDBdLFxuICAgICAgfSxcbiAgICAgIC8vIEhpZGUgdGhlIHdlYmtpdCBjbGVhciAoeCkgYnV0dG9uXG4gICAgICAnJjo6LXdlYmtpdC1zZWFyY2gtZGVjb3JhdGlvbiwmOjotd2Via2l0LXNlYXJjaC1jYW5jZWwtYnV0dG9uLCY6Oi13ZWJraXQtc2VhcmNoLXJlc3VsdHMtYnV0dG9uLCY6Oi13ZWJraXQtc2VhcmNoLXJlc3VsdHMtZGVjb3JhdGlvbic6IHtcbiAgICAgICAgZGlzcGxheTogJ25vbmUnLFxuICAgICAgfSxcbiAgICB9LFxuICAgIGlucHV0SW52ZXJzZToge1xuICAgICAgYmFja2dyb3VuZENvbG9yOiAncmdiYSgyMzAsIDIzMSwgMjM3LCAwLjEpJyxcbiAgICAgIGNvbG9yOiB0aGVtZS5wYWxldHRlLmNvbW1vbi53aGl0ZSxcbiAgICAgICcmOmZvY3VzJzoge1xuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6ICdyZ2JhKDIzMCwgMjMxLCAyMzcsIDAuMSknLFxuICAgICAgICBib3JkZXI6IGAxcHggc29saWQgcmdiYSgyMzAsIDIzMSwgMjM3LCAwLjU1KWAsXG4gICAgICB9LFxuICAgICAgJyY6Oi13ZWJraXQtaW5wdXQtcGxhY2Vob2xkZXInOiB7XG4gICAgICAgIGNvbG9yOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjgpJyxcbiAgICAgIH0sXG4gICAgICAnJjo6LW1vei1wbGFjZWhvbGRlcic6IHtcbiAgICAgICAgY29sb3I6ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuOCknLFxuICAgICAgfSxcbiAgICAgICcmOi1tcy1pbnB1dC1wbGFjZWhvbGRlcic6IHtcbiAgICAgICAgY29sb3I6ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuOCknLFxuICAgICAgfSxcbiAgICAgICcmOi1tb3otcGxhY2Vob2xkZXInOiB7XG4gICAgICAgIGNvbG9yOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjgpJyxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBpbnB1dEhlaWdodDA6IHtcbiAgICAgIHBhZGRpbmdCb3R0b206IHRoZW1lLnNwYWNpbmcoMC41KSxcbiAgICAgIHBhZGRpbmdUb3A6IHRoZW1lLnNwYWNpbmcoMC41KSxcbiAgICB9LFxuICAgIGlucHV0SGVpZ2h0MToge1xuICAgICAgcGFkZGluZ0JvdHRvbTogdGhlbWUuc3BhY2luZygxKSxcbiAgICAgIHBhZGRpbmdUb3A6IHRoZW1lLnNwYWNpbmcoMSksXG4gICAgfSxcbiAgICBmdWxsV2lkdGg6IHtcbiAgICAgICcmICRpbnB1dCc6IHtcbiAgICAgICAgbWF4V2lkdGg6ICdub25lJyxcbiAgICAgICAgd2lkdGg6ICcxMDAlJyxcbiAgICAgIH0sXG4gICAgICAnJiAkYnV0dG9uJzoge1xuICAgICAgICBsZWZ0OiAnYXV0bycsXG4gICAgICAgIHJpZ2h0OiB0aGVtZS5weFRvUmVtKDUpLFxuICAgICAgfSxcbiAgICB9LFxuICAgIGJ1dHRvbjoge1xuICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgICBsZWZ0OiB0aGVtZS5weFRvUmVtKDE0NCksXG4gICAgICBhbGlnbkl0ZW1zOiAnY2VudGVyJyxcbiAgICAgIGJhY2tncm91bmRDb2xvcjogJ3RyYW5zcGFyZW50JyxcbiAgICAgIGJvcmRlcjogMCxcbiAgICAgIGNvbG9yOiB0aGVtZS5wYWxldHRlLmJsYWNrWzUwMF0sXG4gICAgICBjdXJzb3I6ICdwb2ludGVyJyxcbiAgICAgIGRpc3BsYXk6ICdpbmxpbmUtZmxleCcsXG4gICAgICBmbGV4OiAnMCAwIGF1dG8nLFxuICAgICAganVzdGlmeUNvbnRlbnQ6ICdjZW50ZXInLFxuICAgICAgbWFyZ2luOiAwLFxuICAgICAgb3V0bGluZTogJ25vbmUnLFxuICAgICAgcGFkZGluZzogMCxcbiAgICAgIHRyYW5zaXRpb246ICdjb2xvciAwLjI1cyBlYXNlLCBvcGFjaXR5IDAuMjVzIGVhc2UnLFxuICAgICAgdXNlclNlbGVjdDogJ25vbmUnLFxuICAgIH0sXG4gICAgYnV0dG9uSGVpZ2h0MDoge1xuICAgICAgdG9wOiB0aGVtZS5weFRvUmVtKDAuMjUpLFxuICAgIH0sXG4gICAgYnV0dG9uSGVpZ2h0MToge1xuICAgICAgdG9wOiB0aGVtZS5weFRvUmVtKDQpLFxuICAgIH0sXG4gICAgYnV0dG9uU3ZnOiB7XG4gICAgICB3aWR0aDogdGhlbWUucHhUb1JlbSgyNCksXG4gICAgICBoZWlnaHQ6IHRoZW1lLnB4VG9SZW0oMjQpLFxuICAgICAgLy8gR2xhc3NcbiAgICAgICcmID4gY2lyY2xlJzoge1xuICAgICAgICBmaWxsOiAndHJhbnNwYXJlbnQnLFxuICAgICAgICBzdHJva2U6IHRoZW1lLnBhbGV0dGUuYmxhY2tbNTAwXSxcbiAgICAgICAgc3Ryb2tlV2lkdGg6IDYsXG4gICAgICAgIHN0cm9rZUxpbmVjYXA6ICdyb3VuZCcsXG4gICAgICB9LFxuICAgICAgLy8gTWFnbmlmeWluZyBnbGFzcyBwb2xlIHBhcnRcbiAgICAgICcmID4gcGF0aCc6IHtcbiAgICAgICAgZmlsbDogJ25vbmUnLFxuICAgICAgICBzdHJva2U6IHRoZW1lLnBhbGV0dGUuYmxhY2tbNTAwXSxcbiAgICAgICAgc3Ryb2tlRGFzaGFycmF5OiAnMTAgNTAnLFxuICAgICAgICBzdHJva2VEYXNob2Zmc2V0OiAyMCxcbiAgICAgICAgc3Ryb2tlTGluZWNhcDogJ3JvdW5kJyxcbiAgICAgICAgc3Ryb2tlV2lkdGg6IDcsXG4gICAgICAgIHRyYW5zaXRpb246XG4gICAgICAgICAgJ3N0cm9rZS1kYXNoYXJyYXkgMjAwbXMsIHN0cm9rZS1kYXNob2Zmc2V0IDIwMG1zLCBzdHJva2UgMjAwbXMnLFxuICAgICAgICAnQG1lZGlhIChwcmVmZXJzLXJlZHVjZWQtbW90aW9uOiByZWR1Y2UpJzoge1xuICAgICAgICAgIHRyYW5zaXRpb246ICdub25lJyxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICAvLyBCYWNrZ3JvdW5kIGNpcmNsZSBmb3IgZ2xhc3MgYW5kIFggY2xlYXJcbiAgICAgICcmID4gcmVjdCc6IHtcbiAgICAgICAgY2xpcFBhdGg6IGRlZmF1bHRDbGlwUGF0aCxcbiAgICAgICAgV2Via2l0Q2xpcFBhdGg6IGRlZmF1bHRDbGlwUGF0aCxcbiAgICAgICAgZmlsbDogJ3RyYW5zcGFyZW50JyxcbiAgICAgICAgdHJhbnNpdGlvbjogJ2NsaXAtcGF0aCAxMDBtcyAxMDBtcycsXG4gICAgICAgICdAbWVkaWEgKHByZWZlcnMtcmVkdWNlZC1tb3Rpb246IHJlZHVjZSknOiB7XG4gICAgICAgICAgdHJhbnNpdGlvbjogJ25vbmUnLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9LFxuICAgIGJ1dHRvblN2Z0ludmVyc2U6IHtcbiAgICAgICcmID4gY2lyY2xlJzoge1xuICAgICAgICBzdHJva2U6IHRoZW1lLnBhbGV0dGUuY29tbW9uLndoaXRlLFxuICAgICAgfSxcbiAgICAgICcmID4gcGF0aCc6IHtcbiAgICAgICAgc3Ryb2tlOiB0aGVtZS5wYWxldHRlLmNvbW1vbi53aGl0ZSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBidXR0b25TdmdDbGVhcjoge1xuICAgICAgbWFyZ2luVG9wOiB0aGVtZS5zcGFjaW5nKDAuMTI1KSxcbiAgICAgICcmID4gY2lyY2xlJzoge1xuICAgICAgICBmaWxsOiB0aGVtZS5wYWxldHRlLmJsYWNrWzUwMF0sXG4gICAgICB9LFxuICAgICAgJyYgPiBwYXRoJzoge1xuICAgICAgICBzdHJva2VEYXNoYXJyYXk6ICcyNCA1MCcsXG4gICAgICAgIHN0cm9rZURhc2hvZmZzZXQ6IDc0LFxuICAgICAgICBzdHJva2U6IHRoZW1lLnBhbGV0dGUuY29tbW9uLndoaXRlLFxuICAgICAgfSxcbiAgICAgICcmID4gcmVjdCc6IHtcbiAgICAgICAgY2xpcFBhdGg6IGNsZWFyQ2xpcFBhdGgsXG4gICAgICAgIFdlYmtpdENsaXBQYXRoOiBjbGVhckNsaXBQYXRoLFxuICAgICAgICBmaWxsOiB0aGVtZS5wYWxldHRlLmNvbW1vbi53aGl0ZSxcbiAgICAgICAgdHJhbnNpdGlvbjogJ2NsaXAtcGF0aCAxMDBtcycsXG4gICAgICAgICdAbWVkaWEgKHByZWZlcnMtcmVkdWNlZC1tb3Rpb246IHJlZHVjZSknOiB7XG4gICAgICAgICAgdHJhbnNpdGlvbjogJ25vbmUnLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9LFxuICAgIGJ1dHRvblN2Z0NsZWFySW52ZXJzZToge1xuICAgICAgJyYgPiBjaXJjbGUnOiB7XG4gICAgICAgIGZpbGw6IHRoZW1lLnBhbGV0dGUuY29tbW9uLndoaXRlLFxuICAgICAgICBzdHJva2U6IHRoZW1lLnBhbGV0dGUuY29tbW9uLndoaXRlLFxuICAgICAgfSxcbiAgICAgICcmID4gcGF0aCc6IHtcbiAgICAgICAgc3Ryb2tlOiB0aGVtZS5wYWxldHRlLmJsdWVbNzAwXSxcbiAgICAgIH0sXG4gICAgICAnJiA+IHJlY3QnOiB7XG4gICAgICAgIGZpbGw6IHRoZW1lLnBhbGV0dGUuYmx1ZVs3MDBdLFxuICAgICAgfSxcbiAgICB9LFxuICAgIGhlbHBNZXNzYWdlOiB7XG4gICAgICBtYXJnaW5Ub3A6IHRoZW1lLnNwYWNpbmcoMSksXG4gICAgICBtYXJnaW5MZWZ0OiAwLFxuICAgIH0sXG4gIH0pLFxuICB7IG5hbWU6IFNlYXJjaEZpZWxkU3R5bGVzS2V5IH1cbik7XG5cbmV4cG9ydCB0eXBlIFNlYXJjaEZpZWxkQ2xhc3NlcyA9IEdldENsYXNzZXM8dHlwZW9mIHVzZVN0eWxlcz47XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VhcmNoRmllbGRQcm9wc1xuICBleHRlbmRzIFJlYWN0LkNvbXBvbmVudFByb3BzV2l0aFJlZjwnaW5wdXQnPixcbiAgICBQaWNrPEJhc2VGb3JtRWxlbWVudCwgJ2hlbHBNZXNzYWdlJz4ge1xuICBidXR0b25UeXBlPzogc3RyaW5nO1xuICBjb2xvcj86ICdkZWZhdWx0JyB8ICdpbnZlcnNlJztcbiAgZGlzYWJsZUNsZWFyT25TZWFyY2g/OiBib29sZWFuO1xuICBmdWxsV2lkdGg/OiBib29sZWFuO1xuICBvbkNsZWFyPzogKCkgPT4gYW55O1xuICBvblNlYXJjaD8odGV4dFZhbHVlOiBzdHJpbmcgfCBudW1iZXIgfCBzdHJpbmdbXSB8IHVuZGVmaW5lZCk6IGFueTtcbiAgaGVpZ2h0PzogMCB8IDE7XG59XG5cbmV4cG9ydCBjb25zdCBTZWFyY2hGaWVsZCA9IFJlYWN0LmZvcndhcmRSZWY8SFRNTElucHV0RWxlbWVudCwgU2VhcmNoRmllbGRQcm9wcz4oXG4gIChcbiAgICB7XG4gICAgICBjbGFzc05hbWUsXG4gICAgICBjb2xvciA9ICdkZWZhdWx0JyxcbiAgICAgIGRpc2FibGVDbGVhck9uU2VhcmNoID0gZmFsc2UsXG4gICAgICBmdWxsV2lkdGgsXG4gICAgICBoZWlnaHQgPSAxLFxuICAgICAgaWQsXG4gICAgICBuYW1lLFxuICAgICAgaGVscE1lc3NhZ2UsXG4gICAgICBvbkNoYW5nZSxcbiAgICAgIG9uU2VhcmNoLFxuICAgICAgb25DbGVhcixcbiAgICAgIHZhbHVlLFxuICAgICAgLi4ucm9vdFByb3BzXG4gICAgfSxcbiAgICByZWZcbiAgKSA9PiB7XG4gICAgY29uc3QgY2xhc3NlcyA9IHVzZVN0eWxlcyh7fSk7XG5cbiAgICBjb25zdCBbdW5pcXVlSWRdID0gUmVhY3QudXNlU3RhdGU8c3RyaW5nPihcbiAgICAgICgpID0+IGlkIHx8IG5hbWUgfHwgZ2VuZXJhdGVVbmlxdWVJZCgnc2VhcmNoRmllbGQtJylcbiAgICApO1xuXG4gICAgY29uc3QgW3Nob3dDbGVhciwgc2V0U2hvd0NsZWFyXSA9IFJlYWN0LnVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKTtcbiAgICBjb25zdCBbc2VhcmNoVGV4dCwgc2V0U2VhcmNoVGV4dF0gPSBSZWFjdC51c2VTdGF0ZTxzdHJpbmc+KCcnKTtcblxuICAgIGNvbnN0IGhhbmRsZUZvY3VzID0gKGU6IFJlYWN0LkZvY3VzRXZlbnQ8SFRNTElucHV0RWxlbWVudD4pID0+IHtcbiAgICAgIGlmIChlLnRhcmdldC52YWx1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHNldFNob3dDbGVhcih0cnVlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uc3QgaGFuZGxlQmx1ciA9ICgpID0+IHtcbiAgICAgIGlmIChzZWFyY2hUZXh0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBzZXRTaG93Q2xlYXIoZmFsc2UpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBjb25zdCBoYW5kbGVDaGFuZ2UgPSAoZTogUmVhY3QuQ2hhbmdlRXZlbnQ8SFRNTElucHV0RWxlbWVudD4pID0+IHtcbiAgICAgIHNldFNlYXJjaFRleHQoZS50YXJnZXQudmFsdWUpO1xuXG4gICAgICBpZiAoc2hvd0NsZWFyICYmIGUudGFyZ2V0LnZhbHVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBzZXRTaG93Q2xlYXIoZmFsc2UpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXNob3dDbGVhciAmJiBlLnRhcmdldC52YWx1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHNldFNob3dDbGVhcih0cnVlKTtcbiAgICAgIH1cblxuICAgICAgb25DaGFuZ2U/LihlKTtcbiAgICB9O1xuXG4gICAgY29uc3QgaGFuZGxlS2V5UHJlc3MgPSAoZTogUmVhY3QuS2V5Ym9hcmRFdmVudDxIVE1MSW5wdXRFbGVtZW50PikgPT4ge1xuICAgICAgaWYgKGUua2V5ID09PSAnRW50ZXInICYmICFkaXNhYmxlQ2xlYXJPblNlYXJjaCkge1xuICAgICAgICBzZXRTaG93Q2xlYXIoZmFsc2UpO1xuICAgICAgICBvblNlYXJjaCAmJiBvblNlYXJjaChzZWFyY2hUZXh0KTtcbiAgICAgICAgc2V0U2VhcmNoVGV4dCgnJyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJyAmJiBkaXNhYmxlQ2xlYXJPblNlYXJjaCkge1xuICAgICAgICBvblNlYXJjaCAmJiBvblNlYXJjaChzZWFyY2hUZXh0KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uc3QgaGFuZGxlQ2xlYXJCdXR0b25DbGljayA9ICgpID0+IHtcbiAgICAgIHNldFNlYXJjaFRleHQoJycpO1xuICAgICAgc2V0U2hvd0NsZWFyKGZhbHNlKTtcbiAgICAgIG9uQ2xlYXI/LigpO1xuICAgICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh1bmlxdWVJZCkgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IEV2ZW50KCdjaGFuZ2UnKTtcbiAgICAgIGlucHV0LnZhbHVlID0gJyc7XG4gICAgICBpbnB1dC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICAgIG9uQ2hhbmdlPy4oKGV2ZW50IGFzIHVua25vd24pIGFzIFJlYWN0LkNoYW5nZUV2ZW50PEhUTUxJbnB1dEVsZW1lbnQ+KTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXZcbiAgICAgICAgY2xhc3NOYW1lPXtjbHN4KFxuICAgICAgICAgIGNsYXNzZXMucm9vdCxcbiAgICAgICAgICBmdWxsV2lkdGggJiYgY2xhc3Nlcy5mdWxsV2lkdGgsXG4gICAgICAgICAgY2xhc3NOYW1lXG4gICAgICAgICl9XG4gICAgICA+XG4gICAgICAgIDxpbnB1dFxuICAgICAgICAgIGFyaWEtZGVzY3JpYmVkYnk9e2J1aWxkRGVzY3JpYmVkQnkoe1xuICAgICAgICAgICAgaGFzSGVscE1lc3NhZ2U6ICEhaGVscE1lc3NhZ2UsXG4gICAgICAgICAgICB1bmlxdWVJZCxcbiAgICAgICAgICB9KX1cbiAgICAgICAgICBjbGFzc05hbWU9e2Nsc3goXG4gICAgICAgICAgICBjbGFzc2VzLmlucHV0LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBbY2xhc3Nlcy5pbnB1dEludmVyc2VdOiBjb2xvciA9PT0gJ2ludmVyc2UnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgW2NsYXNzZXMuaW5wdXRIZWlnaHQwXTogaGVpZ2h0ID09PSAwLFxuICAgICAgICAgICAgICBbY2xhc3Nlcy5pbnB1dEhlaWdodDFdOiBoZWlnaHQgPT09IDEsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgKX1cbiAgICAgICAgICBpZD17dW5pcXVlSWR9XG4gICAgICAgICAgbmFtZT17bmFtZX1cbiAgICAgICAgICByZWY9e3JlZn1cbiAgICAgICAgICB0eXBlPVwic2VhcmNoXCJcbiAgICAgICAgICBvbkNoYW5nZT17aGFuZGxlQ2hhbmdlfVxuICAgICAgICAgIG9uS2V5UHJlc3M9e2hhbmRsZUtleVByZXNzfVxuICAgICAgICAgIG9uRm9jdXM9e2hhbmRsZUZvY3VzfVxuICAgICAgICAgIG9uQmx1cj17aGFuZGxlQmx1cn1cbiAgICAgICAgICB2YWx1ZT17c2VhcmNoVGV4dH1cbiAgICAgICAgICB7Li4ucm9vdFByb3BzfVxuICAgICAgICAvPlxuICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgYXJpYS1sYWJlbD17c2hvd0NsZWFyID8gJ0NsZWFyIGlucHV0JyA6ICdTZWFyY2gnfVxuICAgICAgICAgIGNsYXNzTmFtZT17Y2xzeChjbGFzc2VzLmJ1dHRvbiwge1xuICAgICAgICAgICAgW2NsYXNzZXMuYnV0dG9uSGVpZ2h0MF06IGhlaWdodCA9PT0gMCxcbiAgICAgICAgICAgIFtjbGFzc2VzLmJ1dHRvbkhlaWdodDFdOiBoZWlnaHQgPT09IDEsXG4gICAgICAgICAgfSl9XG4gICAgICAgICAgdGFiSW5kZXg9ey0xfVxuICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZUNsZWFyQnV0dG9uQ2xpY2t9XG4gICAgICAgID5cbiAgICAgICAgICA8c3ZnXG4gICAgICAgICAgICBjbGFzc05hbWU9e2Nsc3goXG4gICAgICAgICAgICAgIGNsYXNzZXMuYnV0dG9uU3ZnLFxuICAgICAgICAgICAgICBjb2xvciA9PT0gJ2ludmVyc2UnICYmIGNsYXNzZXMuYnV0dG9uU3ZnSW52ZXJzZSxcbiAgICAgICAgICAgICAgc2hvd0NsZWFyICYmIGNsYXNzZXMuYnV0dG9uU3ZnQ2xlYXIsXG4gICAgICAgICAgICAgIGNvbG9yID09PSAnaW52ZXJzZScgJiYgc2hvd0NsZWFyICYmIGNsYXNzZXMuYnV0dG9uU3ZnQ2xlYXJJbnZlcnNlXG4gICAgICAgICAgICApfVxuICAgICAgICAgICAgdmlld0JveD1cIjAgMCAxMDAgMTAwXCJcbiAgICAgICAgICAgIHJvbGU9XCJpbWdcIlxuICAgICAgICAgICAgYXJpYS1oaWRkZW5cbiAgICAgICAgICA+XG4gICAgICAgICAgICA8Y2lyY2xlIHI9XCIyNC41XCIgY3k9XCI1NC4yMDAwMDFcIiBjeD1cIjQ1LjcwMDAwMVwiIC8+XG4gICAgICAgICAgICA8cGF0aCBkPVwiTSAzNy4yNDAzNDksNDYuNzMzMjQzIDcyLjU1MTE4NSw4Mi40MTQzODJcIiAvPlxuXG4gICAgICAgICAgICA8cmVjdCB4PVwiMFwiIHk9XCIwXCIgd2lkdGg9XCIxMDBcIiBoZWlnaHQ9XCIxMDBcIiAvPlxuICAgICAgICAgIDwvc3ZnPlxuICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAge2hlbHBNZXNzYWdlICYmIChcbiAgICAgICAgICA8Rm9ybUhlbHBNZXNzYWdlXG4gICAgICAgICAgICBjbGFzc05hbWU9e2NsYXNzZXMuaGVscE1lc3NhZ2V9XG4gICAgICAgICAgICBjb2xvcj17Y29sb3J9XG4gICAgICAgICAgICByb290RWxlbWVudElkPXt1bmlxdWVJZH1cbiAgICAgICAgICAgIGRlc2NyaWJlZEJ5SWQ9e2hlbHBGb3IodW5pcXVlSWQpfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIHtoZWxwTWVzc2FnZX1cbiAgICAgICAgICA8L0Zvcm1IZWxwTWVzc2FnZT5cbiAgICAgICAgKX1cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cbik7XG4iXX0=